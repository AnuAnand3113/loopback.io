<!DOCTYPE html>
<head>
    

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="keywords" content=" LoopBack 4.0, LoopBack 4, Node.js, TypeScript, OpenAPI, LoopBack 3, Migration">
  <title>Migrating access control example | LoopBack Documentation</title>
  <link rel="stylesheet" href="/css/syntax.css">

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/modern-business.css">
    <link rel="stylesheet" href="/css/lavish-bootstrap.css">
    <link rel="stylesheet" href="/css/customstyles.css">
    <link rel="stylesheet" href="/css/theme-v4.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150726441-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150726441-2');
</script>


    <!-- github star button -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>


    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.0/anchor.min.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/customscripts.js"></script>

    <link rel="shortcut icon" href="/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->


    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand no_icon" href="/doc/index.html">
              <img class="no_icon" style="width:147px;" src="/images/branding/logo/white/loopback.svg">&nbsp;<span class="projectTitle"></span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is  -->
                          
                            <li><a href="https://loopback.io/doc/en/lb4/apidocs.index.html" target="_blank">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is  -->
                          
                            <li><a href="http://apidocs.loopback.io" target="_blank">LoopBack 3.x</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">View<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is / -->
                          
                            <li><a href="/">LoopBack Overview</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/en/lb4/ -->
                          
                            <li class="dropdownActive"><a href="/doc/en/lb4/">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/en/lb3/ -->
                          
                            <li><a href="/doc/en/lb3/">LoopBack 3.x</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/en/lb2/ -->
                          
                            <li><a href="/doc/en/lb2/">LoopBack 2.x</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/en/community/ -->
                          
                            <li><a href="/doc/en/community/">Community projects</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/en/contrib/ -->
                          
                            <li><a href="/doc/en/contrib/">Contributing to LoopBack</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/en/sec/ -->
                          
                            <li><a href="/doc/en/sec/">Security advisories</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is  -->
                          
                            <li><a href="https://github.com/strongloop/loopback.io" target="_blank">Docs Github Repo</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs-announcements" target="_blank">Announcements Mailing List</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs" target="_blank">Developer Forum</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is  -->
                          
                            <li><a href="https://join.slack.com/t/loopbackio/shared_invite/zt-8lbow73r-SKAKz61Vdao~_rGf91pcsw" target="_blank">LoopBack on Slack</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is  -->
                          
                            <li><a href="https://stackoverflow.com/questions/tagged/strongloop+or+loopback4+or+loopbackjs" target="_blank">LoopBack on Stack Overflow</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is  -->
                          
                            <li><a href="https://strongloop.com/strongblog/tag_LoopBack.html" target="_blank">StrongLoop Blog - LoopBack</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Translations<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/es/lb2/ -->
                          
                            <li><a href="/doc/es/lb2/">Español (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/es/lb4/ -->
                          
                            <li><a href="/doc/es/lb4/">Español (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/fr/lb2/ -->
                          
                            <li><a href="/doc/fr/lb2/">Français (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/fr/lb4/ -->
                          
                            <li><a href="/doc/fr/lb4/">Français (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/ko/lb2/ -->
                          
                            <li><a href="/doc/ko/lb2/">한국어 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/ko/lb3/ -->
                          
                            <li><a href="/doc/ko/lb3/">한국어 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/pt-br/lb2/ -->
                          
                            <li><a href="/doc/pt-br/lb2/">Português (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/pt-br/lb4/ -->
                          
                            <li><a href="/doc/pt-br/lb4/">Português (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/ja/lb2/ -->
                          
                            <li><a href="/doc/ja/lb2/">日本語 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/ja/lb3/ -->
                          
                            <li><a href="/doc/ja/lb3/">日本語 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/ja/lb4/ -->
                          
                            <li><a href="/doc/ja/lb4/">日本語 (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/ru/lb2/ -->
                          
                            <li><a href="/doc/ru/lb2/">Pусский (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/zh/lb2/ -->
                          
                            <li><a href="/doc/zh/lb2/">中文 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/migration-auth-access-control-example.html .... folderitem.url is /doc/zh/lb4/ -->
                          
                            <li><a href="/doc/zh/lb4/">中文 (v4)</a></li>
                          
                        
                    </ul>
                </li>
                
                
                
                <li>
                    <form id="search" name="search" class="input-group lb-search" action="/search" method="GET">
                        <input type="text" class="form-control search-bar" placeholder="Search (powered by Watson)" name="q">
                        
                          <input type="hidden" name="sidebar" value="lb4_sidebar">
                        
                        <div class="input-group-btn">
                            <button type="submit" class="btn btn-default" aria-label="search">
                              <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button>
                        </div>
                      </form>
                </li>
            </ul>
        </div>
      </div>
</nav>

<!-- Page Content -->
<div class="container">
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <nav class="col-md-3 sidebar-col">
          











<!-- NOTE: sidebar = site.data.sidebars.mydoc_sidebar.entries -->
<div class="sidebarTitle"><a href="index.html">LoopBack 4</a></div>
<ul id="mysidebar" class="nav-list">
  

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="index.html">Overview</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Getting-started.html">Getting started</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Inside-LoopBack-Application.html">Inside a LoopBack Application</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent-expand   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building LoopBack Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Tutorials.html">Tutorials</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-tutorial.html">Todo Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-scaffolding.html">Create your app scaffolding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-model.html">Add the Todo model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-datasource.html">Add a Datasource</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-repository.html">Add a Repository</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-controller.html">Add a Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-putting-it-together.html">Putting it all together</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-geocoding-service.html">Bonus: Integrate with a geo-coding service</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-list-tutorial.html">TodoList Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-model.html">Add TodoList Model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-repository.html">Add TodoList Repository</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-list-tutorial-relations.html">Add Model Relations</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-has-one-relation.html">Add a HasOne Relation</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-controller.html">Add TodoList Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-sqldb.html">Running on relational databases</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-back-end.html">Connecting to Back-end Service Tutorials</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="soap-calculator-tutorial.html">SOAP Web Service Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-web-service-overview.html">SOAP Web Service Overview</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-scaffolding.html">App scaffolding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-datasource.html">Add a Datasource</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-service.html">Add a Service</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-controller.html">Add a Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-run-and-test.html">Run and Test it</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="express-with-lb4-rest-tutorial.html">Creating an Express Application with LoopBack REST API</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-tutorial.html">How to secure your LoopBack 4 application with JWT authentication</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="core-tutorial.html">Build large scale Node.js projects with LoopBack 4</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part1.html">Introduction of the application scenario</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part2.html">Architectural challenges</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part3.html">Context in action</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part4.html">Dependency injection</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part5.html">Extension point and extensions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part6.html">Interception</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part7.html">Observation of life cycle events</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part8.html">Configuration</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part9.html">Discover and load artifacts by convention</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part10.html">Advanced Recipes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part11.html">Summary</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Examples.html">Examples</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-examples.html">Community examples</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">How-to guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building REST APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-crud-rest-apis.html">Creating CRUD REST APIs from a model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-how-openapi-spec-is-served.html">Customizing how OpenAPI spec is served</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-routes.html">Customizing routes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Dynamic-models-repositories-controllers.html">Dynamically adding models, repositories, and controllers</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Self-hosted-rest-api-explorer.html">Self-hosted REST API Explorer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Serving-static-files.html">Serving Static Files</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Accessing-http-request-response.html">Accessing HTTP Request and Response Objects</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="File-upload-download.html">Uploading and Downloading Files</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Express-middleware.html">Using Express Middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-strong-error-handler.html">Using strong-error-handler</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Boot-and-Mount-a-LoopBack-3-application.html">Boot and Mount a LoopBack 3 Application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Integrating-with-api-connect.html">Integrating with API Connect</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Accepting-messagepack-over-http.html">Accepting MessagePack over HTTP</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Creating Other Forms of APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="GraphQL.html">Creating GraphQL APIs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-openapi-to-graphql.html">Using OpenAPI-to-GraphQL</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Creating-artifacts-runtime.html">Creating Artifacts at Runtime</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-model-runtime.html">Creating Model at Runtime</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-datasource-runtime.html">Creating DataSource at Runtime</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-repository-runtime.html">Creating Repositories at Runtime</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building frontend applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Building-frontend-angular-application.html">Building an Angular Application from OpenAPI Specification</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-server-configuration.html">Customizing Server configuration</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Migrate-from-legacy-sequence.html">Migrate from Legacy Sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Running-cron-jobs.html">Running cron jobs</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Accessing Databases</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Configuring-datasource.html">Configuring DataSource</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Working-with-data.html">Working with data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Querying-data.html">Querying data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Fields-filter.html">Fields filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Include-filter.html">Include filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Limit-filter.html">Limit filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Order-filter.html">Order filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Skip-filter.html">Skip filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Where-filter.html">Where filter</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-database-transactions.html">Using Database Transactions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Database-migrations.html">Database Migrations</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Executing-database-commands.html">Executing database commands</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Using TypeORM</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-typeorm-with-loopback.html">How to use TypeORM with LoopBack</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Accessing-services.html">Accessing Services</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Calling-soap-web-services.html">Calling SOAP Web services</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Calling-rest-apis.html">Calling REST APIs</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Parsing-requests-guide.html">Parsing requests</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Validation.html">Validating Data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-REST-layer.html">Validation in REST Layer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-controller-repo-service-layer.html">Validation in the Controller, Repository and Service Layer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-ORM-layer.html">Validation in ORM Layer</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Configuring-applications.html">Configuring Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application-setup-tips.html">Tips for Application Setup</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Securing Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Authentication-overview.html">Authentication</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-tutorial.html">Apply JWT Authentication in Todo Example</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Loopback-component-authentication.html">Authentication Component</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-decorator.html">Authentication Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-action.html">Authentication Action</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-strategy.html">Authentication Strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-options.html">Managing Custom Authentication Strategy Options</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="JWT-authentication-extension.html">JWT Authentication Extension</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Implement-your-own-strategy.html">Implement your own authentication strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-passport.html">Passport Adapter for Authentication</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Authorization-overview.html">Authorization</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="RBAC-with-authorization.html">RBAC with Authorization System</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Loopback-component-authorization.html">Authorization Component</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-interceptor.html">Interceptor</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-decorator.html">Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-authorizer.html">Authorizer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-decision-matrix.html">Decision Matrix</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-enforcer.html">Enforcer</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Deployment.html">Deploying Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Enabling-https.html">Enabling HTTPS</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Deploying-to-IBM-Cloud.html">Deploying to IBM Cloud</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="deploying_to_ibm_cloud_kubernetes.html">Deploying to Kubernetes on IBM Cloud</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="deploying-with-pm2-and-nginx.html">Deploying with pm2 and nginx</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Appsody-LoopBack.html">Developing and Deploying LoopBack Applications with Appsody</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Running-cron-jobs.html">Running cron jobs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Health.html">Health check</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Metrics.html">Metrics for Prometheus</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Pooling.html">Pooling</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Troubleshooting.html">Troubleshooting</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Setting-debug-strings.html">Setting debug strings</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Logging.html">Logging</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Context-explorer.html">Context Explorer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Debugging-tests-with-mocha.html">Debugging tests with Mocha</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent-expand   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Extending-LoopBack-4.html">Extending LoopBack Framework</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">How-to guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-components.html">Creating components</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-decorators.html">Creating decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="creating-components-rest-api.html">Contributing REST API</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="creating-components-services.html">Creating services</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-servers.html">Creating servers</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-request-body-parsing.html">Extending request body parsing</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-life-cycle.html">Extension life cycle</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-OpenAPI-specification.html">Extending OpenAPI specification</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-Model-API-builder.html">Extending Model API builder</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Testing-your-extension.html">Testing your extension</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-extensions.html">Community extensions</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Concepts.html">Concepts</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Crafting-LoopBack-4.html">Crafting LoopBack 4</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Core</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application.html">Application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Component.html">Component</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Context.html">Context</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Binding.html">Binding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Dependency-injection.html">Dependency Injection</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Interceptor.html">Interceptor</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Life-cycle.html">Life Cycle Event and Observer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-point-and-extensions.html">Extension point and extensions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Service.html">Service</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Booting-an-Application.html">Booter</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Decorators.html">Decorators</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_openapi.html">OpenAPI Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_inject.html">Dependency Injection Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_authenticate.html">Authentication Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_authorize.html">Authorization Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_service.html">Service Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_repository.html">Repository Decorators</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Mixin.html">Mixin</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">REST APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Server.html">Server</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Sequence.html">Sequence</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-middleware-sequence.html">Middleware based sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-action-sequence.html">Action based sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Advanced-sequence-topics.html">Advanced topics</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Routing-requests.html">Routing requests</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Parsing-requests.html">Parsing requests</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Working-with-express-middleware.html">Working with Express Middleware</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Middleware.html">Middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Route.html">Route</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Controller.html">Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Request-response-cycle.html">Request/response cycle</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Data Access</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Model.html">Model</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Relations.html">Relations</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasMany-relation.html">HasMany Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="BelongsTo-relation.html">BelongsTo Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasOne-relation.html">HasOne Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasManyThrough-relation.html">HasManyThrough Relation</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Repository.html">Repository</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DataSource.html">DataSource</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Best-practices.html">Best practices</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Defining-the-API-using-code-first-approach.html">Defining the API using code-first approach</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Defining-your-testing-strategy.html">Defining your testing strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Testing-your-application.html">Testing your application</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Reference guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Loopback-application-layout.html">LoopBack 4 Application Layout</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="apidocs.index.html">API docs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Reserved-binding-keys.html">Reserved binding keys</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Error-codes.html">Error codes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LoopBack-types.html">LoopBack Types</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Command-line-interface.html">CLI References</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application-generator.html">Application generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Controller-generator.html">Controller generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DataSource-generator.html">DataSource generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Importing-LB3-models.html">Import models from LoopBack 3</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Model-generator.html">Model generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Discovering-models.html">Model discovery</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Relation-generator.html">Relation generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Repository-generator.html">Repository generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Rest-Crud-generator.html">REST CRUD model endpoints generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Service-generator.html">Service generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="OpenAPI-generator.html">OpenAPI generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Life-cycle-observer-generator.html">Life cycle observer generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Interceptor-generator.html">Interceptor generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-generator.html">Extension generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Download-examples.html">Download examples</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Update-generator.html">Update project dependencies</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Copyright-generator.html">Generate copyright/license headers</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Connectors-reference.html">Connectors reference</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Memory-connector.html">Memory connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Database-connectors.html">Database connectors</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Cassandra-connector.html">Cassandra connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Cloudant-connector.html">Cloudant connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Couchdb2-connector.html">CouchDB 2.x connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DashDB.html">DashDB connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-connector.html">IBM Db2 (for Linux, Unix, Windows) connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-for-i-connector.html">IBM Db2 for i connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-for-z-OS-connector.html">IBM Db2 for z/OS connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Informix.html">Informix connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="MongoDB-connector.html">MongoDB connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-MongoDB.html">MongoDB Connector Tutorial</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-MongoLab.html">Using MongoLab</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="MySQL-connector.html">MySQL connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-MySQL.html">MySQL Connector Tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Oracle-connector.html">Oracle connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Installing-the-Oracle-connector.html">Installing the Oracle connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-Oracle.html">Oracle connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="PostgreSQL-connector.html">PostgreSQL connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-PostgreSQL.html">PostgreSQL connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Redis-connector.html">Redis connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="kv-redis-connector.html">Redis key-value connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Example-kv-connector.html">KV connector example</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="SQL-Server-connector.html">SQL Server connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-Microsoft-SQL-Server.html">SQL Server connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="SQLite3.html">SQLite3 connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="zOSconnectEE.html">z/OS Connect Enterprise Edition connector</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Other-connectors.html">Other connectors</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="JSON-RPC-connector.html">JSON RPC connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="MQLight-connector.html">MQ Light connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="REST-connector.html">REST connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-connector-example.html">REST connector example</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="SOAP-connector.html">SOAP connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Strong-soap.html">Strong-soap</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="SOAP-Connector-example.html">SOAP connector example</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-SOAP.html">Connecting to SOAP web services</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="OpenAPI-connector.html">OpenAPI connector</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-connectors.html">Community connectors</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="changelog.index.html">Change logs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Deploy-for-GDPR-readiness.html">Considerations for GDPR readiness</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="code-contrib-lb4.html">Contributing to LoopBack 4</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="submitting_a_pr.html">Submitting a pull request to LoopBack 4</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="FAQ.html">FAQ</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-overview.html">Migration guide</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Understanding-the-differences.html">Understanding the differences</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LB3-vs-LB4-booting.html">Booting process</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LB3-vs-LB4-request-response-cycle.html">Request/response cycle</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-mounting-lb3app.html">Mounting a LoopBack 3 application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-express-middleware.html">Express middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-datasources.html">Datasources</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-models-overview.html">Migrating models</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-core.html">Model definitions and built-in APIs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-relations.html">Relations</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-methods.html">Custom methods</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-remoting-hooks.html">Remoting hooks</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-operation-hooks.html">CRUD operation hooks</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-mixins.html">Mixins</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-boot-scripts.html">Boot scripts</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-auth-overview.html">Authentication & authorization</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  active">
    
    
      <a class="page-link" href="migration-auth-access-control-example.html">Access control example</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-authentication.html">Built-in models and authentication</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-passport.html">Passport</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-oauth2.html">OAuth2 Provider</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-cli.html">CLI</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-extensions-overview.html">Components and extensions</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-project-layout.html">Project layout</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-models.html">Models</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-current-context.html">Current context</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-mixins.html">Mixins</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-rest-api.html">REST API</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-clients.html">Clients (API consumers)</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-not-planned.html">Features not planned</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



</ul>

        </nav>
        <!-- Content Column -->
        <div class="col-md-9">
            
<div class="post-header">
   <h1 class="post-title-main">Migrating access control example</h1>
   
     
       <a target="_blank" href="https://github.com/strongloop/loopback-next/blob/master/docs/site/migration/auth/migration-auth-access-control-example.md" class="githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit this page</a>
   
</div>

<div class="post-content">





 
   
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
;$(function() {
  var level = parseInt(3, 10);
  if (level === 1) {level = 'h2'}
  if (level === 2) {level = 'h2,h3'}
  if (level === 3) {level = 'h2,h3,h4'}
  if (level === 4) {level = 'h2,h3,h4,h5'}

  // Add a new level for changelog files which use h1,h2,h3
  if (level === 0) {level = 'h1,h2,h3,h4,h5'}

  var toc = $('#toc')

  toc.toc({minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: level})

  /* this offset helps with the space taken up by the floating toolbar */
  toc.on('click', 'a', function() {
    var target = $(this.getAttribute('href')),
      scroll_target = target.offset().top

    $(window).scrollTop(scroll_target - 10)
    return false
  })
  .on('click', '.toc-expand-button', function() {
    toc.find('> ul').slideToggle('fast');
  })
})
</script>

<div id="toc">
  <span class="toc-title">Page Contents</span>
  <button type="button" class="btn btn-link toc-expand-button">
    <i class="fa fa-bars"></i>
  </button>
</div>

 

    <div class="alert alert-success" role="alert">
  <p><i class="fa fa-check-square-o"></i>
  <b>Tip:</b> 
Missing instructions for your LoopBack 3 use case? Please report a <a href="https://github.com/strongloop/loopback-next/issues/new?labels=question,Migration,Docs&amp;template=Migration_docs.md">Migration docs issue</a> on GitHub to let us know.</p>

</div>

<p>This example is migrated from
<a href="https://github.com/strongloop/loopback-example-access-control">loopback-example-access-control</a>,
and uses the authentication and authorization system in LoopBack 4 to implement
the access control.</p>

<h2 id="app-scenario">App Scenario</h2>

<p>In this example, we create “Startkicker” (a basic Kickstarter-like application)
to demonstrate authentication and authorization mechanisms in LoopBack. The
application consists of four types of users:</p>

<ul>
  <li>guest</li>
  <li>owner</li>
  <li>team member</li>
  <li>administrator</li>
</ul>

<p>Each user type has permission to perform tasks based on their role and the
application’s ACL (access control list) entries.</p>

<p>Here is the diagram that describes the models:</p>

<p><img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_scenario_model.png" alt="models" /></p>

<p>And the following operations can be processed by different roles:</p>

<ul>
  <li>/projects/list-projects
    <ul>
      <li>guest, admin, owner, teamMember</li>
    </ul>
  </li>
  <li>/projects/view-all
    <ul>
      <li>admin</li>
    </ul>
  </li>
  <li>/projects/{id}/show-balance
    <ul>
      <li>owner, teamMember</li>
    </ul>
  </li>
  <li>/projects/{id}/donate
    <ul>
      <li>admin, owner, teamMember</li>
    </ul>
  </li>
  <li>/projects/{id}/withdraw
    <ul>
      <li>owner</li>
    </ul>
  </li>
</ul>

<p>This application includes some pre-created data. They are shown in the above
diagram. For example, as you can see, u1 owns project1, and u1 created a team
with u1 and u2 as members. This means u1 is the <strong>owner</strong> of project1, and u1
and u2 are the <strong>team members</strong> of project1. And u3 is the <strong>admin</strong>.</p>

<h2 id="differences-between-loopback-3-and-4">Differences Between LoopBack 3 and 4</h2>

<p>LoopBack 3 has several built-in models that consists of a RBAC system. The
models are <code class="language-plaintext highlighter-rouge">User</code>, <code class="language-plaintext highlighter-rouge">Role</code>, <code class="language-plaintext highlighter-rouge">RoleMapping</code>, <code class="language-plaintext highlighter-rouge">ACL</code>, and <code class="language-plaintext highlighter-rouge">AccessToken</code>. You can
learn how they work together in the
<a href="https://loopback.io/doc/en/lb3/Controlling-data-access.html">Controlling data access</a>
tutorial.</p>

<p>The LoopBack 4 authorization system gives developers the flexibility to
implement the RBAC on their own. You can leverage popular third-party libraries
like <a href="https://github.com/casbin/casbin">casbin</a> or <a href="https://auth0.com/">Auth0</a>
for the role mapping.</p>

<p>This guide includes a demo for using
<a href="#migrating-example-to-loopback-4-with-casbin">casbin</a> and using
<a href="#migrating-example-to-loopback-4-with-auth0">Auth0</a>(TBD)</p>

<h2 id="migrating-example-to-loopback-4-with-casbin">Migrating Example to LoopBack 4 with Casbin</h2>

<p>Let’s migrate the LoopBack 3 access control example to LoopBack 4.</p>

<p>Here is an overview of the steps:</p>

<ul>
  <li>Create models (migrates model properties)</li>
  <li>Set up login endpoint (migrates User endpoint)</li>
  <li>Set up project endpoints (migrates Project endpoints)</li>
  <li>Set up authentication (migrates boot/authentication.js)</li>
  <li>Set up authorization (This is the core of the tutorial, migrates role
resolvers and model acls)</li>
  <li>Seed data (migrates boot/sample-models.js)</li>
</ul>

<h3 id="creating-models">Creating models</h3>

<p>There are four models involved in this example. Three of them are migrated from
<a href="https://github.com/strongloop/loopback-example-access-control/tree/master/common/models">the original models</a>
(<code class="language-plaintext highlighter-rouge">Project</code>, <code class="language-plaintext highlighter-rouge">Team</code>, <code class="language-plaintext highlighter-rouge">User</code>). And we add one more model <code class="language-plaintext highlighter-rouge">UserCredentials</code> to
separate the sensitive information from the <code class="language-plaintext highlighter-rouge">User</code> model.</p>

<p>You can run <code class="language-plaintext highlighter-rouge">lb4 model</code> to create the 4 models, and then run <code class="language-plaintext highlighter-rouge">lb4 repository</code> to
create their corresponding persistency layers.</p>

<p><em>A LoopBack 3 model provides 3 layers: data shape, persistency, REST APIs,
whereas LoopBack 4 model only describes the data shape. Therefore in this
section we also need to create repositories for data persistency. You can read
about the differences in document
<a href="/doc/en/lb4/migration-models-core.html">migrating model definitions and built-in APIs</a>.</em></p>

<p><em>To keep the tutorial concise and focus on the core implementation, the detailed
commands are listed in the reference <a href="#model-creation">model creation</a>.</em></p>

<h3 id="setting-up-login-endpoint">Setting up login endpoint</h3>

<p>LoopBack 3 has a default User model with a bunch of pre-defined APIs exposed. In
this example, since we create the <code class="language-plaintext highlighter-rouge">User</code> model from scratch, we need to add the
required endpoints in the <code class="language-plaintext highlighter-rouge">UserController</code>. In the demo we only need
<code class="language-plaintext highlighter-rouge">User/login</code>.</p>

<p>This application uses token based authentication. A user logs in by providing
correct credentials (email and password) in the payload of ‘User/login’, then
gets a token back with its identity information encoded and includes it in the
header of next requests.</p>

<p>To create the login endpoint, we first run <code class="language-plaintext highlighter-rouge">lb4 controller</code> to create a
<code class="language-plaintext highlighter-rouge">UserController</code> (see <a href="#user-controller-creation">user controller creation</a>).
Then add a new controller function <code class="language-plaintext highlighter-rouge">login</code> decorated with the REST decorators
that describe the request and response (see
<a href="https://github.com/strongloop/loopback-next/tree/master/examples/access-control-migration/src/controllers/user.controller.ts">the complete user controller file</a>).
The core logic of <code class="language-plaintext highlighter-rouge">login</code> does 3 things:</p>

<ul>
  <li>call <code class="language-plaintext highlighter-rouge">userService.verifyCredentials()</code> to verify the credentials and find the
right user.</li>
  <li>call <code class="language-plaintext highlighter-rouge">userService.convertToUserProfile()</code> to convert the user into a standard
principal shared across the authentication and authorization modules.</li>
  <li>call <code class="language-plaintext highlighter-rouge">jwtService.generateToken()</code> to encode the principal that carries the
user’s identity information into a JSON web token.</li>
</ul>

<p>To keep the controller file concise and to organize the token and user-related
utils, we will create the token service and user service in section
<a href="#setting-up-authentication">Setting up authentication</a>.</p>

<h3 id="setting-up-project-endpoints">Setting up project endpoints</h3>

<p>Next let’s create the 5 project endpoints which will be used to demo the access
of different roles. We start from creating a controller for Project (see
<a href="#project-controller-creation">project controller creation</a>). Then incrementally
add the following endpoints:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">/project/listProjects</code>: show all the projects but hide the <code class="language-plaintext highlighter-rouge">balance</code> field</li>
  <li><code class="language-plaintext highlighter-rouge">/project/viewAll</code>: show all the projects with the full information</li>
  <li><code class="language-plaintext highlighter-rouge">/project/{id}/findById</code>: show a project’s information</li>
  <li><code class="language-plaintext highlighter-rouge">/projects/{id}/donate</code>: donate to a project</li>
  <li><code class="language-plaintext highlighter-rouge">/projects/{id}/withdraw</code>: withdraw from a project</li>
</ul>

<p>The complete code can be found in
<a href="https://github.com/strongloop/loopback-next/tree/master/examples/access-control-migration/src/controllers/project.controller.ts">src/controller/project.controller.ts</a></p>

<h3 id="setting-up-authentication">Setting up authentication</h3>

<div class="alert alert-info" role="alert">
  <p><i class="fa fa-info-circle"></i>
<b>Note:</b>
 This section will be simplified by the following GitHub issue: <a href="https://github.com/strongloop/loopback-next/issues/4753">loopback-next#4753</a></p>

</div>

<p>This demo uses token based authentication, and it uses the jwt authentication
strategy to verify a user’s identity. The authentication setup is borrowed from
<a href="https://github.com/strongloop/loopback4-example-shopping/tree/master/packages">loopback4-example-shopping</a>.
The authentication system aims to understand <strong>who sends the request</strong>. It
retrieves the token from a request, decodes the user’s information in it as
<code class="language-plaintext highlighter-rouge">principal</code>, then passes the <code class="language-plaintext highlighter-rouge">principal</code> to the authorization system which will
decide the <code class="language-plaintext highlighter-rouge">principal</code>’s access later.</p>

<p>To simplify the implementation for readers, we extracted the services and
bindings into a component in folder <code class="language-plaintext highlighter-rouge">src/components/jwt-authentication</code>, it
consists of the following files:</p>

<ul>
  <li>creating the jwt authentication strategy to decode the user profile from
token. See file
<a href="https://github.com/strongloop/loopback-next/tree/master/examples/access-control-migration/src/components/jwt-authentication/jwt.auth.strategy.ts">jwt.auth.strategy.ts</a>.</li>
  <li>creating the token service to organize utils for token operations. See file
<a href="https://github.com/strongloop/loopback-next/tree/master/examples/access-control-migration/src/components/jwt-authentication/jwt.service.ts">jwt.service.ts</a>.</li>
  <li>creating user service to organize utils for user operations. see file
<a href="https://github.com/strongloop/loopback-next/tree/master/examples/access-control-migration/src/components/jwt-authentication/user.service.ts">user.service.ts</a>.</li>
  <li>adding OpenAPI security specification to your app so that the explorer has an
Authorize button to setup the token for secured endpoints. See file
<a href="https://github.com/strongloop/loopback-next/tree/master/examples/access-control-migration/src/components/jwt-authentication/security.spec.ts">security.spec.ts</a>.</li>
  <li>creating bindings for the above services. See file
<a href="https://github.com/strongloop/loopback-next/blob/master/examples/access-control-migration/src/components/jwt-authentication/keys.ts">keys.ts</a>.</li>
</ul>

<p>You can enable the jwt authentication by mounting the authentication component
in the application constructor:</p>

<div id="src/application.ts" class="code-caption">
  <p>src/application.ts</p>
</div>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Add this line to import the component</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">JWTAuthenticationComponent</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./components/jwt-authentication</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">AccessControlApplication</span> <span class="kd">extends</span> <span class="nx">BootMixin</span><span class="p">(</span>
  <span class="nx">ServiceMixin</span><span class="p">(</span><span class="nx">RepositoryMixin</span><span class="p">(</span><span class="nx">RestApplication</span><span class="p">)),</span>
<span class="p">)</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">options</span><span class="p">:</span> <span class="nx">ApplicationConfig</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="c1">// Add this line to mount the jwt authentication component</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="nx">JWTAuthenticationComponent</span><span class="p">);</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Finally decorate the 4 project endpoints (excluding the public <code class="language-plaintext highlighter-rouge">listProjects</code>)
with <code class="language-plaintext highlighter-rouge">@authenticate('jwt')</code>. See example for endpoint
<a href="https://github.com/strongloop/loopback-next/tree/master/examples/access-control-migration/src/controllers/project.controller.ts#L90">viewAll</a></p>

<h3 id="setting-up-authorization">Setting up authorization</h3>

<h4 id="background">Background</h4>

<p>The authorization system aims to decide, given a principal passed from the
authentication system, whether it has access to a resource.</p>

<p>In LoopBack 3, the access control rules for APIs are described by a model
configuration property called ‘acls’. In our case they were defined in
<a href="https://github.com/strongloop/loopback-example-access-control/blob/master/common/models/project.json#L21-L61">models/project.json</a>.</p>

<p>For example, the acl for endpoint <code class="language-plaintext highlighter-rouge">/projects/{id}/findById</code> is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "accessType": "READ",
  "principalType": "ROLE",
  "principalId": "teamMember",
  "permission": "ALLOW",
  "property": "findById"
},
</code></pre></div></div>

<p>It means only team members have access to the resource returned by
<code class="language-plaintext highlighter-rouge">/projects/{id}/findById</code>. And the authorization system is responsible to figure
out whether a principal is a team member of <code class="language-plaintext highlighter-rouge">project${id}</code>, which is considered
as role resolving.</p>

<h4 id="role-resolving">Role Resolving</h4>

<p>Role resolving is the core of an RBAC system. In the original application, you
create and register role resolvers to resolve a role at run time. Role <code class="language-plaintext highlighter-rouge">admin</code>
is defined in
<a href="https://github.com/strongloop/loopback-example-access-control/blob/master/server/boot/sample-models.js#L62">sample-models.js</a>
and <code class="language-plaintext highlighter-rouge">teamMember</code> is defined and registered in
<a href="https://github.com/strongloop/loopback-example-access-control/blob/master/server/boot/role-resolver.js">role-resolver</a>.</p>

<p>In the migrated application, we use a 3rd-party library
<a href="https://github.com/casbin/casbin">casbin</a> to resolve the role.</p>

<h4 id="using-casbin">Using Casbin</h4>

<ul>
  <li>Overview of casbin</li>
</ul>

<p><a href="https://casbin.org/docs/en/overview">Casbin</a> is a powerful and efficient
open-source access control library. It uses policies to make decisions: whether
a subject can perform an action on a certain object. It enforces the policy in
the classic <code class="language-plaintext highlighter-rouge">{subject, object, action}</code> form or a customized form as you
defined, both allow and deny authorizations are supported. And it manages the
role-user mappings and role-role mappings (aka role hierarchy in RBAC).</p>

<p>In our example, the casbin system works as a whole to make decisions. The
following diagram explains how the authorization system and casbin system work
together:</p>

<p><img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_authorization_casbin.png" alt="authorization-casbin" /></p>

<ul>
  <li>Model and Policies</li>
</ul>

<p>If you are not familiar with casbin, you can take a look of the brief summary of
<a href="#usage-of-casbin">our usage of casbin</a> in the reference.</p>

<p>The Casbin system consists of a model file and policy files. The model file
describes the shape of request, policy, role mapping, and the decision rules.
And to optimize the enforcers, policies are divided into multiple smaller ones
based on roles.</p>

<p>Here is the screenshot of the model file and policy file of role “teamMember”,
different colors maps to different concepts:</p>

<p><img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_casbin_model_policy.png" alt="casbin-model-policy" /></p>

<p>Based on the screenshot, suppose u2(user with id 2) makes a request to
‘/projects/1/donate’, the authorization system will send subject as u2, object
as project1, action as donate to casbin. And since u2 inherits role p1_team, and
p1_team can perform donate on project1, casbin system returns allow to the
authorization system.</p>

<h4 id="migrating-authorization">Migrating Authorization</h4>

<p>First let’s migrate the ACLs. Access control information is considered as
authorization metadata, and provided in decorator <code class="language-plaintext highlighter-rouge">@authorize()</code>. Referring back
to the Project controller file, we can now specify the following fields for each
endpoint:</p>

<ul>
  <li>resource: the resource name, it’s ‘project’ in this controller</li>
  <li>scopes: it maps to the action in the casbin policy</li>
  <li>allowedRoles: since the casbin system handles the role resolving, this field
is for optimizing the comparison scope. E.g. when executing the enforcer to
make decision, only compares with the policies in the admin policy file.</li>
</ul>

<p>To make the tutorial concise, the code details is omitted here. You can find the
ACLs and how the endpoints are decorated in file
<a href="https://github.com/strongloop/loopback-next/tree/master/examples/access-control-migration/src/controllers/project.controller.ts">src/controller/project.controller.ts</a></p>

<p>Next, we write the authorizer that calls casbin enforcers to make the decision.</p>

<ol>
  <li>
    <p>Create an authorizer that retrieves the authorization metadata from context,
then execute casbin enforcers to make decision.</p>

    <p><em>If you are not familiar with the concept authorizer, you can learn it in the
document
<a href="../../Loopback-component-authorization#programming-access-policies">Programming Access Policies</a></em></p>

    <p>The complete authorizer file can be found in
<a href="https://github.com/strongloop/loopback-next/blob/master/examples/access-control-migration/src/components/casbin-authorization/services/casbin.authorizer.ts">components/casbin-authorization/services/casbin.authorizer.ts</a>.
It retrieves the three required fields from the authorization context:
subject from <code class="language-plaintext highlighter-rouge">principal</code>, <code class="language-plaintext highlighter-rouge">resource</code> as object, and action, to invoke casbin
enforcers and make decision.</p>
  </li>
  <li>
    <p>Create a voter for instance level endpoints to append the project id to the
resource name</p>

    <p>Class level means operations applied to all projects like <code class="language-plaintext highlighter-rouge">/projects/*</code>,
whereas instance level operation applies to a certain project like
<code class="language-plaintext highlighter-rouge">/project{id}/*</code>. For instance level endpoints, the resource name should
include the resource’s <code class="language-plaintext highlighter-rouge">id</code>. Since the <code class="language-plaintext highlighter-rouge">id</code> comes from the request, the
endpoint metadata cannot provide it and therefore we define the pre-process
logic in a voter to generate the resource name as <code class="language-plaintext highlighter-rouge">project${id}</code>, then passes
it to the authorizer.</p>

    <p>The complete voter file can be found in file
<a href="https://github.com/strongloop/loopback-next/blob/master/examples/access-control-migration/src/components/casbin-authorization/services/assign-project-instance-id.voter.ts">components/casbin-authorization/services/assign-project-instance-id.voter.ts</a></p>
  </li>
  <li>
    <p>Create casbin enforcers</p>

    <p>A casbin enforcer is configured with a policy file. It compares the given
data with the policy file and returns a decision when invoked. To optimize
the scope and speed of the access check, this example splits the policies
into separate files per role. The authorizer will only invoke the enforcers
for allowed role(s).</p>

    <p>The complete enforcer file can be found in file
<a href="https://github.com/strongloop/loopback-next/blob/master/examples/access-control-migration/src/components/casbin-authorization/services/casbin.enforcers.ts">components/casbin-authorization/services/casbin.enforcers.ts</a></p>
  </li>
  <li>
    <p>Write casbin model and policies</p>

    <p>Since the model and policy are already covered in section
<a href="#using-casbin">Using Casbin</a>, we will not repeat it here. The corresponding
files are defined in folder
<a href="https://github.com/strongloop/loopback-next/blob/master/examples/access-control-migration/fixtures/casbin">fixtures/casbin</a>.</p>
  </li>
  <li>
    <p>Mount the casbin authorization system as a component</p>

    <p>The casbin authorizer, voter and enforcers above are packed under component
‘src/components/casbin-authorization’. You can export their bindings in a
<a href="https://github.com/strongloop/loopback-next/blob/master/examples/access-control-migration/src/components/casbin-authorization/casbin-authorization-component.ts">component file</a>
and mount the component in the application constructor:</p>

    <div id="src/application.ts" class="code-caption">
      <p>src/application.ts</p>
    </div>
  </li>
</ol>
<p>&lt;/div&gt;</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="c1">// Add this line to import the component</span>
   <span class="k">import</span> <span class="p">{</span><span class="nx">CasbinAuthorizationComponent</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./components/casbin-authorization</span><span class="dl">'</span><span class="p">;</span>

   <span class="k">export</span> <span class="kd">class</span> <span class="nx">AccessControlApplication</span> <span class="kd">extends</span> <span class="nx">BootMixin</span><span class="p">(</span>
     <span class="nx">ServiceMixin</span><span class="p">(</span><span class="nx">RepositoryMixin</span><span class="p">(</span><span class="nx">RestApplication</span><span class="p">)),</span>
   <span class="p">)</span> <span class="p">{</span>
     <span class="kd">constructor</span><span class="p">(</span><span class="nx">options</span><span class="p">:</span> <span class="nx">ApplicationConfig</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
       <span class="c1">// ...</span>
       <span class="c1">// Add this line to mount the casin authorization component</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="nx">CasbinAuthorizationComponent</span><span class="p">);</span>
       <span class="c1">// ...</span>
     <span class="p">}</span>
   <span class="p">}</span>
</code></pre></div></div>

<ol>
  <li>
    <p>Casbin persistency and synchronize(2nd Phase implementation, TBD)</p>

    <p>This will be supported at the 2nd phase of implementation. The plan is to
have model or operation hooks to update the casbin policies when new data
created. It requires a persistent storage for casbin policies (see reference
in
<a href="https://github.com/casbin/casbin#policy-persistence">casbin policy persistence</a>).
Here is an overview of the hooks:</p>

    <ul>
      <li>when create a new project
        <ul>
          <li>create a set of p, project${id}_owner, action policies</li>
          <li>create a set of p, project${id}_team, action policies</li>
        </ul>
      </li>
      <li>add a new user to a team
        <ul>
          <li>find the projects owned by the team owner, then create role inherit rules
g, u${id}, project${id}_team</li>
        </ul>
      </li>
      <li>add a new endpoint(operation)
        <ul>
          <li>for each of its allowed roles, add p, ${role}, action policy</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<h4 id="summary">Summary</h4>

<p>The following diagram summarizes the authorization mechanism described above:</p>

<p><img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_mechanism.png" alt="mechanism" /></p>

<h3 id="seeding-data">Seeding Data</h3>

<p>The application has pre-created data to try each role’s permission. The original
example seeds data in the boot script, now they are migrated to an observer file
called <code class="language-plaintext highlighter-rouge">sample.observer.ts</code>.</p>

<p><em>Since the data are already generated in <code class="language-plaintext highlighter-rouge">db.json</code>, that observer file is
skipped by default.</em></p>

<h3 id="try-it-out">Try It Out</h3>

<p>Start the application:</p>

<ul>
  <li>Run <code class="language-plaintext highlighter-rouge">npm start</code> to start the application.</li>
  <li>Open the explorer</li>
</ul>

<p>Try the ‘admin’ role:</p>

<ul>
  <li>Login as admin first (user Bob)
    <ul>
      <li>Go to UserController, try endpoint <code class="language-plaintext highlighter-rouge">users/login</code> with {“email”:
“bob@projects.com”, “password”: “opensesame”}
<img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_login.png" alt="auth_example_login" /></li>
      <li>Get the returned token
<img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_get_token.png" alt="auth_example_get_token" /></li>
      <li>Click the authorize button and paste the token
<img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_set_token.png" alt="auth_example_set_token" /></li>
    </ul>
  </li>
  <li>Try the 5 endpoints, ‘show-balance’ and ‘withdraw’ will return 401, others
succeed
    <ul>
      <li>A sample screenshot for ‘withdraw’:
<img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_withdraw.png" alt="auth_example_withdraw" />
<img src="/pages/en/lb4/imgs/tutorials/access-control-migration/auth_example_withdraw_401.png" alt="auth_example_withdraw_401" /></li>
    </ul>
  </li>
</ul>

<p>Try the ‘owner’ role:</p>

<ul>
  <li>Login as owner (user John)
    <ul>
      <li>Go to UserController, try endpoint <code class="language-plaintext highlighter-rouge">users/login</code> with {“email”:
“John@projects.com”, “password”: “opensesame”}</li>
      <li>Get the returned token</li>
      <li>Click authorize button and paste the token</li>
    </ul>
  </li>
  <li>Try the 5 endpoints, ‘view-all’ will return 401, others succeed</li>
</ul>

<p>Try the ‘team-member’ role:</p>

<ul>
  <li>Login as team-member (user Jane)
    <ul>
      <li>Go to UserController, try endpoint <code class="language-plaintext highlighter-rouge">users/login</code> with {“email”:
“Jane@projects.com”, “password”: “opensesame”}</li>
      <li>Get the returned token</li>
      <li>Click authorize button and paste the token</li>
    </ul>
  </li>
  <li>Try the 5 endpoints, ‘show-balance’ and ‘donate’ will succeed, others returns
401</li>
</ul>

<h2 id="references">References</h2>

<h3 id="model-creation">Model Creation</h3>

<p>Import model <code class="language-plaintext highlighter-rouge">User</code>, <code class="language-plaintext highlighter-rouge">Project</code>, <code class="language-plaintext highlighter-rouge">Team</code> from the LB3 application by the migration
CLI:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>lb4 import-lb3-models &lt;path_to_loopback-example-access-control&gt; <span class="nt">--outDir</span> src/models
</code></pre></div></div>

<p>Choose model <code class="language-plaintext highlighter-rouge">User</code>, <code class="language-plaintext highlighter-rouge">Project</code>, <code class="language-plaintext highlighter-rouge">Team</code> for the prompt.</p>

<p>For model <code class="language-plaintext highlighter-rouge">UserCredentials</code>, you need to create it by <code class="language-plaintext highlighter-rouge">lb4 model</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>lb4 model
? Model class name: UserCredentials
? Please <span class="k">select </span>the model base class Entity <span class="o">(</span>A persisted model with an ID<span class="o">)</span>
? Allow additional <span class="o">(</span>free-form<span class="o">)</span> properties? Yes
Model UserCredentials will be created <span class="k">in </span>src/models/user-credentials.model.ts

Lets add a property to UserCredentials
Enter an empty property name when <span class="k">done</span>

? Enter the property name: <span class="nb">id</span>
? Property <span class="nb">type</span>: number
? Is <span class="nb">id </span>the ID property? Yes
? Is <span class="nb">id </span>generated automatically? No
? Is it required?: Yes
? Default value <span class="o">[</span>leave blank <span class="k">for </span>none]:

Lets add another property to UserCredentials
Enter an empty property name when <span class="k">done</span>

? Enter the property name: password
? Property <span class="nb">type</span>: string
? Is it required?: Yes
? Default value <span class="o">[</span>leave blank <span class="k">for </span>none]:

Lets add another property to UserCredentials
Enter an empty property name when <span class="k">done</span>

? Enter the property name: userId
? Property <span class="nb">type</span>: number
? Is it required?: Yes
? Default value <span class="o">[</span>leave blank <span class="k">for </span>none]:

Lets add another property to UserCredentials
Enter an empty property name when <span class="k">done</span>

? Enter the property name:
   create src/models/user-credentials.model.ts
   update src/models/index.ts

Model UserCredentials was created <span class="k">in </span>src/models/
</code></pre></div></div>

<p>Considering the difference between the original application and the migrated
one, you need to adjust the properties a bit for the three migrated models.</p>

<ul>
  <li>
    <p>For <code class="language-plaintext highlighter-rouge">Project</code>, open file <code class="language-plaintext highlighter-rouge">src/models/project.model.ts</code></p>

    <ul>
      <li>decorate <code class="language-plaintext highlighter-rouge">ownerId</code> with <code class="language-plaintext highlighter-rouge">@belongsTo(() =&gt; User)</code> and remove the generated
<code class="language-plaintext highlighter-rouge">@property</code> decorator.</li>
      <li><code class="language-plaintext highlighter-rouge">balance</code> should be a required property: change it from <code class="language-plaintext highlighter-rouge">balance?</code> to
<code class="language-plaintext highlighter-rouge">balance</code></li>
    </ul>
  </li>
  <li>
    <p>For <code class="language-plaintext highlighter-rouge">Team</code>, open file <code class="language-plaintext highlighter-rouge">src/models/team.model.ts</code></p>

    <ul>
      <li>replace <code class="language-plaintext highlighter-rouge">memberId</code> with <code class="language-plaintext highlighter-rouge">memberIds</code> as an array:
        <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="p">@</span><span class="nd">property</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">array</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">itemType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">number</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">required</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="nx">memberIds</span><span class="p">:</span> <span class="kr">number</span><span class="p">[];</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>For <code class="language-plaintext highlighter-rouge">User</code>, open file <code class="language-plaintext highlighter-rouge">src/models/user.model.ts</code></p>

    <ul>
      <li>remove <code class="language-plaintext highlighter-rouge">password</code> because we have a <code class="language-plaintext highlighter-rouge">UserCredential</code> model created to
separate it from <code class="language-plaintext highlighter-rouge">User</code></li>
    </ul>
  </li>
  <li>
    <p>For all the three models above, allow generating their <code class="language-plaintext highlighter-rouge">id</code> field:</p>
    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">property</span><span class="p">({</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">number</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="c1">// change it from `true` to `false`</span>
  <span class="na">generated</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">updateOnly</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">})</span>
<span class="c1">// change it from optional `id?` to required `id`</span>
<span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>Create corresponding repositories:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>lb4 repository
? Please <span class="k">select </span>the datasource DbDatasource
? Select the model<span class="o">(</span>s<span class="o">)</span> you want to generate a repository Project, Team, UserCredentials, User
? Please <span class="k">select </span>the repository base class DefaultCrudRepository <span class="o">(</span>Juggler bridge<span class="o">)</span>
</code></pre></div></div>

<p>Create relations:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Project</code> belongsTo <code class="language-plaintext highlighter-rouge">User</code></li>
</ul>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lb4 relation
? Please <span class="k">select </span>the relation <span class="nb">type </span>belongsTo
? Please <span class="k">select </span><span class="nb">source </span>model Project
? Please <span class="k">select </span>target model User
? Foreign key name to define on the <span class="nb">source </span>model ownerId
? Relation name owner
? Allow Project queries to include data from related User instances? Yes
</code></pre></div></div>

<div class="alert alert-success" role="alert">
  <p><i class="fa fa-check-square-o"></i>
  <b>Tip:</b> 
Please delete the generated controller file <code class="language-plaintext highlighter-rouge">src/controllers/project-user.controller.ts</code> to keep the exposed endpoints clean.</p>

</div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">User</code> hasOne <code class="language-plaintext highlighter-rouge">UserCredentials</code></li>
</ul>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lb4 relation
? Please <span class="k">select </span>the relation <span class="nb">type </span>hasOne
? Please <span class="k">select </span><span class="nb">source </span>model User
? Please <span class="k">select </span>target model UserCredentials
? Foreign key name to define on the target model userId
? Source property name <span class="k">for </span>the relation getter <span class="o">(</span>will be the relation name<span class="o">)</span> userCredentials
? Allow User queries to include data from related UserCredentials instances? Yes
</code></pre></div></div>

<div class="alert alert-success" role="alert">
  <p><i class="fa fa-check-square-o"></i>
  <b>Tip:</b> 
Please delete the generated controller file <code class="language-plaintext highlighter-rouge">src/controllers/user-user-credentials.controller.ts</code> to keep the exposed endpoints clean.</p>

</div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">User</code> hasMany <code class="language-plaintext highlighter-rouge">Team</code></li>
</ul>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lb4 relation
? Please <span class="k">select </span>the relation <span class="nb">type </span>hasMany
? Please <span class="k">select </span><span class="nb">source </span>model User
? Please <span class="k">select </span>target model Team
? Foreign key name to define on the target model ownerId
? Source property name <span class="k">for </span>the relation getter <span class="o">(</span>will be the relation name<span class="o">)</span> teams
? Allow User queries to include data from related Team instances? Yes
</code></pre></div></div>

<div class="alert alert-success" role="alert">
  <p><i class="fa fa-check-square-o"></i>
  <b>Tip:</b> 
Please delete the generated controller file <code class="language-plaintext highlighter-rouge">src/controllers/user-team.controller.ts</code> to keep the exposed endpoints clean.</p>

</div>

<h3 id="user-controller-creation">User Controller Creation</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>lb4 controller
? Controller class name: User
Controller User will be created <span class="k">in </span>src/controllers/user.controller.ts

? What kind of controller would you like to generate? REST Controller with CRUD functions
? What is the name of the model to use with this CRUD repository? User
? What is the name of your CRUD repository? UserRepository
? What is the name of ID property? <span class="nb">id</span>
? What is the <span class="nb">type </span>of your ID? number
? Is the <span class="nb">id </span>omitted when creating a new instance? No
? What is the base HTTP path name of the CRUD operations? /users
   create src/controllers/user.controller.ts
   update src/controllers/index.ts

Controller User was created <span class="k">in </span>src/controllers/
</code></pre></div></div>

<h3 id="project-controller-creation">Project Controller Creation</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>lb4 controller
? Controller class name: Project
Controller Project will be created <span class="k">in </span>src/controllers/project.controller.ts

? What kind of controller would you like to generate? REST Controller with CRUD functions
? What is the name of the model to use with this CRUD repository? Project
? What is the name of your CRUD repository? ProjectRepository
? What is the name of ID property? <span class="nb">id</span>
? What is the <span class="nb">type </span>of your ID? number
? Is the <span class="nb">id </span>omitted when creating a new instance? No
? What is the base HTTP path name of the CRUD operations? /projects
   create src/controllers/project.controller.ts
   update src/controllers/index.ts

Controller Project was created <span class="k">in </span>src/controllers/
</code></pre></div></div>

<h3 id="usage-of-casbin">Usage of Casbin</h3>

<p>The app has very basic usage of casbin:</p>

<ul>
  <li>uses a model file to describe the shape of request, policy, role mapping, and
the decision rules.
    <ul>
      <li>syntax doc for <a href="https://casbin.org/docs/en/syntax-for-models">casbin models</a></li>
      <li>syntax doc for <a href="https://casbin.org/docs/en/rbac">casbin role inheritance</a></li>
      <li>what is request definition: a set of info collected from the client request.
In our case: subject, object, operation</li>
      <li>what is policy definition: who has permission for what. In our case the info
are same as request: subject, object, operation</li>
      <li>when make a decision, the casbin enforcer compares the info from request to
the policies</li>
    </ul>
  </li>
  <li>uses policy files to store the policies.
    <ul>
      <li>the casbin docs I post above also contain the policy examples</li>
      <li>divide policy files into multiple smaller ones based on roles</li>
    </ul>
  </li>
</ul>


    <div class="tags">
      
    </div>
</div>

<hr class="shaded"/>

<footer id="container">
            <div class="row">
                <div class="col-md-6 footer-left">
               &copy;2021 IBM / StrongLoop. All rights reserved. <br />
 Site last generated: Mar 22, 2021
              </div>
              <div class="col-md-6 footer-right">
                <p><img src="https://loopback.io/images/company_logo.png" alt="Company logo"/></p>
              </div>
            </div>
</footer>


        </div>
        <!-- /.row -->
</div>
<!-- /.container -->
    </div>
</body>

</html>
