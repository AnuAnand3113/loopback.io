<!DOCTYPE html>
<head>
    

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="keywords" content=" LoopBack 4.0, LoopBack 4, Node.js, TypeScript, OpenAPI, Interceptor">
  <title>Interceptor | LoopBack Documentation</title>
  <link rel="stylesheet" href="/css/syntax.css">

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/modern-business.css">
    <link rel="stylesheet" href="/css/lavish-bootstrap.css">
    <link rel="stylesheet" href="/css/customstyles.css">
    <link rel="stylesheet" href="/css/theme-v4.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150726441-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150726441-2');
</script>


    <!-- github star button -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>


    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.0/anchor.min.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/customscripts.js"></script>

    <link rel="shortcut icon" href="/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->


    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand no_icon" href="/doc/index.html">
              <img class="no_icon" style="width:147px;" src="/images/branding/logo/white/loopback.svg">&nbsp;<span class="projectTitle"></span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is  -->
                          
                            <li><a href="https://loopback.io/doc/en/lb4/apidocs.index.html" target="_blank">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is  -->
                          
                            <li><a href="http://apidocs.loopback.io" target="_blank">LoopBack 3.x</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">View<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is / -->
                          
                            <li><a href="/">LoopBack Overview</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/en/lb4/ -->
                          
                            <li class="dropdownActive"><a href="/doc/en/lb4/">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/en/lb3/ -->
                          
                            <li><a href="/doc/en/lb3/">LoopBack 3.x</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/en/lb2/ -->
                          
                            <li><a href="/doc/en/lb2/">LoopBack 2.x</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/en/community/ -->
                          
                            <li><a href="/doc/en/community/">Community projects</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/en/contrib/ -->
                          
                            <li><a href="/doc/en/contrib/">Contributing to LoopBack</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/en/sec/ -->
                          
                            <li><a href="/doc/en/sec/">Security advisories</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is  -->
                          
                            <li><a href="https://github.com/strongloop/loopback.io" target="_blank">Docs Github Repo</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs-announcements" target="_blank">Announcements Mailing List</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs" target="_blank">Developer Forum</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is  -->
                          
                            <li><a href="https://join.slack.com/t/loopbackio/shared_invite/zt-8lbow73r-SKAKz61Vdao~_rGf91pcsw" target="_blank">LoopBack on Slack</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is  -->
                          
                            <li><a href="https://stackoverflow.com/questions/tagged/strongloop+or+loopback4+or+loopbackjs" target="_blank">LoopBack on Stack Overflow</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is  -->
                          
                            <li><a href="https://strongloop.com/strongblog/tag_LoopBack.html" target="_blank">StrongLoop Blog - LoopBack</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Translations<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/es/lb2/ -->
                          
                            <li><a href="/doc/es/lb2/">Español (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/es/lb4/ -->
                          
                            <li><a href="/doc/es/lb4/">Español (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/fr/lb2/ -->
                          
                            <li><a href="/doc/fr/lb2/">Français (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/fr/lb4/ -->
                          
                            <li><a href="/doc/fr/lb4/">Français (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/ko/lb2/ -->
                          
                            <li><a href="/doc/ko/lb2/">한국어 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/ko/lb3/ -->
                          
                            <li><a href="/doc/ko/lb3/">한국어 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/pt-br/lb2/ -->
                          
                            <li><a href="/doc/pt-br/lb2/">Português (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/pt-br/lb4/ -->
                          
                            <li><a href="/doc/pt-br/lb4/">Português (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/ja/lb2/ -->
                          
                            <li><a href="/doc/ja/lb2/">日本語 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/ja/lb3/ -->
                          
                            <li><a href="/doc/ja/lb3/">日本語 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/ja/lb4/ -->
                          
                            <li><a href="/doc/ja/lb4/">日本語 (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/ru/lb2/ -->
                          
                            <li><a href="/doc/ru/lb2/">Pусский (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/zh/lb2/ -->
                          
                            <li><a href="/doc/zh/lb2/">中文 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Interceptor.html .... folderitem.url is /doc/zh/lb4/ -->
                          
                            <li><a href="/doc/zh/lb4/">中文 (v4)</a></li>
                          
                        
                    </ul>
                </li>
                
                
                
                <li>
                    <form id="search" name="search" class="input-group lb-search" action="/search" method="GET">
                        <input type="text" class="form-control search-bar" placeholder="Search (powered by Watson)" name="q">
                        
                          <input type="hidden" name="sidebar" value="lb4_sidebar">
                        
                        <div class="input-group-btn">
                            <button type="submit" class="btn btn-default" aria-label="search">
                              <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button>
                        </div>
                      </form>
                </li>
            </ul>
        </div>
      </div>
</nav>

<!-- Page Content -->
<div class="container">
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <nav class="col-md-3 sidebar-col">
          











<!-- NOTE: sidebar = site.data.sidebars.mydoc_sidebar.entries -->
<div class="sidebarTitle"><a href="index.html">LoopBack 4</a></div>
<ul id="mysidebar" class="nav-list">
  

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="index.html">Overview</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Getting-started.html">Getting started</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Inside-LoopBack-Application.html">Inside a LoopBack Application</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent-expand   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building LoopBack Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Tutorials.html">Tutorials</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-tutorial.html">Todo Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-scaffolding.html">Create your app scaffolding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-model.html">Add the Todo model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-datasource.html">Add a Datasource</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-repository.html">Add a Repository</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-controller.html">Add a Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-putting-it-together.html">Putting it all together</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-geocoding-service.html">Bonus: Integrate with a geo-coding service</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-list-tutorial.html">TodoList Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-model.html">Add TodoList Model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-repository.html">Add TodoList Repository</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-list-tutorial-relations.html">Add Model Relations</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-has-one-relation.html">Add a HasOne Relation</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-controller.html">Add TodoList Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-sqldb.html">Running on relational databases</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-back-end.html">Connecting to Back-end Service Tutorials</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="soap-calculator-tutorial.html">SOAP Web Service Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-web-service-overview.html">SOAP Web Service Overview</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-scaffolding.html">App scaffolding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-datasource.html">Add a Datasource</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-service.html">Add a Service</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-controller.html">Add a Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-run-and-test.html">Run and Test it</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="express-with-lb4-rest-tutorial.html">Creating an Express Application with LoopBack REST API</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-tutorial.html">How to secure your LoopBack 4 application with JWT authentication</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="core-tutorial.html">Build large scale Node.js projects with LoopBack 4</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part1.html">Introduction of the application scenario</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part2.html">Architectural challenges</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part3.html">Context in action</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part4.html">Dependency injection</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part5.html">Extension point and extensions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part6.html">Interception</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part7.html">Observation of life cycle events</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part8.html">Configuration</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part9.html">Discover and load artifacts by convention</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part10.html">Advanced Recipes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part11.html">Summary</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Examples.html">Examples</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-examples.html">Community examples</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">How-to guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building REST APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-crud-rest-apis.html">Creating CRUD REST APIs from a model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-how-openapi-spec-is-served.html">Customizing how OpenAPI spec is served</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-routes.html">Customizing routes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Dynamic-models-repositories-controllers.html">Dynamically adding models, repositories, and controllers</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Self-hosted-rest-api-explorer.html">Self-hosted REST API Explorer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Serving-static-files.html">Serving Static Files</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Accessing-http-request-response.html">Accessing HTTP Request and Response Objects</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="File-upload-download.html">Uploading and Downloading Files</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Express-middleware.html">Using Express Middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-strong-error-handler.html">Using strong-error-handler</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Boot-and-Mount-a-LoopBack-3-application.html">Boot and Mount a LoopBack 3 Application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Integrating-with-api-connect.html">Integrating with API Connect</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Accepting-messagepack-over-http.html">Accepting MessagePack over HTTP</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Creating Other Forms of APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="GraphQL.html">Creating GraphQL APIs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-openapi-to-graphql.html">Using OpenAPI-to-GraphQL</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Creating-artifacts-runtime.html">Creating Artifacts at Runtime</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-model-runtime.html">Creating Model at Runtime</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-datasource-runtime.html">Creating DataSource at Runtime</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-repository-runtime.html">Creating Repositories at Runtime</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building frontend applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Building-frontend-angular-application.html">Building an Angular Application from OpenAPI Specification</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-server-configuration.html">Customizing Server configuration</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Migrate-from-legacy-sequence.html">Migrate from Legacy Sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Running-cron-jobs.html">Running cron jobs</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Accessing Databases</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Configuring-datasource.html">Configuring DataSource</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Working-with-data.html">Working with data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Querying-data.html">Querying data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Fields-filter.html">Fields filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Include-filter.html">Include filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Limit-filter.html">Limit filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Order-filter.html">Order filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Skip-filter.html">Skip filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Where-filter.html">Where filter</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-database-transactions.html">Using Database Transactions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Database-migrations.html">Database Migrations</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Executing-database-commands.html">Executing database commands</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Using TypeORM</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-typeorm-with-loopback.html">How to use TypeORM with LoopBack</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Accessing-services.html">Accessing Services</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Calling-soap-web-services.html">Calling SOAP Web services</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Calling-rest-apis.html">Calling REST APIs</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Parsing-requests-guide.html">Parsing requests</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Validation.html">Validating Data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-REST-layer.html">Validation in REST Layer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-controller-repo-service-layer.html">Validation in the Controller, Repository and Service Layer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-ORM-layer.html">Validation in ORM Layer</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Configuring-applications.html">Configuring Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application-setup-tips.html">Tips for Application Setup</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Securing Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Authentication-overview.html">Authentication</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-tutorial.html">Apply JWT Authentication in Todo Example</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Loopback-component-authentication.html">Authentication Component</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-decorator.html">Authentication Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-action.html">Authentication Action</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-strategy.html">Authentication Strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-options.html">Managing Custom Authentication Strategy Options</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="JWT-authentication-extension.html">JWT Authentication Extension</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Implement-your-own-strategy.html">Implement your own authentication strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-passport.html">Passport Adapter for Authentication</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Authorization-overview.html">Authorization</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="RBAC-with-authorization.html">RBAC with Authorization System</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Loopback-component-authorization.html">Authorization Component</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-interceptor.html">Interceptor</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-decorator.html">Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-authorizer.html">Authorizer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-decision-matrix.html">Decision Matrix</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-enforcer.html">Enforcer</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Deployment.html">Deploying Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Enabling-https.html">Enabling HTTPS</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Deploying-to-IBM-Cloud.html">Deploying to IBM Cloud</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="deploying_to_ibm_cloud_kubernetes.html">Deploying to Kubernetes on IBM Cloud</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="deploying-with-pm2-and-nginx.html">Deploying with pm2 and nginx</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Appsody-LoopBack.html">Developing and Deploying LoopBack Applications with Appsody</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Running-cron-jobs.html">Running cron jobs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Health.html">Health check</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Metrics.html">Metrics for Prometheus</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Pooling.html">Pooling</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Troubleshooting.html">Troubleshooting</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Setting-debug-strings.html">Setting debug strings</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Logging.html">Logging</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Context-explorer.html">Context Explorer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Debugging-tests-with-mocha.html">Debugging tests with Mocha</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent-expand   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Extending-LoopBack-4.html">Extending LoopBack Framework</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">How-to guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-components.html">Creating components</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-decorators.html">Creating decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="creating-components-rest-api.html">Contributing REST API</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="creating-components-services.html">Creating services</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-servers.html">Creating servers</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-request-body-parsing.html">Extending request body parsing</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-life-cycle.html">Extension life cycle</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-OpenAPI-specification.html">Extending OpenAPI specification</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-Model-API-builder.html">Extending Model API builder</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Testing-your-extension.html">Testing your extension</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-extensions.html">Community extensions</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Concepts.html">Concepts</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Crafting-LoopBack-4.html">Crafting LoopBack 4</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Core</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application.html">Application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Component.html">Component</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Context.html">Context</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Binding.html">Binding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Dependency-injection.html">Dependency Injection</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  active">
    
    
      <a class="page-link" href="Interceptor.html">Interceptor</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Life-cycle.html">Life Cycle Event and Observer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-point-and-extensions.html">Extension point and extensions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Service.html">Service</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Booting-an-Application.html">Booter</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Decorators.html">Decorators</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_openapi.html">OpenAPI Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_inject.html">Dependency Injection Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_authenticate.html">Authentication Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_authorize.html">Authorization Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_service.html">Service Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_repository.html">Repository Decorators</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Mixin.html">Mixin</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">REST APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Server.html">Server</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Sequence.html">Sequence</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-middleware-sequence.html">Middleware based sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-action-sequence.html">Action based sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Advanced-sequence-topics.html">Advanced topics</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Routing-requests.html">Routing requests</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Parsing-requests.html">Parsing requests</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Working-with-express-middleware.html">Working with Express Middleware</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Middleware.html">Middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Route.html">Route</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Controller.html">Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Request-response-cycle.html">Request/response cycle</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Data Access</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Model.html">Model</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Relations.html">Relations</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasMany-relation.html">HasMany Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="BelongsTo-relation.html">BelongsTo Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasOne-relation.html">HasOne Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasManyThrough-relation.html">HasManyThrough Relation</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Repository.html">Repository</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DataSource.html">DataSource</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Best-practices.html">Best practices</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Defining-the-API-using-code-first-approach.html">Defining the API using code-first approach</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Defining-your-testing-strategy.html">Defining your testing strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Testing-your-application.html">Testing your application</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Reference guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Loopback-application-layout.html">LoopBack 4 Application Layout</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="apidocs.index.html">API docs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Reserved-binding-keys.html">Reserved binding keys</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Error-codes.html">Error codes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LoopBack-types.html">LoopBack Types</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Command-line-interface.html">CLI References</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application-generator.html">Application generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Controller-generator.html">Controller generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DataSource-generator.html">DataSource generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Importing-LB3-models.html">Import models from LoopBack 3</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Model-generator.html">Model generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Discovering-models.html">Model discovery</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Relation-generator.html">Relation generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Repository-generator.html">Repository generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Rest-Crud-generator.html">REST CRUD model endpoints generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Service-generator.html">Service generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="OpenAPI-generator.html">OpenAPI generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Life-cycle-observer-generator.html">Life cycle observer generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Interceptor-generator.html">Interceptor generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-generator.html">Extension generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Download-examples.html">Download examples</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Update-generator.html">Update project dependencies</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Copyright-generator.html">Generate copyright/license headers</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Connectors-reference.html">Connectors reference</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Memory-connector.html">Memory connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Database-connectors.html">Database connectors</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Cassandra-connector.html">Cassandra connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Cloudant-connector.html">Cloudant connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Couchdb2-connector.html">CouchDB 2.x connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DashDB.html">DashDB connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-connector.html">IBM Db2 (for Linux, Unix, Windows) connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-for-i-connector.html">IBM Db2 for i connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-for-z-OS-connector.html">IBM Db2 for z/OS connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Informix.html">Informix connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="MongoDB-connector.html">MongoDB connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-MongoDB.html">MongoDB Connector Tutorial</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-MongoLab.html">Using MongoLab</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="MySQL-connector.html">MySQL connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-MySQL.html">MySQL Connector Tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Oracle-connector.html">Oracle connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Installing-the-Oracle-connector.html">Installing the Oracle connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-Oracle.html">Oracle connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="PostgreSQL-connector.html">PostgreSQL connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-PostgreSQL.html">PostgreSQL connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Redis-connector.html">Redis connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="kv-redis-connector.html">Redis key-value connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Example-kv-connector.html">KV connector example</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="SQL-Server-connector.html">SQL Server connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-Microsoft-SQL-Server.html">SQL Server connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="SQLite3.html">SQLite3 connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="zOSconnectEE.html">z/OS Connect Enterprise Edition connector</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Other-connectors.html">Other connectors</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="JSON-RPC-connector.html">JSON RPC connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="MQLight-connector.html">MQ Light connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="REST-connector.html">REST connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-connector-example.html">REST connector example</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="SOAP-connector.html">SOAP connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Strong-soap.html">Strong-soap</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="SOAP-Connector-example.html">SOAP connector example</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-SOAP.html">Connecting to SOAP web services</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="OpenAPI-connector.html">OpenAPI connector</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-connectors.html">Community connectors</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="changelog.index.html">Change logs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Deploy-for-GDPR-readiness.html">Considerations for GDPR readiness</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="code-contrib-lb4.html">Contributing to LoopBack 4</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="submitting_a_pr.html">Submitting a pull request to LoopBack 4</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="FAQ.html">FAQ</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-overview.html">Migration guide</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Understanding-the-differences.html">Understanding the differences</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LB3-vs-LB4-booting.html">Booting process</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LB3-vs-LB4-request-response-cycle.html">Request/response cycle</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-mounting-lb3app.html">Mounting a LoopBack 3 application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-express-middleware.html">Express middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-datasources.html">Datasources</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-models-overview.html">Migrating models</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-core.html">Model definitions and built-in APIs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-relations.html">Relations</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-methods.html">Custom methods</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-remoting-hooks.html">Remoting hooks</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-operation-hooks.html">CRUD operation hooks</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-mixins.html">Mixins</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-boot-scripts.html">Boot scripts</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-auth-overview.html">Authentication & authorization</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-access-control-example.html">Access control example</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-authentication.html">Built-in models and authentication</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-passport.html">Passport</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-oauth2.html">OAuth2 Provider</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-cli.html">CLI</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-extensions-overview.html">Components and extensions</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-project-layout.html">Project layout</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-models.html">Models</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-current-context.html">Current context</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-mixins.html">Mixins</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-rest-api.html">REST API</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-clients.html">Clients (API consumers)</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-not-planned.html">Features not planned</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



</ul>

        </nav>
        <!-- Content Column -->
        <div class="col-md-9">
            
<div class="post-header">
   <h1 class="post-title-main">Interceptor</h1>
   
     
       <a target="_blank" href="https://github.com/strongloop/loopback-next/blob/master/docs/site/Interceptor.md" class="githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit this page</a>
   
</div>

<div class="post-content">





 
   
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
;$(function() {
  var level = parseInt(3, 10);
  if (level === 1) {level = 'h2'}
  if (level === 2) {level = 'h2,h3'}
  if (level === 3) {level = 'h2,h3,h4'}
  if (level === 4) {level = 'h2,h3,h4,h5'}

  // Add a new level for changelog files which use h1,h2,h3
  if (level === 0) {level = 'h1,h2,h3,h4,h5'}

  var toc = $('#toc')

  toc.toc({minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: level})

  /* this offset helps with the space taken up by the floating toolbar */
  toc.on('click', 'a', function() {
    var target = $(this.getAttribute('href')),
      scroll_target = target.offset().top

    $(window).scrollTop(scroll_target - 10)
    return false
  })
  .on('click', '.toc-expand-button', function() {
    toc.find('> ul').slideToggle('fast');
  })
})
</script>

<div id="toc">
  <span class="toc-title">Page Contents</span>
  <button type="button" class="btn btn-link toc-expand-button">
    <i class="fa fa-bars"></i>
  </button>
</div>

 

    <h2 id="overview">Overview</h2>

<p>Interceptors are reusable functions to provide aspect-oriented logic around
method invocations. There are many use cases for interceptors, such as:</p>

<ul>
  <li>Add extra logic before / after method invocation, for example, logging or
measuring method invocations.</li>
  <li>Validate/transform arguments</li>
  <li>Validate/transform return values</li>
  <li>Catch/transform errors, for example, normalize error objects</li>
  <li>Override the method invocation, for example, return from cache</li>
</ul>

<p>The following diagram illustrates how interceptors can be applied to the
invocation of a method on the controller class.</p>

<p><img src="/pages/en/lb4/imgs/interceptors.png" alt="Interceptors" /></p>

<h2 id="basic-use">Basic use</h2>

<h3 id="interceptors-on-controllers">Interceptors on controllers</h3>

<p>Interceptors are supported for public controller methods (including both static
and prototype) and handler functions for REST routes.</p>

<p>Controller methods decorated with <code class="language-plaintext highlighter-rouge">@intercept</code> are invoked with applied
interceptors for corresponding routes upon API requests.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">intercept</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span> <span class="c1">// `log` is an interceptor function</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">OrderController</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="dl">'</span><span class="s1">caching-interceptor</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// `caching-interceptor` is a binding key</span>
  <span class="k">async</span> <span class="nx">listOrders</span><span class="p">(</span><span class="nx">userId</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>NOTE</strong>: <code class="language-plaintext highlighter-rouge">log</code> and <code class="language-plaintext highlighter-rouge">'caching-interceptor'</code> are illustrated in
<a href="#example-interceptors">Example interceptors</a>.</p>

<p>It’s also possible to configure global interceptors that are invoked before
method level interceptors. For example, the following code registers a global
<code class="language-plaintext highlighter-rouge">caching-interceptor</code> for all methods.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">interceptor</span><span class="p">(</span><span class="nx">CachingInterceptorProvider</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">global</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">group</span><span class="p">:</span> <span class="dl">'</span><span class="s1">caching</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">key</span><span class="p">:</span> <span class="dl">'</span><span class="s1">caching-interceptor</span><span class="dl">'</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Global interceptors are also executed for route handler functions without a
controller class. See an example in
<a href="/doc/en/lb4/Route.html#using-partial-openapi-spec-fragments">Route Handler</a>.</p>

<h3 id="create-a-proxy-to-apply-interceptors">Create a proxy to apply interceptors</h3>

<p>A
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy">proxy</a>
can be created from the target class or object to apply interceptors. This is
useful for the case that a controller declares dependencies of repositories or
services and would like to allow repository or service methods to be
intercepted.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">createProxyWithInterceptors</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">proxy</span> <span class="o">=</span> <span class="nx">createProxyWithInterceptors</span><span class="p">(</span><span class="nx">controllerInstance</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">proxy</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="dl">'</span><span class="s1">John</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p>There is also an <code class="language-plaintext highlighter-rouge">asProxyWithInterceptors</code> option for binding resolution or
dependency injection to return a proxy for the class to apply interceptors when
methods are invoked.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">DummyController</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-controller</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">asProxyWithInterceptors</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
    <span class="k">public</span> <span class="k">readonly</span> <span class="nx">myController</span><span class="p">:</span> <span class="nx">MyController</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-controller</span><span class="dl">'</span><span class="p">).</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">MyController</span><span class="p">);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">dummy-controller</span><span class="dl">'</span><span class="p">).</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">DummyController</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">dummyController</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ctx</span><span class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">DummyController</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">dummy-controller</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">dummyController</span><span class="p">.</span><span class="nx">myController</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="dl">'</span><span class="s1">John</span><span class="dl">'</span><span class="p">);</span>
<span class="p">);</span>
</code></pre></div></div>

<p>Or:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">proxy</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ctx</span><span class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">MyController</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-controller</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">asProxyWithInterceptors</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">});</span>
<span class="kd">const</span> <span class="nx">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">proxy</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="dl">'</span><span class="s1">John</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p>Please note synchronous methods (which don’t return <code class="language-plaintext highlighter-rouge">Promise</code>) are converted to
return <code class="language-plaintext highlighter-rouge">ValueOrPromise</code> (synchronous or asynchronous) in the proxy so that
interceptors can be applied. For example,</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">string</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">hello</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The proxy from an instance of <code class="language-plaintext highlighter-rouge">MyController</code> has the <code class="language-plaintext highlighter-rouge">AsyncProxy&lt;MyController&gt;</code>
type:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="c1">// the same as MyController</span>
  <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">ValueOrPromise</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// the return type becomes `ValueOrPromise&lt;string&gt;`</span>
  <span class="nx">hello</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// the same as MyController</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The return value of <code class="language-plaintext highlighter-rouge">greet</code> now has two possible types:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">string</code>: No async interceptor is applied</li>
  <li><code class="language-plaintext highlighter-rouge">Promise&lt;string&gt;</code>: At least one async interceptor is applied</li>
</ul>

<h3 id="use-invokemethod-to-apply-interceptors">Use <code class="language-plaintext highlighter-rouge">invokeMethod</code> to apply interceptors</h3>

<p>To explicitly invoke a method with interceptors, use <code class="language-plaintext highlighter-rouge">invokeMethod</code> from
<code class="language-plaintext highlighter-rouge">@loopback/context</code>. Please note <code class="language-plaintext highlighter-rouge">invokeMethod</code> is used internally by
<code class="language-plaintext highlighter-rouge">RestServer</code> for controller methods.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">invokeMethod</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">ctx</span><span class="p">:</span> <span class="nx">Context</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">();</span>

<span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">John</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Invoke a static method</span>
<span class="kd">let</span> <span class="nx">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">invokeMethod</span><span class="p">(</span><span class="nx">MyController</span><span class="p">,</span> <span class="dl">'</span><span class="s1">greetStaticWithDI</span><span class="dl">'</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">);</span>

<span class="c1">// Invoke an instance method</span>
<span class="kd">const</span> <span class="nx">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyController</span><span class="p">();</span>
<span class="nx">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">invokeMethod</span><span class="p">(</span><span class="nx">controller</span><span class="p">,</span> <span class="dl">'</span><span class="s1">greetWithDI</span><span class="dl">'</span><span class="p">,</span> <span class="nx">ctx</span><span class="p">);</span>
</code></pre></div></div>

<p>Please note that <code class="language-plaintext highlighter-rouge">invokeMethod</code> internally uses <code class="language-plaintext highlighter-rouge">invokeMethodWithInterceptors</code>
to support both injection of method parameters and application of interceptors.</p>

<h2 id="apply-interceptors">Apply interceptors</h2>

<p>Interceptors form a cascading chain of handlers around the target method
invocation. We can apply interceptors by decorating methods/classes with
<code class="language-plaintext highlighter-rouge">@intercept</code>. Please note <code class="language-plaintext highlighter-rouge">@intercept</code> does <strong>NOT</strong> return a new method wrapping
the target one. Instead, it adds some metadata instead and such information is
used by <code class="language-plaintext highlighter-rouge">invokeMethod</code> or <code class="language-plaintext highlighter-rouge">invokeWithMethodWithInterceptors</code> functions to
trigger interceptors around the target method. The original method stays intact.
Invoking it directly won’t apply any interceptors.</p>

<h3 id="intercept"><code class="language-plaintext highlighter-rouge">@intercept</code></h3>

<p>Syntax: <code class="language-plaintext highlighter-rouge">@intercept(...interceptorFunctionsOrBindingKeys)</code></p>

<p>The <code class="language-plaintext highlighter-rouge">@intercept</code> decorator adds interceptors to a class or its methods including
static and instance methods. Two flavors are accepted:</p>

<ul>
  <li>
    <p>An interceptor function</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span> <span class="c1">// Use the `log` function</span>
  <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>A binding key that can be resolved to an interface function</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="dl">'</span><span class="s1">name-validator</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// Use the `name-validator` binding</span>
  <span class="k">async</span> <span class="nx">helloWithNameValidation</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Bind options and provider for `NameValidator`</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">valid-names</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">([</span><span class="dl">'</span><span class="s1">John</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Mary</span><span class="dl">'</span><span class="p">]);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">name-validator</span><span class="dl">'</span><span class="p">).</span><span class="nx">toProvider</span><span class="p">(</span><span class="nx">NameValidator</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="method-level-interceptors">Method level interceptors</h3>

<p>A <strong>public</strong> static or prototype method on a class can be decorated with
<code class="language-plaintext highlighter-rouge">@intercept</code> to attach interceptors to the target method. Please note
interceptors don’t apply to protected or private methods.</p>

<h4 id="static-methods">Static methods</h4>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyControllerWithStaticMethods</span> <span class="p">{</span>
  <span class="c1">// Apply `log` to a static method</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
  <span class="k">static</span> <span class="k">async</span> <span class="nx">greetStatic</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply `log` to a static method with parameter injection</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
  <span class="k">static</span> <span class="k">async</span> <span class="nx">greetStaticWithDI</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">)</span> <span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="prototype-methods">Prototype methods</h4>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="c1">// Apply `logSync` to a sync instance method</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">logSync</span><span class="p">)</span>
  <span class="nx">greetSync</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply `log` to a sync instance method</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
  <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply `log` as a binding key to an async instance method</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="dl">'</span><span class="s1">log</span><span class="dl">'</span><span class="p">)</span>
  <span class="k">async</span> <span class="nx">greetWithABoundInterceptor</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply `log` to an async instance method with parameter injection</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
  <span class="k">async</span> <span class="nx">greetWithDI</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">)</span> <span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply `log` and `logSync` to an async instance method</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="dl">'</span><span class="s1">log</span><span class="dl">'</span><span class="p">,</span> <span class="nx">logSync</span><span class="p">)</span>
  <span class="k">async</span> <span class="nx">greetWithTwoInterceptors</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// No interceptors are attached</span>
  <span class="k">async</span> <span class="nx">greetWithoutInterceptors</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply `convertName` to convert `name` arg to upper case</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">convertName</span><span class="p">)</span>
  <span class="k">async</span> <span class="nx">greetWithUpperCaseName</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply `name-validator` backed by a provider class</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="dl">'</span><span class="s1">name-validator</span><span class="dl">'</span><span class="p">)</span>
  <span class="k">async</span> <span class="nx">greetWithNameValidation</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply `logError` to catch errors</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">logError</span><span class="p">)</span>
  <span class="k">async</span> <span class="nx">greetWithError</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">error: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">name</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="class-level-interceptors">Class level interceptors</h3>

<p>To apply interceptors to be invoked for all methods on a class, we can use
<code class="language-plaintext highlighter-rouge">@intercept</code> to decorate the class. When a method is invoked, class level
interceptors (if not explicitly listed at method level) are invoked before
method level ones.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Apply `log` to all methods on the class</span>
<span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
<span class="kd">class</span> <span class="nx">MyControllerWithClassLevelInterceptors</span> <span class="p">{</span>
  <span class="c1">// The class level `log` will be applied</span>
  <span class="k">static</span> <span class="k">async</span> <span class="nx">greetStatic</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// A static method with parameter injection</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
  <span class="k">static</span> <span class="k">async</span> <span class="nx">greetStaticWithDI</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">)</span> <span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// We can apply `@intercept` multiple times on the same method</span>
  <span class="c1">// This is needed if a custom decorator is created for `@intercept`</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">logSync</span><span class="p">)</span>
  <span class="nx">greetSync</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Apply multiple interceptors. The order of `log` will be preserved as it</span>
  <span class="c1">// explicitly listed at method level</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">convertName</span><span class="p">,</span> <span class="nx">log</span><span class="p">)</span>
  <span class="k">async</span> <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="global-interceptors">Global interceptors</h3>

<p>Global interceptors are discovered from the <code class="language-plaintext highlighter-rouge">InvocationContext</code>. They are
registered as bindings with <code class="language-plaintext highlighter-rouge">globalInterceptor</code> tag. For example,</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">asGlobalInterceptor</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">app</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">globalInterceptors.MetricsInterceptor</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toProvider</span><span class="p">(</span><span class="nx">MetricsInterceptorProvider</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">asGlobalInterceptor</span><span class="p">(</span><span class="dl">'</span><span class="s1">metrics</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<p>Please note <code class="language-plaintext highlighter-rouge">asGlobalInterceptor</code> is a factory function to create binding
templates that mark bindings of global interceptors. It takes an optional
<code class="language-plaintext highlighter-rouge">group</code> name to control the order of invocation. For example:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">asGlobalInterceptor('metrics')</code>: mark a binding as a global interceptor in
the <code class="language-plaintext highlighter-rouge">metrics</code> group</li>
  <li>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">asGlobalInterceptor()</code>: mark a binding as a global interceptor in the
default group</li>
    </ul>
  </li>
</ul>

<p>The registration can be further simplified as:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">interceptor</span><span class="p">(</span><span class="nx">MetricsInterceptorProvider</span><span class="p">,</span> <span class="p">{</span><span class="na">global</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">group</span><span class="p">:</span> <span class="dl">'</span><span class="s1">metrics</span><span class="dl">'</span><span class="p">});</span>
</code></pre></div></div>

<div class="alert alert-success" role="alert">
  <p><i class="fa fa-check-square-o"></i>
  <b>Tip:</b> If you need to intercept all requests, including these destinated to a LB3-mounted app, you can use a <a href="/doc/en/lb4/Middleware.html#loopback-style-middleware">LoopBack Middleware</a>.</p>
</div>

<h3 id="order-of-invocation-for-interceptors">Order of invocation for interceptors</h3>

<p>Multiple <code class="language-plaintext highlighter-rouge">@intercept</code> decorators can be applied to a class or a method. The
order of invocation is determined by how <code class="language-plaintext highlighter-rouge">@intercept</code> is specified. The list of
interceptors is created from top to bottom and from left to right. Duplicate
entries are removed from their first occurrences.</p>

<p>Let’s examine the list of interceptors invoked for each method on
<code class="language-plaintext highlighter-rouge">MyController</code>, which has a class level <code class="language-plaintext highlighter-rouge">log</code> decorator:</p>

<ol>
  <li>
    <p>A static method on the class - <code class="language-plaintext highlighter-rouge">greetStatic</code></p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
<span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="c1">// No explicit `@intercept` at method level. The class level `log` will</span>
  <span class="c1">// be applied</span>
  <span class="k">static</span> <span class="k">async</span> <span class="nx">greetStatic</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Interceptors to apply: [<code class="language-plaintext highlighter-rouge">log</code>]</p>
  </li>
  <li>
    <p>A static method that requires parameter injection: <code class="language-plaintext highlighter-rouge">greetStaticWithDI</code></p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
<span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="c1">// The method level `log` overrides the class level one</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
  <span class="k">static</span> <span class="k">async</span> <span class="nx">greetStaticWithDI</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">)</span> <span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Interceptors to apply: [<code class="language-plaintext highlighter-rouge">log</code>]</p>
  </li>
  <li>
    <p>A prototype method with multiple <code class="language-plaintext highlighter-rouge">@intercept</code> - <code class="language-plaintext highlighter-rouge">greetSync</code></p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
<span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="c1">// We can apply `@intercept` multiple times on the same method</span>
  <span class="c1">// This is needed if a custom decorator is created for `@intercept`</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span> <span class="c1">// The method level `log` overrides the class level one</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">logSync</span><span class="p">)</span>
  <span class="nx">greetSync</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Interceptors to apply: [<code class="language-plaintext highlighter-rouge">log</code>, <code class="language-plaintext highlighter-rouge">logSync</code>]</p>
  </li>
  <li>
    <p>A prototype method that preserves the order of an interceptor - <code class="language-plaintext highlighter-rouge">greet</code></p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">log</span><span class="p">)</span>
<span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="c1">// Apply multiple interceptors. The order of `log` will be preserved as it</span>
  <span class="c1">// explicitly listed at method level</span>
  <span class="p">@</span><span class="nd">intercept</span><span class="p">(</span><span class="nx">convertName</span><span class="p">,</span> <span class="nx">log</span><span class="p">)</span>
  <span class="k">async</span> <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Interceptors to apply: [<code class="language-plaintext highlighter-rouge">convertName</code>, <code class="language-plaintext highlighter-rouge">log</code>]</p>
  </li>
</ol>

<p>Global interceptors are invoked before class/method level ones unless they are
explicitly overridden by <code class="language-plaintext highlighter-rouge">@intercept</code>.</p>

<p>Global interceptors can be sorted as follows:</p>

<ol>
  <li>
    <p>Tag global interceptor binding with <code class="language-plaintext highlighter-rouge">ContextTags.GLOBAL_INTERCEPTOR_GROUP</code>.
The tag value will be treated as the <code class="language-plaintext highlighter-rouge">group</code> name of the interceptor. For
example:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">interceptor</span><span class="p">(</span><span class="nx">authInterceptor</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">authInterceptor</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">global</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">group</span><span class="p">:</span> <span class="dl">'</span><span class="s1">auth</span><span class="dl">'</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div>    </div>

    <p>If the group tag does not exist, the value is default to <code class="language-plaintext highlighter-rouge">''</code>.</p>
  </li>
  <li>
    <p>Control the ordered groups for global interceptors</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">ContextBindings</span><span class="p">.</span><span class="nx">GLOBAL_INTERCEPTOR_ORDERED_GROUPS</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">to</span><span class="p">([</span><span class="dl">'</span><span class="s1">log</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">auth</span><span class="dl">'</span><span class="p">]);</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>If ordered groups is not bound to
<code class="language-plaintext highlighter-rouge">ContextBindings.GLOBAL_INTERCEPTOR_ORDERED_GROUPS</code>, global interceptors will be
sorted by their group names alphabetically. Interceptors with unknown groups are
invoked before those listed in ordered groups.</p>

<h2 id="create-your-own-interceptors">Create your own interceptors</h2>

<p>Interceptors can be made available by LoopBack itself, extension modules, or
applications. They can be a function that implements <code class="language-plaintext highlighter-rouge">Interceptor</code> signature or
a binding that is resolved to an <code class="language-plaintext highlighter-rouge">Interceptor</code> function.</p>

<p>You can use <a href="/doc/en/lb4/Interceptor-generator.html"><code class="language-plaintext highlighter-rouge">lb4 interceptor</code> command</a> to generate
global or local interceptors as provider classes. Such interceptors will be
automatically discovered and bound to the application by the
<a href="/doc/en/lb4/Booting-an-Application.html#interceptor-booter">interceptor booter</a> during
<code class="language-plaintext highlighter-rouge">boot()</code>.</p>

<h3 id="interceptor-functions">Interceptor functions</h3>

<p>The interceptor function is invoked to intercept a method invocation with two
parameters:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">context</code>: the <a href="#invocation-context">invocation context</a></li>
  <li><code class="language-plaintext highlighter-rouge">next</code>: a function to invoke next interceptor or the target method. It returns
a value or promise depending on whether downstream interceptors and the target
method are synchronous or asynchronous.</li>
</ul>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Interceptor function to intercept method invocations
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">Interceptor</span> <span class="p">{</span>
  <span class="cm">/**
   * @param context - Invocation context
   * @param next - A function to invoke next interceptor or the target method
   * @returns A result as value or promise
   */</span>
  <span class="p">(</span>
    <span class="nx">context</span><span class="p">:</span> <span class="nx">InvocationContext</span><span class="p">,</span>
    <span class="nx">next</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">ValueOrPromise</span><span class="o">&lt;</span><span class="nx">InvocationResult</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="p">):</span> <span class="nx">ValueOrPromise</span><span class="o">&lt;</span><span class="nx">InvocationResult</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>An interceptor can be asynchronous (returning a promise) or synchronous
(returning a value). If one of the interceptors or the target method is
asynchronous, the invocation will be asynchronous. The following table show how
the final return type is determined.</p>

<table>
  <thead>
    <tr>
      <th>Interceptor</th>
      <th>Target method</th>
      <th>Return type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>async</td>
      <td>async</td>
      <td>promise</td>
    </tr>
    <tr>
      <td>async</td>
      <td>sync</td>
      <td>promise</td>
    </tr>
    <tr>
      <td>sync</td>
      <td>async</td>
      <td>promise</td>
    </tr>
    <tr>
      <td>sync</td>
      <td>sync</td>
      <td>value</td>
    </tr>
  </tbody>
</table>

<p>To keep things simple and consistent, we recommend that interceptors function to
be asynchronous as much as possible.</p>

<h3 id="invocation-context">Invocation context</h3>

<p>The <code class="language-plaintext highlighter-rouge">InvocationContext</code> object provides access to metadata for the given
invocation in addition to the parent <code class="language-plaintext highlighter-rouge">Context</code> that can be used to locate other
bindings. It extends <code class="language-plaintext highlighter-rouge">Context</code> with additional properties as follows:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">target</code> (<code class="language-plaintext highlighter-rouge">object</code>): Target class (for static methods) or prototype/object
(for instance methods)</li>
  <li><code class="language-plaintext highlighter-rouge">methodName</code> (<code class="language-plaintext highlighter-rouge">string</code>): Method name</li>
  <li><code class="language-plaintext highlighter-rouge">args</code> (<code class="language-plaintext highlighter-rouge">InvocationArgs</code>, i.e., <code class="language-plaintext highlighter-rouge">any[]</code>): An array of arguments</li>
  <li><code class="language-plaintext highlighter-rouge">source</code>: Source information about the invoker of the invocation</li>
</ul>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * InvocationContext for method invocations
 */</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">InvocationContext</span> <span class="kd">extends</span> <span class="nx">Context</span> <span class="p">{</span>
  <span class="cm">/**
   * Construct a new instance
   * @param parent - Parent context, such as the RequestContext
   * @param target - Target class (for static methods) or prototype/object
   * (for instance methods)
   * @param methodName - Method name
   * @param args - An array of arguments
   */</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="nx">parent</span><span class="p">:</span> <span class="nx">Context</span><span class="p">,</span>
    <span class="k">public</span> <span class="k">readonly</span> <span class="nx">target</span><span class="p">:</span> <span class="nx">object</span><span class="p">,</span>
    <span class="k">public</span> <span class="k">readonly</span> <span class="nx">methodName</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
    <span class="k">public</span> <span class="k">readonly</span> <span class="nx">args</span><span class="p">:</span> <span class="nx">InvocationArgs</span><span class="p">,</span> <span class="c1">// any[]</span>
    <span class="k">public</span> <span class="k">readonly</span> <span class="nx">source</span><span class="p">?:</span> <span class="nx">InvocationSource</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>It’s possible for an interceptor to mutate items in the <code class="language-plaintext highlighter-rouge">args</code> array to pass in
transformed input to downstream interceptors and the target method.</p>

<h3 id="source-for-an-invocation">Source for an invocation</h3>

<p>The <code class="language-plaintext highlighter-rouge">source</code> property of <code class="language-plaintext highlighter-rouge">InvocationContext</code> is defined as <code class="language-plaintext highlighter-rouge">InvocationSource</code>:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * An interface to represent the caller of the invocation
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">InvocationSource</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">=</span> <span class="nx">unknown</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="cm">/**
   * Type of the invoker, such as `proxy` and `route`
   */</span>
  <span class="k">readonly</span> <span class="na">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="cm">/**
   * Metadata for the source, such as `ResolutionSession`
   */</span>
  <span class="k">readonly</span> <span class="na">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">source</code> describes the caller that invokes a method with interceptors.
Interceptors can be invoked in the following cases:</p>

<ol>
  <li>
    <p>A route to a controller method</p>

    <ul>
      <li>The source describes the REST Route</li>
    </ul>
  </li>
  <li>
    <p>A controller to a repository/service with injected proxy</p>

    <ul>
      <li>The source describes a ResolutionSession that tracks a stack of bindings
and injections</li>
    </ul>
  </li>
  <li>
    <p>A controller/repository/service method invoked explicitly with
<code class="language-plaintext highlighter-rouge">invokeMethodWithInterceptors()</code> or <code class="language-plaintext highlighter-rouge">invokeMethod</code></p>

    <ul>
      <li>The source can be set by the caller of <code class="language-plaintext highlighter-rouge">invokeMethodWithInterceptors()</code> or
<code class="language-plaintext highlighter-rouge">invokeMethod</code></li>
    </ul>
  </li>
</ol>

<p>The implementation of an interceptor can check <code class="language-plaintext highlighter-rouge">source</code> to decide if its logic
should apply. For example, a global interceptor that provides caching for REST
APIs should only run if the source is from a REST Route.</p>

<p>A global interceptor can also be tagged with
<code class="language-plaintext highlighter-rouge">ContextTags.GLOBAL_INTERCEPTOR_SOURCE</code> using a value of string or string array
to indicate if it should be applied to source types of invocations. If the tag
is not present, the interceptor applies to invocations of any source type. For
example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ctx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">globalInterceptors.authInterceptor</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="nx">authInterceptor</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">asGlobalInterceptor</span><span class="p">(</span><span class="dl">'</span><span class="s1">auth</span><span class="dl">'</span><span class="p">))</span>
  <span class="c1">// Do not apply for `proxy` source type</span>
  <span class="p">.</span><span class="nx">tag</span><span class="p">({[</span><span class="nx">ContextTags</span><span class="p">.</span><span class="nx">GLOBAL_INTERCEPTOR_SOURCE</span><span class="p">]:</span> <span class="dl">'</span><span class="s1">route</span><span class="dl">'</span><span class="p">});</span>
</code></pre></div></div>

<p>The tag can also be declared for the provider class.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">globalInterceptor</span><span class="p">(</span><span class="dl">'</span><span class="s1">log</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">tags</span><span class="p">:</span> <span class="p">{[</span><span class="nx">ContextTags</span><span class="p">.</span><span class="nx">GLOBAL_INTERCEPTOR_SOURCE</span><span class="p">]:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">proxy</span><span class="dl">'</span><span class="p">]},</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">LogInterceptor</span> <span class="k">implements</span> <span class="nx">Provider</span><span class="o">&lt;</span><span class="nx">Interceptor</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="logic-around-next">Logic around <code class="language-plaintext highlighter-rouge">next</code></h3>

<p>An interceptor will receive the <code class="language-plaintext highlighter-rouge">next</code> parameter, which is a function to execute
the downstream interceptors and the target method.</p>

<p>The interceptor function is responsible for calling <code class="language-plaintext highlighter-rouge">next()</code> if it wants to
proceed with next interceptor or the target method invocation. A typical
interceptor implementation looks like the following:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">intercept</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span>
  <span class="nx">invocationCtx</span><span class="p">:</span> <span class="nx">InvocationContext</span><span class="p">,</span>
  <span class="nx">next</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">ValueOrPromise</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Pre-process the request</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">next</span><span class="p">();</span>
    <span class="c1">// Post-process the response</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Handle errors</span>
    <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">next()</code> is not invoked, neither downstream interceptors nor the target
method be executed. It’s valid to skip <code class="language-plaintext highlighter-rouge">next()</code> if it’s by intention, for
example, an interceptor can fail the invocation early due to validation errors
or return a response from cache without invoking the target method.</p>

<h3 id="example-interceptors">Example interceptors</h3>

<p>Here are some example interceptor functions:</p>

<ol>
  <li>
    <p>An asynchronous interceptor to log method invocations:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">log</span><span class="p">:</span> <span class="nx">Interceptor</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">invocationCtx</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">log: before-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
  <span class="c1">// Wait until the interceptor/method chain returns</span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">next</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">log: after-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>An interceptor to catch and log errors:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">logError</span><span class="p">:</span> <span class="nx">Interceptor</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">invocationCtx</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">logError: before-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">next</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">logError: after-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">logError: error-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
    <span class="k">throw</span> <span class="nx">err</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>An interceptor to convert <code class="language-plaintext highlighter-rouge">name</code> arg to upper case:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">convertName</span><span class="p">:</span> <span class="nx">Interceptor</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">invocationCtx</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">convertName:before-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
  <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span> <span class="kr">string</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">next</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">convertName: after-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>An provider class for an interceptor that performs parameter validation</p>

    <p>To leverage dependency injection, a provider class can be defined as the
interceptor:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * A binding provider class to produce an interceptor that validates the
 * `name` argument
 */</span>
<span class="kd">class</span> <span class="nx">NameValidator</span> <span class="k">implements</span> <span class="nx">Provider</span><span class="o">&lt;</span><span class="nx">Interceptor</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">valid-names</span><span class="dl">'</span><span class="p">)</span> <span class="k">private</span> <span class="na">validNames</span><span class="p">:</span> <span class="kr">string</span><span class="p">[])</span> <span class="p">{}</span>

  <span class="nx">value</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">intercept</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">intercept</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="na">invocationCtx</span><span class="p">:</span> <span class="nx">InvocationContext</span><span class="p">,</span>
    <span class="na">next</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">ValueOrPromise</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">validNames</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span>
        <span class="s2">`Name '</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">' is not on the list of '</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">validNames</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
      <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">next</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>A synchronous interceptor to log method invocations:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">logSync</span><span class="p">:</span> <span class="nx">Interceptor</span> <span class="o">=</span> <span class="p">(</span><span class="nx">invocationCtx</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">logSync: before-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
  <span class="c1">// Calling `next()` without `await`</span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">next</span><span class="p">();</span>
  <span class="c1">// It's possible that the statement below is executed before downstream</span>
  <span class="c1">// interceptors or the target method finish</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">logSync: after-</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="nx">methodName</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="compose-multiple-interceptors">Compose multiple interceptors</h3>

<p>Sometimes we want to apply more than one interceptors together as a whole. It
can be done by <code class="language-plaintext highlighter-rouge">composeInterceptors</code>:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">composeInterceptors</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">interceptor</span> <span class="o">=</span> <span class="nx">composeInterceptors</span><span class="p">(</span>
  <span class="nx">interceptorFn1</span><span class="p">,</span>
  <span class="dl">'</span><span class="s1">interceptors.my-interceptor</span><span class="dl">'</span><span class="p">,</span>
  <span class="nx">interceptorFn2</span><span class="p">,</span>
<span class="p">);</span>
</code></pre></div></div>

<p>The code above composes <code class="language-plaintext highlighter-rouge">interceptorFn1</code> and <code class="language-plaintext highlighter-rouge">interceptorFn2</code> functions with
<code class="language-plaintext highlighter-rouge">interceptors.my-interceptor</code> binding key into a single interceptor.</p>

<h3 id="build-your-own-interceptor-chains">Build your own interceptor chains</h3>

<p>Behind the scenes, interceptors are chained one by one by their orders into an
invocation chain.
<a href="https://loopback.io/doc/en/lb4/apidocs.context.genericinterceptorchain.html">GenericInvocationChain</a>
is the base class that can be extended to create your own flavor of interceptors
and chains. For example,</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">GenericInvocationChain</span><span class="p">,</span> <span class="nx">GenericInterceptor</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">RequestContext</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/rest</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">interface</span> <span class="nx">RequestInterceptor</span>
  <span class="kd">extends</span> <span class="nx">GenericInterceptor</span><span class="o">&lt;</span><span class="nx">RequestContext</span><span class="o">&gt;</span> <span class="p">{}</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">RequestInterceptorChain</span> <span class="kd">extends</span> <span class="nx">GenericInterceptorChain</span><span class="o">&lt;</span><span class="nx">RequestContext</span><span class="o">&gt;</span> <span class="p">{}</span>
</code></pre></div></div>

<p>The interceptor chain can be instantiated in two styles:</p>

<ul>
  <li>with a list of interceptor functions or binding keys</li>
  <li>with a binding filter function to discover matching interceptors within the
context</li>
</ul>

<p>Once the chain is built, it can be invoked using <code class="language-plaintext highlighter-rouge">invokeInterceptors</code>:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">chain</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RequestInterceptorChain</span><span class="p">(</span><span class="nx">requestCtx</span><span class="p">,</span> <span class="nx">interceptors</span><span class="p">);</span>
<span class="k">await</span> <span class="nx">chain</span><span class="p">.</span><span class="nx">invokeInterceptors</span><span class="p">();</span>
</code></pre></div></div>

<p>It’s also possible to pass in a final handler:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Next</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">finalHandler</span><span class="p">:</span> <span class="nx">Next</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// return ...;</span>
<span class="p">};</span>
<span class="k">await</span> <span class="nx">chain</span><span class="p">.</span><span class="nx">invokeInterceptors</span><span class="p">(</span><span class="nx">finalHandler</span><span class="p">);</span>
</code></pre></div></div>

<p>The invocation chain itself can be used a single interceptor so that it be
registered as one handler to another chain.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">chain</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RequestInterceptorChain</span><span class="p">(</span><span class="nx">requestCtx</span><span class="p">,</span> <span class="nx">interceptors</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">interceptor</span> <span class="o">=</span> <span class="nx">chain</span><span class="p">.</span><span class="nx">asInterceptor</span><span class="p">();</span>
</code></pre></div></div>


    <div class="tags">
      
    </div>
</div>

<hr class="shaded"/>

<footer id="container">
            <div class="row">
                <div class="col-md-6 footer-left">
               &copy;2021 IBM / StrongLoop. All rights reserved. <br />
 Site last generated: Mar 22, 2021
              </div>
              <div class="col-md-6 footer-right">
                <p><img src="https://loopback.io/images/company_logo.png" alt="Company logo"/></p>
              </div>
            </div>
</footer>


        </div>
        <!-- /.row -->
</div>
<!-- /.container -->
    </div>
</body>

</html>
