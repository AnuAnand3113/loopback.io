<!DOCTYPE html>
<head>
    

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="keywords" content=" LoopBack 4.0, LoopBack 4, Node.js, TypeScript, OpenAPI, Concepts, Context">
  <title>Context | LoopBack Documentation</title>
  <link rel="stylesheet" href="/css/syntax.css">

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/modern-business.css">
    <link rel="stylesheet" href="/css/lavish-bootstrap.css">
    <link rel="stylesheet" href="/css/customstyles.css">
    <link rel="stylesheet" href="/css/theme-v4.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150726441-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150726441-2');
</script>


    <!-- github star button -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>


    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.0/anchor.min.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/customscripts.js"></script>

    <link rel="shortcut icon" href="/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->


    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand no_icon" href="/doc/index.html">
              <img class="no_icon" style="width:147px;" src="/images/branding/logo/white/loopback.svg">&nbsp;<span class="projectTitle"></span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is  -->
                          
                            <li><a href="https://loopback.io/doc/en/lb4/apidocs.index.html" target="_blank">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is  -->
                          
                            <li><a href="http://apidocs.loopback.io" target="_blank">LoopBack 3.x</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">View<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is / -->
                          
                            <li><a href="/">LoopBack Overview</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/en/lb4/ -->
                          
                            <li class="dropdownActive"><a href="/doc/en/lb4/">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/en/lb3/ -->
                          
                            <li><a href="/doc/en/lb3/">LoopBack 3.x</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/en/lb2/ -->
                          
                            <li><a href="/doc/en/lb2/">LoopBack 2.x</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/en/community/ -->
                          
                            <li><a href="/doc/en/community/">Community projects</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/en/contrib/ -->
                          
                            <li><a href="/doc/en/contrib/">Contributing to LoopBack</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/en/sec/ -->
                          
                            <li><a href="/doc/en/sec/">Security advisories</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is  -->
                          
                            <li><a href="https://github.com/strongloop/loopback.io" target="_blank">Docs Github Repo</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs-announcements" target="_blank">Announcements Mailing List</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs" target="_blank">Developer Forum</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is  -->
                          
                            <li><a href="https://join.slack.com/t/loopbackio/shared_invite/zt-8lbow73r-SKAKz61Vdao~_rGf91pcsw" target="_blank">LoopBack on Slack</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is  -->
                          
                            <li><a href="https://stackoverflow.com/questions/tagged/strongloop+or+loopback4+or+loopbackjs" target="_blank">LoopBack on Stack Overflow</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is  -->
                          
                            <li><a href="https://strongloop.com/strongblog/tag_LoopBack.html" target="_blank">StrongLoop Blog - LoopBack</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Translations<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/es/lb2/ -->
                          
                            <li><a href="/doc/es/lb2/">Español (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/es/lb4/ -->
                          
                            <li><a href="/doc/es/lb4/">Español (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/fr/lb2/ -->
                          
                            <li><a href="/doc/fr/lb2/">Français (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/fr/lb4/ -->
                          
                            <li><a href="/doc/fr/lb4/">Français (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/ko/lb2/ -->
                          
                            <li><a href="/doc/ko/lb2/">한국어 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/ko/lb3/ -->
                          
                            <li><a href="/doc/ko/lb3/">한국어 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/pt-br/lb2/ -->
                          
                            <li><a href="/doc/pt-br/lb2/">Português (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/pt-br/lb4/ -->
                          
                            <li><a href="/doc/pt-br/lb4/">Português (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/ja/lb2/ -->
                          
                            <li><a href="/doc/ja/lb2/">日本語 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/ja/lb3/ -->
                          
                            <li><a href="/doc/ja/lb3/">日本語 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/ja/lb4/ -->
                          
                            <li><a href="/doc/ja/lb4/">日本語 (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/ru/lb2/ -->
                          
                            <li><a href="/doc/ru/lb2/">Pусский (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/zh/lb2/ -->
                          
                            <li><a href="/doc/zh/lb2/">中文 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Context.html .... folderitem.url is /doc/zh/lb4/ -->
                          
                            <li><a href="/doc/zh/lb4/">中文 (v4)</a></li>
                          
                        
                    </ul>
                </li>
                
                
                
                <li>
                    <form id="search" name="search" class="input-group lb-search" action="/search" method="GET">
                        <input type="text" class="form-control search-bar" placeholder="Search (powered by Watson)" name="q">
                        
                          <input type="hidden" name="sidebar" value="lb4_sidebar">
                        
                        <div class="input-group-btn">
                            <button type="submit" class="btn btn-default" aria-label="search">
                              <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button>
                        </div>
                      </form>
                </li>
            </ul>
        </div>
      </div>
</nav>

<!-- Page Content -->
<div class="container">
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <nav class="col-md-3 sidebar-col">
          











<!-- NOTE: sidebar = site.data.sidebars.mydoc_sidebar.entries -->
<div class="sidebarTitle"><a href="index.html">LoopBack 4</a></div>
<ul id="mysidebar" class="nav-list">
  

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="index.html">Overview</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Getting-started.html">Getting started</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Inside-LoopBack-Application.html">Inside a LoopBack Application</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent-expand   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building LoopBack Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Tutorials.html">Tutorials</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-tutorial.html">Todo Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-scaffolding.html">Create your app scaffolding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-model.html">Add the Todo model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-datasource.html">Add a Datasource</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-repository.html">Add a Repository</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-controller.html">Add a Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-putting-it-together.html">Putting it all together</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-geocoding-service.html">Bonus: Integrate with a geo-coding service</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-list-tutorial.html">TodoList Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-model.html">Add TodoList Model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-repository.html">Add TodoList Repository</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-list-tutorial-relations.html">Add Model Relations</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-has-one-relation.html">Add a HasOne Relation</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-controller.html">Add TodoList Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-sqldb.html">Running on relational databases</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-back-end.html">Connecting to Back-end Service Tutorials</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="soap-calculator-tutorial.html">SOAP Web Service Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-web-service-overview.html">SOAP Web Service Overview</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-scaffolding.html">App scaffolding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-datasource.html">Add a Datasource</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-service.html">Add a Service</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-controller.html">Add a Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-run-and-test.html">Run and Test it</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="express-with-lb4-rest-tutorial.html">Creating an Express Application with LoopBack REST API</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-tutorial.html">How to secure your LoopBack 4 application with JWT authentication</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="core-tutorial.html">Build large scale Node.js projects with LoopBack 4</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part1.html">Introduction of the application scenario</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part2.html">Architectural challenges</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part3.html">Context in action</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part4.html">Dependency injection</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part5.html">Extension point and extensions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part6.html">Interception</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part7.html">Observation of life cycle events</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part8.html">Configuration</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part9.html">Discover and load artifacts by convention</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part10.html">Advanced Recipes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part11.html">Summary</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Examples.html">Examples</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-examples.html">Community examples</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">How-to guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building REST APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-crud-rest-apis.html">Creating CRUD REST APIs from a model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-how-openapi-spec-is-served.html">Customizing how OpenAPI spec is served</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-routes.html">Customizing routes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Dynamic-models-repositories-controllers.html">Dynamically adding models, repositories, and controllers</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Self-hosted-rest-api-explorer.html">Self-hosted REST API Explorer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Serving-static-files.html">Serving Static Files</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Accessing-http-request-response.html">Accessing HTTP Request and Response Objects</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="File-upload-download.html">Uploading and Downloading Files</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Express-middleware.html">Using Express Middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-strong-error-handler.html">Using strong-error-handler</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Boot-and-Mount-a-LoopBack-3-application.html">Boot and Mount a LoopBack 3 Application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Integrating-with-api-connect.html">Integrating with API Connect</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Accepting-messagepack-over-http.html">Accepting MessagePack over HTTP</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Creating Other Forms of APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="GraphQL.html">Creating GraphQL APIs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-openapi-to-graphql.html">Using OpenAPI-to-GraphQL</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Creating-artifacts-runtime.html">Creating Artifacts at Runtime</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-model-runtime.html">Creating Model at Runtime</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-datasource-runtime.html">Creating DataSource at Runtime</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-repository-runtime.html">Creating Repositories at Runtime</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building frontend applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Building-frontend-angular-application.html">Building an Angular Application from OpenAPI Specification</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-server-configuration.html">Customizing Server configuration</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Migrate-from-legacy-sequence.html">Migrate from Legacy Sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Running-cron-jobs.html">Running cron jobs</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Accessing Databases</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Configuring-datasource.html">Configuring DataSource</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Working-with-data.html">Working with data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Querying-data.html">Querying data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Fields-filter.html">Fields filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Include-filter.html">Include filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Limit-filter.html">Limit filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Order-filter.html">Order filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Skip-filter.html">Skip filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Where-filter.html">Where filter</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-database-transactions.html">Using Database Transactions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Database-migrations.html">Database Migrations</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Executing-database-commands.html">Executing database commands</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Using TypeORM</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-typeorm-with-loopback.html">How to use TypeORM with LoopBack</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Accessing-services.html">Accessing Services</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Calling-soap-web-services.html">Calling SOAP Web services</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Calling-rest-apis.html">Calling REST APIs</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Parsing-requests-guide.html">Parsing requests</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Validation.html">Validating Data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-REST-layer.html">Validation in REST Layer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-controller-repo-service-layer.html">Validation in the Controller, Repository and Service Layer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-ORM-layer.html">Validation in ORM Layer</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Configuring-applications.html">Configuring Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application-setup-tips.html">Tips for Application Setup</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Securing Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Authentication-overview.html">Authentication</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-tutorial.html">Apply JWT Authentication in Todo Example</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Loopback-component-authentication.html">Authentication Component</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-decorator.html">Authentication Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-action.html">Authentication Action</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-strategy.html">Authentication Strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-options.html">Managing Custom Authentication Strategy Options</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="JWT-authentication-extension.html">JWT Authentication Extension</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Implement-your-own-strategy.html">Implement your own authentication strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-passport.html">Passport Adapter for Authentication</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Authorization-overview.html">Authorization</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="RBAC-with-authorization.html">RBAC with Authorization System</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Loopback-component-authorization.html">Authorization Component</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-interceptor.html">Interceptor</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-decorator.html">Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-authorizer.html">Authorizer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-decision-matrix.html">Decision Matrix</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-enforcer.html">Enforcer</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Deployment.html">Deploying Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Enabling-https.html">Enabling HTTPS</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Deploying-to-IBM-Cloud.html">Deploying to IBM Cloud</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="deploying_to_ibm_cloud_kubernetes.html">Deploying to Kubernetes on IBM Cloud</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="deploying-with-pm2-and-nginx.html">Deploying with pm2 and nginx</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Appsody-LoopBack.html">Developing and Deploying LoopBack Applications with Appsody</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Running-cron-jobs.html">Running cron jobs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Health.html">Health check</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Metrics.html">Metrics for Prometheus</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Pooling.html">Pooling</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Troubleshooting.html">Troubleshooting</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Setting-debug-strings.html">Setting debug strings</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Logging.html">Logging</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Context-explorer.html">Context Explorer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Debugging-tests-with-mocha.html">Debugging tests with Mocha</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent-expand   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Extending-LoopBack-4.html">Extending LoopBack Framework</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">How-to guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-components.html">Creating components</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-decorators.html">Creating decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="creating-components-rest-api.html">Contributing REST API</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="creating-components-services.html">Creating services</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-servers.html">Creating servers</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-request-body-parsing.html">Extending request body parsing</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-life-cycle.html">Extension life cycle</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-OpenAPI-specification.html">Extending OpenAPI specification</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-Model-API-builder.html">Extending Model API builder</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Testing-your-extension.html">Testing your extension</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-extensions.html">Community extensions</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Concepts.html">Concepts</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Crafting-LoopBack-4.html">Crafting LoopBack 4</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Core</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application.html">Application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Component.html">Component</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  active">
    
    
      <a class="page-link" href="Context.html">Context</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Binding.html">Binding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Dependency-injection.html">Dependency Injection</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Interceptor.html">Interceptor</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Life-cycle.html">Life Cycle Event and Observer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-point-and-extensions.html">Extension point and extensions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Service.html">Service</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Booting-an-Application.html">Booter</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Decorators.html">Decorators</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_openapi.html">OpenAPI Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_inject.html">Dependency Injection Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_authenticate.html">Authentication Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_authorize.html">Authorization Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_service.html">Service Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_repository.html">Repository Decorators</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Mixin.html">Mixin</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">REST APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Server.html">Server</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Sequence.html">Sequence</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-middleware-sequence.html">Middleware based sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-action-sequence.html">Action based sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Advanced-sequence-topics.html">Advanced topics</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Routing-requests.html">Routing requests</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Parsing-requests.html">Parsing requests</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Working-with-express-middleware.html">Working with Express Middleware</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Middleware.html">Middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Route.html">Route</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Controller.html">Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Request-response-cycle.html">Request/response cycle</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Data Access</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Model.html">Model</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Relations.html">Relations</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasMany-relation.html">HasMany Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="BelongsTo-relation.html">BelongsTo Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasOne-relation.html">HasOne Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasManyThrough-relation.html">HasManyThrough Relation</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Repository.html">Repository</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DataSource.html">DataSource</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Best-practices.html">Best practices</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Defining-the-API-using-code-first-approach.html">Defining the API using code-first approach</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Defining-your-testing-strategy.html">Defining your testing strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Testing-your-application.html">Testing your application</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Reference guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Loopback-application-layout.html">LoopBack 4 Application Layout</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="apidocs.index.html">API docs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Reserved-binding-keys.html">Reserved binding keys</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Error-codes.html">Error codes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LoopBack-types.html">LoopBack Types</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Command-line-interface.html">CLI References</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application-generator.html">Application generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Controller-generator.html">Controller generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DataSource-generator.html">DataSource generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Importing-LB3-models.html">Import models from LoopBack 3</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Model-generator.html">Model generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Discovering-models.html">Model discovery</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Relation-generator.html">Relation generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Repository-generator.html">Repository generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Rest-Crud-generator.html">REST CRUD model endpoints generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Service-generator.html">Service generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="OpenAPI-generator.html">OpenAPI generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Life-cycle-observer-generator.html">Life cycle observer generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Interceptor-generator.html">Interceptor generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-generator.html">Extension generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Download-examples.html">Download examples</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Update-generator.html">Update project dependencies</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Copyright-generator.html">Generate copyright/license headers</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Connectors-reference.html">Connectors reference</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Memory-connector.html">Memory connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Database-connectors.html">Database connectors</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Cassandra-connector.html">Cassandra connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Cloudant-connector.html">Cloudant connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Couchdb2-connector.html">CouchDB 2.x connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DashDB.html">DashDB connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-connector.html">IBM Db2 (for Linux, Unix, Windows) connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-for-i-connector.html">IBM Db2 for i connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-for-z-OS-connector.html">IBM Db2 for z/OS connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Informix.html">Informix connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="MongoDB-connector.html">MongoDB connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-MongoDB.html">MongoDB Connector Tutorial</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-MongoLab.html">Using MongoLab</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="MySQL-connector.html">MySQL connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-MySQL.html">MySQL Connector Tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Oracle-connector.html">Oracle connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Installing-the-Oracle-connector.html">Installing the Oracle connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-Oracle.html">Oracle connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="PostgreSQL-connector.html">PostgreSQL connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-PostgreSQL.html">PostgreSQL connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Redis-connector.html">Redis connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="kv-redis-connector.html">Redis key-value connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Example-kv-connector.html">KV connector example</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="SQL-Server-connector.html">SQL Server connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-Microsoft-SQL-Server.html">SQL Server connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="SQLite3.html">SQLite3 connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="zOSconnectEE.html">z/OS Connect Enterprise Edition connector</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Other-connectors.html">Other connectors</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="JSON-RPC-connector.html">JSON RPC connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="MQLight-connector.html">MQ Light connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="REST-connector.html">REST connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-connector-example.html">REST connector example</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="SOAP-connector.html">SOAP connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Strong-soap.html">Strong-soap</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="SOAP-Connector-example.html">SOAP connector example</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-SOAP.html">Connecting to SOAP web services</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="OpenAPI-connector.html">OpenAPI connector</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-connectors.html">Community connectors</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="changelog.index.html">Change logs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Deploy-for-GDPR-readiness.html">Considerations for GDPR readiness</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="code-contrib-lb4.html">Contributing to LoopBack 4</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="submitting_a_pr.html">Submitting a pull request to LoopBack 4</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="FAQ.html">FAQ</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-overview.html">Migration guide</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Understanding-the-differences.html">Understanding the differences</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LB3-vs-LB4-booting.html">Booting process</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LB3-vs-LB4-request-response-cycle.html">Request/response cycle</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-mounting-lb3app.html">Mounting a LoopBack 3 application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-express-middleware.html">Express middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-datasources.html">Datasources</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-models-overview.html">Migrating models</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-core.html">Model definitions and built-in APIs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-relations.html">Relations</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-methods.html">Custom methods</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-remoting-hooks.html">Remoting hooks</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-operation-hooks.html">CRUD operation hooks</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-mixins.html">Mixins</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-boot-scripts.html">Boot scripts</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-auth-overview.html">Authentication & authorization</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-access-control-example.html">Access control example</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-authentication.html">Built-in models and authentication</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-passport.html">Passport</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-oauth2.html">OAuth2 Provider</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-cli.html">CLI</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-extensions-overview.html">Components and extensions</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-project-layout.html">Project layout</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-models.html">Models</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-current-context.html">Current context</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-mixins.html">Mixins</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-rest-api.html">REST API</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-clients.html">Clients (API consumers)</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-not-planned.html">Features not planned</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



</ul>

        </nav>
        <!-- Content Column -->
        <div class="col-md-9">
            
<div class="post-header">
   <h1 class="post-title-main">Context</h1>
   
     
       <a target="_blank" href="https://github.com/strongloop/loopback-next/blob/master/docs/site/Context.md" class="githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit this page</a>
   
</div>

<div class="post-content">





 
   
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
;$(function() {
  var level = parseInt(3, 10);
  if (level === 1) {level = 'h2'}
  if (level === 2) {level = 'h2,h3'}
  if (level === 3) {level = 'h2,h3,h4'}
  if (level === 4) {level = 'h2,h3,h4,h5'}

  // Add a new level for changelog files which use h1,h2,h3
  if (level === 0) {level = 'h1,h2,h3,h4,h5'}

  var toc = $('#toc')

  toc.toc({minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: level})

  /* this offset helps with the space taken up by the floating toolbar */
  toc.on('click', 'a', function() {
    var target = $(this.getAttribute('href')),
      scroll_target = target.offset().top

    $(window).scrollTop(scroll_target - 10)
    return false
  })
  .on('click', '.toc-expand-button', function() {
    toc.find('> ul').slideToggle('fast');
  })
})
</script>

<div id="toc">
  <span class="toc-title">Page Contents</span>
  <button type="button" class="btn btn-link toc-expand-button">
    <i class="fa fa-bars"></i>
  </button>
</div>

 

    <h2 id="what-is-context">What is Context?</h2>

<ul>
  <li>An abstraction of all state and dependencies in your application</li>
  <li>LoopBack uses context to manage everything</li>
  <li>A global registry for anything/everything in your app (all configs, state,
dependencies, classes, etc)</li>
  <li>An <a href="https://en.wikipedia.org/wiki/Inversion_of_control">inversion of control</a>
container used to inject dependencies into your code</li>
</ul>

<p><img src="/pages/en/lb4/imgs/loopback-context.png" alt="Context" /></p>

<h3 id="why-is-it-important">Why is it important?</h3>

<ul>
  <li>You can use the context as a way to give loopback more “info” so that other
dependencies in your app may retrieve it. It works as a centralized place/
global built-in/in-memory storage mechanism.</li>
  <li>LoopBack can help “manage” your resources automatically (through
<a href="/doc/en/lb4/Dependency-injection.html">Dependency Injection</a> and decorators).</li>
  <li>You have full access to updated/real-time application and request state at all
times.</li>
</ul>

<p><img src="/pages/en/lb4/imgs/loopback-ioc.png" alt="IoC Container" /></p>

<h2 id="how-to-create-a-context">How to create a context?</h2>

<p>A context can be created with an optional parent and an optional name. If the
name is not provided, a unique identifier will be generated as the value.
Context instances can be chained using the <code class="language-plaintext highlighter-rouge">parent</code> to form a hierarchy. For
example, the code below creates a chain of three contexts:
<code class="language-plaintext highlighter-rouge">reqCtx -&gt; serverCtx -&gt; rootCtx</code>.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Context</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">rootCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="dl">'</span><span class="s1">root-ctx</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// No parent</span>
<span class="kd">const</span> <span class="nx">serverCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="nx">rootCtx</span><span class="p">,</span> <span class="dl">'</span><span class="s1">server-ctx</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// rootCtx as the parent</span>
<span class="kd">const</span> <span class="nx">reqCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="nx">serverCtx</span><span class="p">);</span> <span class="c1">// No explicit name, a unique id will be generated</span>
</code></pre></div></div>

<div class="alert alert-info" role="alert">
  <p><i class="fa fa-info-circle"></i>
<b>Note:</b>
The <code class="language-plaintext highlighter-rouge">@loopback/core</code> package re-exports all public
APIs of <code class="language-plaintext highlighter-rouge">@loopback/context</code>. For consistency, we recommend the usage of
<code class="language-plaintext highlighter-rouge">@loopback/core</code> for imports in LoopBack modules and applications unless they
depend on <code class="language-plaintext highlighter-rouge">@loopback/context</code> explicitly. The two statements below are
equivalent:</p>

  <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">inject</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/context</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">inject</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div>  </div>

</div>

<p>LoopBack’s context system allows an unlimited amount of Context instances, each
of which may have a parent Context.</p>

<p>An application typically has three “levels” of context: application-level,
server-level, and request-level.</p>

<h2 id="application-level-context-global">Application-level context (global)</h2>

<ul>
  <li>Stores all the initial and modified app states throughout the entire life of
the app (while the process is alive)</li>
  <li>Generally configured when the application is created (though the context may
be modified while running)</li>
</ul>

<p>Here is a simple example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Application</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Please note `Application` extends from `Context`</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">();</span> <span class="c1">// `app` is a "Context"</span>
<span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{}</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="nx">MyController</span><span class="p">);</span>
</code></pre></div></div>

<p>In this case, you are using the <code class="language-plaintext highlighter-rouge">.controller</code> helper method to register a new
controller. The important point to note is <code class="language-plaintext highlighter-rouge">MyController</code> is actually registered
into the Application Context (<code class="language-plaintext highlighter-rouge">app</code> is a Context).</p>

<h2 id="server-level-context">Server-level context</h2>

<p>Server-level context:</p>

<ul>
  <li>Is a child of application-level context</li>
  <li>Holds configuration specific to a particular server instance</li>
</ul>

<p>Your application will typically contain one or more server instances, each of
which will have the application-level context as its parent. This means that any
bindings that are defined on the application will also be available to the
server(s), unless you replace these bindings on the server instance(s) directly.</p>

<p>For example,
<a href="https://github.com/strongloop/loopback-next/blob/master/packages/rest"><code class="language-plaintext highlighter-rouge">@loopback/rest</code></a>
has the <code class="language-plaintext highlighter-rouge">RestServer</code> class, which sets up a running HTTP/S server on a port, as
well as defining routes on that server for a REST API. To set the port binding
for the <code class="language-plaintext highlighter-rouge">RestServer</code>, you would bind the <code class="language-plaintext highlighter-rouge">RestBindings.PORT</code> key to a number.</p>

<p>We can selectively re-bind this value for certain server instances to change
what port they use:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// src/application.ts</span>
<span class="k">async</span> <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// publicApi will use port 443, since it inherits this binding from the app.</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">RestBindings</span><span class="p">.</span><span class="nx">PORT</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="mi">443</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">publicApi</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">getServer</span><span class="o">&lt;</span><span class="nx">RestServer</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">public</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">privateApi</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">getServer</span><span class="o">&lt;</span><span class="nx">RestServer</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">private</span><span class="dl">'</span><span class="p">);</span>
  <span class="c1">// privateApi will be bound to 8080 instead.</span>
  <span class="nx">privateApi</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">RestBindings</span><span class="p">.</span><span class="nx">PORT</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="mi">8080</span><span class="p">);</span>
  <span class="k">await</span> <span class="k">super</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="request-level-context-request">Request-level context (request)</h2>

<p>Using
<a href="https://github.com/strongloop/loopback-next/blob/master/packages/rest"><code class="language-plaintext highlighter-rouge">@loopback/rest</code></a>
as an example, we can create custom sequences that:</p>

<ul>
  <li>are dynamically created for each incoming server request</li>
  <li>extend the application level context to give you access to application-level
dependencies during the request/response lifecycle</li>
  <li>are garbage-collected once the response is sent for memory management</li>
</ul>

<p>Let’s see this in action:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">DefaultSequence</span><span class="p">,</span> <span class="nx">RestBindings</span><span class="p">,</span> <span class="nx">RequestContext</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/rest</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">MySequence</span> <span class="kd">extends</span> <span class="nx">DefaultSequence</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">RequestContext</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// RequestContext provides request/response properties for convenience</span>
    <span class="c1">// and performance, but they are still available in the context too</span>
    <span class="kd">const</span> <span class="nx">req</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">RestBindings</span><span class="p">.</span><span class="nx">Http</span><span class="p">.</span><span class="nx">REQUEST</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">ctx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">RestBindings</span><span class="p">.</span><span class="nx">Http</span><span class="p">.</span><span class="nx">RESPONSE</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">res</span><span class="p">,</span> <span class="s2">`hello </span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">this.ctx</code> is available to your sequence</li>
  <li>allows you to craft your response using resources from the app in addition to
the resources available to the request in real-time (right when you need it)</li>
</ul>

<p>The context hierarchy is illustrated in the diagram below:</p>

<p><img src="/pages/en/lb4/imgs/loopback-context-hierarchy.png" alt="Context Hierarchy" /></p>

<h2 id="storing-and-retrieving-items-from-a-context">Storing and retrieving items from a Context</h2>

<p>Items in the Context are indexed via a key and bound to a <code class="language-plaintext highlighter-rouge">BoundValue</code>. A
<code class="language-plaintext highlighter-rouge">BindingKey</code> is simply a string value and is used to look up whatever you store
along with the key. For example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// app level</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">world</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// BindingKey='hello', BoundValue='world'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">getSync</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">));</span> <span class="c1">// =&gt; 'world'</span>
</code></pre></div></div>

<p>In this case, we bind the ‘world’ string BoundValue to the ‘hello’ BindingKey.
When we fetch the BoundValue via <code class="language-plaintext highlighter-rouge">getSync</code>, we give it the BindingKey and it
returns the BoundValue that was initially bound (we can do other fancy things
too – ie. instantiate your classes, etc)</p>

<p>The process of registering a BoundValue into the Context is known as <em>binding</em>.
Please find more details at <a href="/doc/en/lb4/Binding.html">Binding</a>.</p>

<p>For a list of the available functions you can use for binding, visit the
<a href="https://loopback.io/doc/en/lb4/apidocs.context.html">Context API Docs</a>.</p>

<h2 id="dependency-injection">Dependency injection</h2>

<ul>
  <li>Many configs are adding to the Context during app instantiation/boot time by
you/developer.</li>
  <li>When things are registered, the Context provides a way to use your
dependencies during runtime.</li>
</ul>

<p>How you access these things is via low level helpers like <code class="language-plaintext highlighter-rouge">app.getSync</code> or the
<code class="language-plaintext highlighter-rouge">sequence</code> class that is provided to you as shown in the example in the previous
section.</p>

<p>However, when using classes, LoopBack provides a better way to get at stuff in
the context via the <code class="language-plaintext highlighter-rouge">@inject</code> decorator:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">inject</span><span class="p">,</span> <span class="nx">Application</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Application</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">defaultName</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">John</span><span class="dl">'</span><span class="p">);</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">HelloController</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">defaultName</span><span class="dl">'</span><span class="p">)</span> <span class="k">private</span> <span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{}</span>

  <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">?:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello </span><span class="p">${</span><span class="nx">name</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Notice we just use the default name as though it were available to the
constructor. Context allows LoopBack to give you the necessary information at
runtime even if you do not know the value when writing up the Controller. The
above will print <code class="language-plaintext highlighter-rouge">Hello John</code> at run time.</p>

<div class="alert alert-info" role="alert">
  <p><i class="fa fa-info-circle"></i>
<b>Note:</b></p>

  <p><code class="language-plaintext highlighter-rouge">@inject</code> decorator is not able to leverage the value-type information
associated with a binding key yet, therefore the TypeScript compiler will not
check that the injection target (e.g. a constructor argument) was declared
with a type that the bound value can be assigned to.</p>

</div>

<p>Please refer to <a href="/doc/en/lb4/Dependency-injection.html">Dependency injection</a> for further
details.</p>

<h2 id="context-metadata-and-sugar-decorators">Context metadata and sugar decorators</h2>

<p>Other interesting decorators can be used to help give LoopBack hints to
additional metadata you may want to provide in order to automatically set things
up. For example, let’s take the previous example and make it available on the
<code class="language-plaintext highlighter-rouge">GET /greet</code> route using decorators provided by
<a href="https://github.com/strongloop/loopback-next/blob/master/packages/rest"><code class="language-plaintext highlighter-rouge">@loopback/rest</code></a>:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">HelloController</span> <span class="p">{</span>
  <span class="c1">// tell LoopBack you want this controller method</span>
  <span class="c1">// to be available at the GET /greet route</span>
  <span class="p">@</span><span class="nd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/greet</span><span class="dl">'</span><span class="p">)</span>
  <span class="nx">greet</span><span class="p">(</span>
    <span class="c1">// tell LoopBack you want to accept</span>
    <span class="c1">// the name parameter as a string from</span>
    <span class="c1">// the query string</span>
    <span class="p">@</span><span class="nd">param</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="kr">string</span><span class="p">(</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span><span class="p">)</span> <span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>These “sugar” decorators allow you to quickly build up your application without
having to code up all the additional logic by simply giving LoopBack hints (in
the form of metadata) to your intent.</p>

<h2 id="context-events">Context events</h2>

<p>An instance of <code class="language-plaintext highlighter-rouge">Context</code> can emit the following events:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">bind</code>: Emitted when a new binding is added to the context.
    <ul>
      <li>binding: the newly added binding object</li>
      <li>context: Owner context of the binding object</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">unbind</code>: Emitted when an existing binding is removed from the context
    <ul>
      <li>binding: the newly removed binding object</li>
      <li>context: Owner context of the binding object</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">error</code>: Emitted when an observer throws an error during the notification
process
    <ul>
      <li>err: the error object thrown</li>
    </ul>
  </li>
</ul>

<p>The bind/unbind events are represented as the following type:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Events emitted by a context
 */</span>
<span class="k">export</span> <span class="kd">type</span> <span class="nx">ContextEvent</span> <span class="o">=</span> <span class="p">{</span>
  <span class="cm">/**
   * Source context that emits the event
   */</span>
  <span class="na">context</span><span class="p">:</span> <span class="nx">Context</span><span class="p">;</span>
  <span class="cm">/**
   * Binding that is being added/removed/updated
   */</span>
  <span class="nl">binding</span><span class="p">:</span> <span class="nb">Readonly</span><span class="o">&lt;</span><span class="nx">Binding</span><span class="o">&lt;</span><span class="nx">unknown</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="cm">/**
   * Event type
   */</span>
  <span class="nl">type</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="c1">// 'bind' or 'unbind'</span>
<span class="p">};</span>
</code></pre></div></div>

<p>When an existing binding key is replaced with a new one, an <code class="language-plaintext highlighter-rouge">unbind</code> event is
emitted for the existing binding followed by a <code class="language-plaintext highlighter-rouge">bind</code> event for the new binding.</p>

<p>If a context has a parent, binding events from the parent are re-emitted on the
context when the binding key does not exist within the current context.</p>

<p>A context event listener should conform to the following signature:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Synchronous event listener for the `Context` as en event emitter
 */</span>
<span class="k">export</span> <span class="kd">type</span> <span class="nx">ContextEventListener</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">:</span> <span class="nx">ContextEvent</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
</code></pre></div></div>

<p>By default, <code class="language-plaintext highlighter-rouge">maxListeners</code> is set to <code class="language-plaintext highlighter-rouge">Infinity</code> for context objects to avoid
<a href="https://github.com/strongloop/loopback-next/issues/4363">memory leak warnings</a>.
The value can be reset as follows:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ctx</span><span class="p">.</span><span class="nx">setMaxListeners</span><span class="p">(</span><span class="mi">128</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="context-observers">Context observers</h2>

<p>Bindings can be added or removed to a context object. With emitted context
events, we can add listeners to a context object to be invoked when bindings
come and go. There are a few caveats associated with that:</p>

<ol>
  <li>
    <p>The binding object might not be fully configured when a <code class="language-plaintext highlighter-rouge">bind</code> event is
emitted.</p>

    <p>For example:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">();</span>
<span class="nx">ctx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo-value</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">tag</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo-tag</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">bind</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="nx">binding</span><span class="p">}</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">binding</span><span class="p">.</span><span class="nx">tagNames</span><span class="p">);</span> <span class="c1">// returns an empty array `[]`</span>
<span class="p">});</span>
</code></pre></div>    </div>

    <p>The context object emits a <code class="language-plaintext highlighter-rouge">bind</code> event when <code class="language-plaintext highlighter-rouge">ctx.bind</code> method is called. It
does not control the fluent apis <code class="language-plaintext highlighter-rouge">.to('foo-value').tag('foo-tag')</code>, which
happens on the newly created binding object. As a result, the <code class="language-plaintext highlighter-rouge">bind</code> event
listener receives a binding object which only has the binding key populated.</p>

    <p>A workaround is to create the binding first before add it to a context:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">binding</span> <span class="o">=</span> <span class="nx">Binding</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo-value</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">tag</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo-tag</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">binding</span><span class="p">);</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">bind</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="nx">binding</span><span class="p">}</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">binding</span><span class="p">.</span><span class="nx">tagMap</span><span class="p">);</span> <span class="c1">// returns `['foo-tag']`</span>
<span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>It’s hard for event listeners to perform asynchronous operations.</p>
  </li>
</ol>

<p>To make it easy to support asynchronous event processing, we introduce
<code class="language-plaintext highlighter-rouge">ContextObserver</code> and corresponding APIs on <code class="language-plaintext highlighter-rouge">Context</code>:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">ContextObserverFn</code> type and <code class="language-plaintext highlighter-rouge">ContextObserver</code> interface</li>
</ol>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Listen on `bind`, `unbind`, or other events
 * @param eventType - Context event type
 * @param binding - The binding as event source
 * @param context - Context object for the binding event
 */</span>
<span class="k">export</span> <span class="kd">type</span> <span class="nx">ContextObserverFn</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">eventType</span><span class="p">:</span> <span class="nx">ContextEventType</span><span class="p">,</span>
  <span class="nx">binding</span><span class="p">:</span> <span class="nb">Readonly</span><span class="o">&lt;</span><span class="nx">Binding</span><span class="o">&lt;</span><span class="nx">unknown</span><span class="o">&gt;&gt;</span><span class="p">,</span>
  <span class="nx">context</span><span class="p">:</span> <span class="nx">Context</span><span class="p">,</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">ValueOrPromise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Observers of context bind/unbind events
 */</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">ContextObserver</span> <span class="p">{</span>
  <span class="cm">/**
   * An optional filter function to match bindings. If not present, the listener
   * will be notified of all binding events.
   */</span>
  <span class="nl">filter</span><span class="p">?:</span> <span class="nx">BindingFilter</span><span class="p">;</span>

  <span class="cm">/**
   * Listen on `bind`, `unbind`, or other events
   * @param eventType - Context event type
   * @param binding - The binding as event source
   */</span>
  <span class="nl">observe</span><span class="p">:</span> <span class="nx">ContextObserverFn</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**
 * Context event observer type - An instance of `ContextObserver` or a function
 */</span>
<span class="k">export</span> <span class="kd">type</span> <span class="nx">ContextEventObserver</span> <span class="o">=</span> <span class="nx">ContextObserver</span> <span class="o">|</span> <span class="nx">ContextObserverFn</span><span class="p">;</span>
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">filter</code> is not required, we can simply use <code class="language-plaintext highlighter-rouge">ContextObserverFn</code>.</p>

<p>Please note that <code class="language-plaintext highlighter-rouge">ContextEventObserver</code> is different from
<code class="language-plaintext highlighter-rouge">ContextEventListener</code>:</p>

<ul>
  <li>
    <p>A <code class="language-plaintext highlighter-rouge">ContextEventListener</code> is synchronous and it’s invoked when the event is
emitted (before <code class="language-plaintext highlighter-rouge">emit</code> returns).</p>
  </li>
  <li>
    <p>A <code class="language-plaintext highlighter-rouge">ContextEventObserver</code> is asynchronous and it’s invoked by the notification
queue after the event is emitted (after <code class="language-plaintext highlighter-rouge">emit</code> returns).</p>
  </li>
</ul>

<ol>
  <li>Context APIs</li>
</ol>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">subscribe(observer: ContextEventObserver)</code></p>

    <p>Add a context event observer to the context chain, including its ancestors</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">unsubscribe(observer: ContextEventObserver)</code></p>

    <p>Remove the context event observer from the context chain</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">close()</code></p>

    <p>Close the context and release references to other objects in the context
chain. Please note a child context registers event listeners with its parent
context. As a result, the <code class="language-plaintext highlighter-rouge">close</code> method must be called to avoid memory leak
if the child context is to be recycled.</p>
  </li>
</ul>

<p>To react on context events asynchronously, we need to implement the
<code class="language-plaintext highlighter-rouge">ContextObserver</code> interface or provide a <code class="language-plaintext highlighter-rouge">ContextObserverFn</code> and register it
with the context.</p>

<p>For example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="nx">app</span><span class="p">,</span> <span class="dl">'</span><span class="s1">server</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">observer</span><span class="p">:</span> <span class="nx">ContextObserver</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// Only interested in bindings tagged with `foo`</span>
  <span class="na">filter</span><span class="p">:</span> <span class="nx">binding</span> <span class="o">=&gt;</span> <span class="nx">binding</span><span class="p">.</span><span class="nx">tagMap</span><span class="p">.</span><span class="nx">foo</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">,</span>

  <span class="nx">observe</span><span class="p">(</span><span class="na">event</span><span class="p">:</span> <span class="nx">ContextEventType</span><span class="p">,</span> <span class="na">binding</span><span class="p">:</span> <span class="nb">Readonly</span><span class="o">&lt;</span><span class="nx">Binding</span><span class="o">&lt;</span><span class="nx">unknown</span><span class="o">&gt;&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">bind</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">bind: %s</span><span class="dl">'</span><span class="p">,</span> <span class="nx">binding</span><span class="p">.</span><span class="nx">key</span><span class="p">);</span>
      <span class="c1">// ... perform async operation</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">unbind</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">unbind: %s</span><span class="dl">'</span><span class="p">,</span> <span class="nx">binding</span><span class="p">.</span><span class="nx">key</span><span class="p">);</span>
      <span class="c1">// ... perform async operation</span>
    <span class="p">}</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">);</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo-server</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo-value</span><span class="dl">'</span><span class="p">).</span><span class="nx">tag</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo-app</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo-value</span><span class="dl">'</span><span class="p">).</span><span class="nx">tag</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// The following messages will be printed:</span>
<span class="c1">// bind: foo-server</span>
<span class="c1">// bind: foo-app</span>
</code></pre></div></div>

<p>Please note when an observer subscribes to a context, it will be registered with
all contexts on the chain. In the example above, the observer is added to both
<code class="language-plaintext highlighter-rouge">server</code> and <code class="language-plaintext highlighter-rouge">app</code> contexts so that it can be notified when bindings are added
or removed from any of the context on the chain.</p>

<ul>
  <li>
    <p>Observers are called in the next turn of
<a href="https://blog.insiderattack.net/promises-next-ticks-and-immediates-nodejs-event-loop-part-3-9226cbe7a6aa">Promise micro-task queue</a></p>
  </li>
  <li>
    <p>When there are multiple async observers registered, they are notified in
series for an event.</p>
  </li>
  <li>
    <p>When multiple binding events are emitted in the same event loop tick and there
are async observers registered, such events are queued and observers are
notified by the order of events.</p>
  </li>
</ul>

<h3 id="observer-error-handling">Observer error handling</h3>

<p>It’s recommended that <code class="language-plaintext highlighter-rouge">ContextEventObserver</code> implementations should not throw
errors in their code. Errors thrown by context event observers are reported as
follows over the context chain.</p>

<ol>
  <li>
    <p>Check if the current context object has <code class="language-plaintext highlighter-rouge">error</code> listeners, if yes, emit an
<code class="language-plaintext highlighter-rouge">error</code> event on the context and we’re done. if not, try its parent context
by repeating step 1.</p>
  </li>
  <li>
    <p>If no context object of the chain has <code class="language-plaintext highlighter-rouge">error</code> listeners, emit an <code class="language-plaintext highlighter-rouge">error</code>
event on the current context. As a result, the process exits abnormally. See
https://nodejs.org/api/events.html#events_error_events for more details.</p>
  </li>
</ol>

<h2 id="context-view">Context view</h2>

<p>Bindings in a context can come and go. It’s often desirable for an artifact
(especially an extension point) to keep track of other artifacts (extensions).
For example, the <code class="language-plaintext highlighter-rouge">RestServer</code> needs to know routes contributed by <code class="language-plaintext highlighter-rouge">controller</code>
classes or other handlers. Such routes can be added or removed after the
<code class="language-plaintext highlighter-rouge">RestServer</code> starts. When a controller is added after the application starts,
new routes are bound into the application context. Ideally, the <code class="language-plaintext highlighter-rouge">RestServer</code>
should be able to pick up these new routes without restarting.</p>

<p>To support the dynamic tracking of such artifacts registered within a context
chain, we introduce <code class="language-plaintext highlighter-rouge">ContextObserver</code> interface and <code class="language-plaintext highlighter-rouge">ContextView</code> class that can
be used to watch a list of bindings matching certain criteria depicted by a
<code class="language-plaintext highlighter-rouge">BindingFilter</code> function and an optional <code class="language-plaintext highlighter-rouge">BindingComparator</code> function to sort
matched bindings.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">ContextView</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Set up a context chain</span>
<span class="kd">const</span> <span class="nx">appCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">serverCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="nx">appCtx</span><span class="p">,</span> <span class="dl">'</span><span class="s1">server</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// server -&gt; app</span>

<span class="c1">// Define a binding filter to select bindings with tag `controller`</span>
<span class="kd">const</span> <span class="nx">controllerFilter</span> <span class="o">=</span> <span class="nx">binding</span> <span class="o">=&gt;</span> <span class="nx">binding</span><span class="p">.</span><span class="nx">tagMap</span><span class="p">.</span><span class="nx">controller</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">;</span>

<span class="c1">// Watch for bindings with tag `controller`</span>
<span class="kd">const</span> <span class="nx">view</span> <span class="o">=</span> <span class="nx">serverCtx</span><span class="p">.</span><span class="nx">createView</span><span class="p">(</span><span class="nx">controllerFilter</span><span class="p">);</span>

<span class="c1">// No controllers yet</span>
<span class="k">await</span> <span class="nx">view</span><span class="p">.</span><span class="nx">values</span><span class="p">();</span> <span class="c1">// returns []</span>

<span class="c1">// Bind Controller1 to server context</span>
<span class="nx">serverCtx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">controllers.Controller1</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">Controller1</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">tag</span><span class="p">(</span><span class="dl">'</span><span class="s1">controller</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Resolve to an instance of Controller1</span>
<span class="k">await</span> <span class="nx">view</span><span class="p">.</span><span class="nx">values</span><span class="p">();</span> <span class="c1">// returns [an instance of Controller1];</span>

<span class="c1">// Bind Controller2 to app context</span>
<span class="nx">appCtx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">controllers.Controller2</span><span class="dl">'</span><span class="p">).</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">Controller2</span><span class="p">).</span><span class="nx">tag</span><span class="p">(</span><span class="dl">'</span><span class="s1">controller</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Resolve to an instance of Controller1 and an instance of Controller2</span>
<span class="k">await</span> <span class="nx">view</span><span class="p">.</span><span class="nx">values</span><span class="p">();</span> <span class="c1">// returns [an instance of Controller1, an instance of Controller2];</span>

<span class="c1">// Unbind Controller2</span>
<span class="nx">appCtx</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="dl">'</span><span class="s1">controllers.Controller2</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// No more instance of Controller2</span>
<span class="k">await</span> <span class="nx">view</span><span class="p">.</span><span class="nx">values</span><span class="p">();</span> <span class="c1">// returns [an instance of Controller1];</span>
</code></pre></div></div>

<p>The key benefit of <code class="language-plaintext highlighter-rouge">ContextView</code> is that it caches resolved values until context
bindings matching the filter function are added/removed. For most cases, we
don’t have to pay the penalty to find/resolve per request.</p>

<p>To fully leverage the live list of extensions, an extension point such as
<code class="language-plaintext highlighter-rouge">RoutingTable</code> should either keep a pointer to an instance of <code class="language-plaintext highlighter-rouge">ContextView</code>
corresponding to all <code class="language-plaintext highlighter-rouge">routes</code> (extensions) in the context chain and use the
<code class="language-plaintext highlighter-rouge">values()</code> function to match again the live <code class="language-plaintext highlighter-rouge">routes</code> per request or implement
itself as a <code class="language-plaintext highlighter-rouge">ContextObserver</code> to rebuild the routes upon changes of routes in
the context with <code class="language-plaintext highlighter-rouge">listen()</code>.</p>

<p>If your dependency needs to follow the context for values from bindings matching
a filter, use <a href="/doc/en/lb4/Decorators_inject.html#@inject.view"><code class="language-plaintext highlighter-rouge">@inject.view</code></a> for
dependency injection.</p>

<h3 id="contextview-events">ContextView events</h3>

<p>A <code class="language-plaintext highlighter-rouge">ContextView</code> object can emit one of the following events:</p>

<ul>
  <li>‘bind’: when a binding is added to the view</li>
  <li>‘unbind’: when a binding is removed from the view</li>
  <li>‘refresh’: when the view is refreshed as bindings are added/removed</li>
  <li>‘resolve’: when the cached values are resolved and updated</li>
  <li>‘close’: when the view is closed (stopped observing context events)</li>
</ul>

<p>Such as events can be used to update other states/cached values other than the
values watched by the <code class="language-plaintext highlighter-rouge">ContextView</code> object itself. For example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="k">private</span> <span class="nx">_total</span><span class="p">:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">.</span><span class="nx">view</span><span class="p">(</span><span class="nx">filterByTag</span><span class="p">(</span><span class="dl">'</span><span class="s1">counter</span><span class="dl">'</span><span class="p">))</span>
    <span class="k">private</span> <span class="nx">taggedAsFoo</span><span class="p">:</span> <span class="nx">ContextView</span><span class="o">&lt;</span><span class="nx">Counter</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Invalidate cached `_total` if the view is refreshed</span>
    <span class="nx">taggedAsFoo</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">refresh</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_total</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">total</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_total</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_total</span><span class="p">;</span>
    <span class="c1">// Calculate the total of all counters</span>
    <span class="kd">const</span> <span class="nx">counters</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">taggedAsFoo</span><span class="p">.</span><span class="nx">values</span><span class="p">();</span>
    <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">c</span> <span class="k">of</span> <span class="nx">counters</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">result</span> <span class="o">+=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_total</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_total</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="configuration-by-convention">Configuration by convention</h2>

<p>To allow bound items in the context to be configured, we introduce some
conventions and corresponding APIs to make it simple and consistent.</p>

<p>We treat configurations for bound items in the context as dependencies, which
can be resolved and injected in the same way of other forms of dependencies. For
example, the <code class="language-plaintext highlighter-rouge">RestServer</code> can be configured with <code class="language-plaintext highlighter-rouge">RestServerConfig</code>.</p>

<p>Let’s first look at an example:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">RestServer</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">CoreBindings</span><span class="p">.</span><span class="nx">APPLICATION_INSTANCE</span><span class="p">)</span> <span class="nx">app</span><span class="p">:</span> <span class="nx">Application</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">RestBindings</span><span class="p">.</span><span class="nx">CONFIG</span><span class="p">,</span> <span class="p">{</span><span class="na">optional</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
    <span class="nx">config</span><span class="p">:</span> <span class="nx">RestServerConfig</span> <span class="o">=</span> <span class="p">{},</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The configuration (<code class="language-plaintext highlighter-rouge">RestServerConfig</code>) itself is a binding
(<code class="language-plaintext highlighter-rouge">RestBindings.CONFIG</code>) in the context. It’s independent of the binding for
<code class="language-plaintext highlighter-rouge">RestServer</code>. The caveat is that we need to maintain a different binding key for
the configuration. Referencing a hard-coded key for the configuration also makes
it impossible to have more than one instances of the <code class="language-plaintext highlighter-rouge">RestServer</code> to be
configured with different options, such as <code class="language-plaintext highlighter-rouge">protocol</code> or <code class="language-plaintext highlighter-rouge">port</code>.</p>

<p>To solve these problems, we introduce an accompanying binding for an item that
expects configuration. For example:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">servers.RestServer.server1</code>: RestServer</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">servers.RestServer.server1:$config</code>: RestServerConfig</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">servers.RestServer.server2</code>: RestServer</li>
  <li><code class="language-plaintext highlighter-rouge">servers.RestServer.server2:$config</code>: RestServerConfig</li>
</ul>

<p>The following APIs are available to enforce/leverage this convention:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">ctx.configure('servers.RestServer.server1')</code> =&gt; Binding for the
configuration</li>
  <li><code class="language-plaintext highlighter-rouge">Binding.configure('servers.RestServer.server1')</code> =&gt; Creates a accompanying
binding for the configuration of the target binding</li>
  <li><code class="language-plaintext highlighter-rouge">ctx.getConfig('servers.RestServer.server1')</code> =&gt; Get configuration</li>
  <li><code class="language-plaintext highlighter-rouge">@config</code> to inject corresponding configuration</li>
  <li><code class="language-plaintext highlighter-rouge">@config.getter</code> to inject a getter function for corresponding configuration</li>
  <li><code class="language-plaintext highlighter-rouge">@config.view</code> to inject a <code class="language-plaintext highlighter-rouge">ContextView</code> for corresponding configuration</li>
</ol>

<p>The <code class="language-plaintext highlighter-rouge">RestServer</code> can now use <code class="language-plaintext highlighter-rouge">@config</code> to inject configuration for the current
binding of <code class="language-plaintext highlighter-rouge">RestServer</code>.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">RestServer</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">CoreBindings</span><span class="p">.</span><span class="nx">APPLICATION_INSTANCE</span><span class="p">)</span> <span class="nx">app</span><span class="p">:</span> <span class="nx">Application</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">config</span><span class="p">()</span>
    <span class="nx">config</span><span class="p">:</span> <span class="nx">RestServerConfig</span> <span class="o">=</span> <span class="p">{},</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">@config.*</code> decorators can take an optional <code class="language-plaintext highlighter-rouge">propertyPath</code> parameter to
allow the configuration value to be a deep property of the bound value. For
example, <code class="language-plaintext highlighter-rouge">@config('port')</code> injects <code class="language-plaintext highlighter-rouge">RestServerConfig.port</code> to the target.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">MyRestServer</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">config</span><span class="p">(</span><span class="dl">'</span><span class="s1">host</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">host</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">config</span><span class="p">(</span><span class="dl">'</span><span class="s1">port</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">port</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We also allow <code class="language-plaintext highlighter-rouge">@config.*</code> to be resolved from another binding than the current
one:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">config</span><span class="p">,</span> <span class="nx">CoreBindings</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MyRestServer</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="c1">// Inject the `rest.host` from the application config</span>
    <span class="p">@</span><span class="nd">config</span><span class="p">({</span>
      <span class="na">fromBinding</span><span class="p">:</span> <span class="nx">CoreBinding</span><span class="p">.</span><span class="nx">APPLICATION_INSTANCE</span><span class="p">,</span>
      <span class="na">propertyPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">rest.host</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="nx">host</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span>
    <span class="c1">// Inject the `rest.port` from the application config</span>
    <span class="p">@</span><span class="nd">config</span><span class="p">({</span>
      <span class="na">fromBinding</span><span class="p">:</span> <span class="nx">CoreBinding</span><span class="p">.</span><span class="nx">APPLICATION_INSTANCE</span><span class="p">,</span>
      <span class="na">propertyPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">rest.port</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="nx">port</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Now we can use <code class="language-plaintext highlighter-rouge">context.configure()</code> to provide configuration for target
bindings.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">appCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">();</span>
<span class="nx">appCtx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">servers.RestServer.server1</span><span class="dl">'</span><span class="p">).</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">RestServer</span><span class="p">);</span>
<span class="nx">appCtx</span>
  <span class="p">.</span><span class="nx">configure</span><span class="p">(</span><span class="dl">'</span><span class="s1">servers.RestServer.server1</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">to</span><span class="p">({</span><span class="na">protocol</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https</span><span class="dl">'</span><span class="p">,</span> <span class="na">port</span><span class="p">:</span> <span class="mi">473</span><span class="p">});</span>

<span class="nx">appCtx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">servers.RestServer.server2</span><span class="dl">'</span><span class="p">).</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">RestServer</span><span class="p">);</span>
<span class="nx">appCtx</span><span class="p">.</span><span class="nx">configure</span><span class="p">(</span><span class="dl">'</span><span class="s1">servers.RestServer.server2</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">({</span><span class="na">protocol</span><span class="p">:</span> <span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">,</span> <span class="na">port</span><span class="p">:</span> <span class="mi">80</span><span class="p">});</span>
</code></pre></div></div>

<p>Please note that <code class="language-plaintext highlighter-rouge">@config.*</code> is different from <code class="language-plaintext highlighter-rouge">@inject.*</code> as <code class="language-plaintext highlighter-rouge">@config.*</code>
injects configuration based on the current binding where <code class="language-plaintext highlighter-rouge">@config.*</code> is applied.
No hard-coded binding key is needed. The <code class="language-plaintext highlighter-rouge">@config.*</code> also allows the same class
such as <code class="language-plaintext highlighter-rouge">RestServer</code> to be bound to different keys with different configurations
as illustrated in the code snippet above.</p>

<p>All configuration accessors or injectors (such as <code class="language-plaintext highlighter-rouge">ctx.getConfig</code>, <code class="language-plaintext highlighter-rouge">@config</code>) by
default treat the configuration binding as optional, i.e. return <code class="language-plaintext highlighter-rouge">undefined</code> if
no configuration was bound. This is different from <code class="language-plaintext highlighter-rouge">ctx.get</code> and <code class="language-plaintext highlighter-rouge">@inject</code> APIs,
which require the binding to exist and throw an error when the requested binding
is not found. The behavior can be customized via <code class="language-plaintext highlighter-rouge">ResolutionOptions.optional</code>
flag.</p>

<h3 id="allow-configuration-to-be-changed-dynamically">Allow configuration to be changed dynamically</h3>

<p>Some configurations are designed to be changeable dynamically, for example, the
logging level for an application. To allow that, we introduce <code class="language-plaintext highlighter-rouge">@config.getter</code>
to always fetch the latest value of the configuration.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">Logger</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">config</span><span class="p">.</span><span class="nx">getter</span><span class="p">()</span>
  <span class="k">private</span> <span class="nx">getLevel</span><span class="p">:</span> <span class="nx">Getter</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="k">async</span> <span class="nx">log</span><span class="p">(</span><span class="nx">level</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">currentLevel</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getLevel</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">shouldLog</span><span class="p">(</span><span class="nx">level</span><span class="p">,</span> <span class="nx">currentLevel</span><span class="p">))</span> <span class="p">{</span>
      <span class="c1">// ...</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>


    <div class="tags">
      
    </div>
</div>

<hr class="shaded"/>

<footer id="container">
            <div class="row">
                <div class="col-md-6 footer-left">
               &copy;2021 IBM / StrongLoop. All rights reserved. <br />
 Site last generated: Mar 22, 2021
              </div>
              <div class="col-md-6 footer-right">
                <p><img src="https://loopback.io/images/company_logo.png" alt="Company logo"/></p>
              </div>
            </div>
</footer>


        </div>
        <!-- /.row -->
</div>
<!-- /.container -->
    </div>
</body>

</html>
