<!DOCTYPE html>
<head>
    

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="keywords" content=" LoopBack 4.0, LoopBack 4, Node.js, TypeScript, OpenAPI">
  <title>Implementing features | LoopBack Documentation</title>
  <link rel="stylesheet" href="/css/syntax.css">

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/modern-business.css">
    <link rel="stylesheet" href="/css/lavish-bootstrap.css">
    <link rel="stylesheet" href="/css/customstyles.css">
    <link rel="stylesheet" href="/css/theme-v4.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150726441-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150726441-2');
</script>


    <!-- github star button -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>


    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.0/anchor.min.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/customscripts.js"></script>

    <link rel="shortcut icon" href="/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->


    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand no_icon" href="/doc/index.html">
              <img class="no_icon" style="width:147px;" src="/images/branding/logo/white/loopback.svg">&nbsp;<span class="projectTitle"></span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is  -->
                          
                            <li><a href="https://loopback.io/doc/en/lb4/apidocs.index.html" target="_blank">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is  -->
                          
                            <li><a href="http://apidocs.loopback.io" target="_blank">LoopBack 3.x</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">View<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is / -->
                          
                            <li><a href="/">LoopBack Overview</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/en/lb4/ -->
                          
                            <li class="dropdownActive"><a href="/doc/en/lb4/">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/en/lb3/ -->
                          
                            <li><a href="/doc/en/lb3/">LoopBack 3.x</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/en/lb2/ -->
                          
                            <li><a href="/doc/en/lb2/">LoopBack 2.x</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/en/community/ -->
                          
                            <li><a href="/doc/en/community/">Community projects</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/en/contrib/ -->
                          
                            <li><a href="/doc/en/contrib/">Contributing to LoopBack</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/en/sec/ -->
                          
                            <li><a href="/doc/en/sec/">Security advisories</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is  -->
                          
                            <li><a href="https://github.com/strongloop/loopback.io" target="_blank">Docs Github Repo</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs-announcements" target="_blank">Announcements Mailing List</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs" target="_blank">Developer Forum</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is  -->
                          
                            <li><a href="https://join.slack.com/t/loopbackio/shared_invite/zt-8lbow73r-SKAKz61Vdao~_rGf91pcsw" target="_blank">LoopBack on Slack</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is  -->
                          
                            <li><a href="https://stackoverflow.com/questions/tagged/strongloop+or+loopback4+or+loopbackjs" target="_blank">LoopBack on Stack Overflow</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is  -->
                          
                            <li><a href="https://strongloop.com/strongblog/tag_LoopBack.html" target="_blank">StrongLoop Blog - LoopBack</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Translations<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/es/lb2/ -->
                          
                            <li><a href="/doc/es/lb2/">Español (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/es/lb4/ -->
                          
                            <li><a href="/doc/es/lb4/">Español (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/fr/lb2/ -->
                          
                            <li><a href="/doc/fr/lb2/">Français (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/fr/lb4/ -->
                          
                            <li><a href="/doc/fr/lb4/">Français (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/ko/lb2/ -->
                          
                            <li><a href="/doc/ko/lb2/">한국어 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/ko/lb3/ -->
                          
                            <li><a href="/doc/ko/lb3/">한국어 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/pt-br/lb2/ -->
                          
                            <li><a href="/doc/pt-br/lb2/">Português (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/pt-br/lb4/ -->
                          
                            <li><a href="/doc/pt-br/lb4/">Português (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/ja/lb2/ -->
                          
                            <li><a href="/doc/ja/lb2/">日本語 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/ja/lb3/ -->
                          
                            <li><a href="/doc/ja/lb3/">日本語 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/ja/lb4/ -->
                          
                            <li><a href="/doc/ja/lb4/">日本語 (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/ru/lb2/ -->
                          
                            <li><a href="/doc/ru/lb2/">Pусский (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/zh/lb2/ -->
                          
                            <li><a href="/doc/zh/lb2/">中文 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/en/lb4/Implementing-features.html .... folderitem.url is /doc/zh/lb4/ -->
                          
                            <li><a href="/doc/zh/lb4/">中文 (v4)</a></li>
                          
                        
                    </ul>
                </li>
                
                
                
                <li>
                    <form id="search" name="search" class="input-group lb-search" action="/search" method="GET">
                        <input type="text" class="form-control search-bar" placeholder="Search (powered by Watson)" name="q">
                        
                          <input type="hidden" name="sidebar" value="lb4_sidebar">
                        
                        <div class="input-group-btn">
                            <button type="submit" class="btn btn-default" aria-label="search">
                              <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button>
                        </div>
                      </form>
                </li>
            </ul>
        </div>
      </div>
</nav>

<!-- Page Content -->
<div class="container">
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <nav class="col-md-3 sidebar-col">
          











<!-- NOTE: sidebar = site.data.sidebars.mydoc_sidebar.entries -->
<div class="sidebarTitle"><a href="index.html">LoopBack 4</a></div>
<ul id="mysidebar" class="nav-list">
  

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="index.html">Overview</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Getting-started.html">Getting started</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Inside-LoopBack-Application.html">Inside a LoopBack Application</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent-expand   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building LoopBack Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Tutorials.html">Tutorials</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-tutorial.html">Todo Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-scaffolding.html">Create your app scaffolding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-model.html">Add the Todo model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-datasource.html">Add a Datasource</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-repository.html">Add a Repository</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-controller.html">Add a Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-putting-it-together.html">Putting it all together</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-tutorial-geocoding-service.html">Bonus: Integrate with a geo-coding service</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-list-tutorial.html">TodoList Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-model.html">Add TodoList Model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-repository.html">Add TodoList Repository</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="todo-list-tutorial-relations.html">Add Model Relations</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-has-one-relation.html">Add a HasOne Relation</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-controller.html">Add TodoList Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="todo-list-tutorial-sqldb.html">Running on relational databases</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-back-end.html">Connecting to Back-end Service Tutorials</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="soap-calculator-tutorial.html">SOAP Web Service Tutorial</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-web-service-overview.html">SOAP Web Service Overview</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-scaffolding.html">App scaffolding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-datasource.html">Add a Datasource</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-service.html">Add a Service</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-add-controller.html">Add a Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="soap-calculator-tutorial-run-and-test.html">Run and Test it</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="express-with-lb4-rest-tutorial.html">Creating an Express Application with LoopBack REST API</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-tutorial.html">How to secure your LoopBack 4 application with JWT authentication</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="core-tutorial.html">Build large scale Node.js projects with LoopBack 4</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part1.html">Introduction of the application scenario</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part2.html">Architectural challenges</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part3.html">Context in action</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part4.html">Dependency injection</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part5.html">Extension point and extensions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part6.html">Interception</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part7.html">Observation of life cycle events</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part8.html">Configuration</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part9.html">Discover and load artifacts by convention</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part10.html">Advanced Recipes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="core-tutorial-part11.html">Summary</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Examples.html">Examples</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-examples.html">Community examples</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">How-to guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building REST APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-crud-rest-apis.html">Creating CRUD REST APIs from a model</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-how-openapi-spec-is-served.html">Customizing how OpenAPI spec is served</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-routes.html">Customizing routes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Dynamic-models-repositories-controllers.html">Dynamically adding models, repositories, and controllers</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Self-hosted-rest-api-explorer.html">Self-hosted REST API Explorer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Serving-static-files.html">Serving Static Files</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Accessing-http-request-response.html">Accessing HTTP Request and Response Objects</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="File-upload-download.html">Uploading and Downloading Files</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Express-middleware.html">Using Express Middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-strong-error-handler.html">Using strong-error-handler</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Boot-and-Mount-a-LoopBack-3-application.html">Boot and Mount a LoopBack 3 Application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Integrating-with-api-connect.html">Integrating with API Connect</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Accepting-messagepack-over-http.html">Accepting MessagePack over HTTP</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Creating Other Forms of APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="GraphQL.html">Creating GraphQL APIs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-openapi-to-graphql.html">Using OpenAPI-to-GraphQL</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Creating-artifacts-runtime.html">Creating Artifacts at Runtime</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-model-runtime.html">Creating Model at Runtime</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-datasource-runtime.html">Creating DataSource at Runtime</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-repository-runtime.html">Creating Repositories at Runtime</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Building frontend applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Building-frontend-angular-application.html">Building an Angular Application from OpenAPI Specification</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Customizing-server-configuration.html">Customizing Server configuration</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Migrate-from-legacy-sequence.html">Migrate from Legacy Sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Running-cron-jobs.html">Running cron jobs</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Accessing Databases</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Configuring-datasource.html">Configuring DataSource</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Working-with-data.html">Working with data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Querying-data.html">Querying data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Fields-filter.html">Fields filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Include-filter.html">Include filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Limit-filter.html">Limit filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Order-filter.html">Order filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Skip-filter.html">Skip filter</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Where-filter.html">Where filter</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-database-transactions.html">Using Database Transactions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Database-migrations.html">Database Migrations</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Executing-database-commands.html">Executing database commands</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Using TypeORM</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-typeorm-with-loopback.html">How to use TypeORM with LoopBack</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Accessing-services.html">Accessing Services</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Calling-soap-web-services.html">Calling SOAP Web services</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Calling-rest-apis.html">Calling REST APIs</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Parsing-requests-guide.html">Parsing requests</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Validation.html">Validating Data</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-REST-layer.html">Validation in REST Layer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-controller-repo-service-layer.html">Validation in the Controller, Repository and Service Layer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Validation-ORM-layer.html">Validation in ORM Layer</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Configuring-applications.html">Configuring Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application-setup-tips.html">Tips for Application Setup</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Securing Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Authentication-overview.html">Authentication</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-tutorial.html">Apply JWT Authentication in Todo Example</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Loopback-component-authentication.html">Authentication Component</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-decorator.html">Authentication Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-action.html">Authentication Action</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-strategy.html">Authentication Strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-component-options.html">Managing Custom Authentication Strategy Options</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="JWT-authentication-extension.html">JWT Authentication Extension</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Implement-your-own-strategy.html">Implement your own authentication strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authentication-passport.html">Passport Adapter for Authentication</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Authorization-overview.html">Authorization</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="RBAC-with-authorization.html">RBAC with Authorization System</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Loopback-component-authorization.html">Authorization Component</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-interceptor.html">Interceptor</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-decorator.html">Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-authorizer.html">Authorizer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-decision-matrix.html">Decision Matrix</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Authorization-component-enforcer.html">Enforcer</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Deployment.html">Deploying Applications</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Enabling-https.html">Enabling HTTPS</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Deploying-to-IBM-Cloud.html">Deploying to IBM Cloud</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="deploying_to_ibm_cloud_kubernetes.html">Deploying to Kubernetes on IBM Cloud</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="deploying-with-pm2-and-nginx.html">Deploying with pm2 and nginx</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Appsody-LoopBack.html">Developing and Deploying LoopBack Applications with Appsody</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Running-cron-jobs.html">Running cron jobs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Health.html">Health check</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Metrics.html">Metrics for Prometheus</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Pooling.html">Pooling</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Troubleshooting.html">Troubleshooting</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Setting-debug-strings.html">Setting debug strings</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Logging.html">Logging</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Context-explorer.html">Context Explorer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Debugging-tests-with-mocha.html">Debugging tests with Mocha</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent-expand   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Extending-LoopBack-4.html">Extending LoopBack Framework</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">How-to guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-components.html">Creating components</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-decorators.html">Creating decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="creating-components-rest-api.html">Contributing REST API</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="creating-components-services.html">Creating services</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Creating-servers.html">Creating servers</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-request-body-parsing.html">Extending request body parsing</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-life-cycle.html">Extension life cycle</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-OpenAPI-specification.html">Extending OpenAPI specification</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extending-Model-API-builder.html">Extending Model API builder</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Testing-your-extension.html">Testing your extension</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-extensions.html">Community extensions</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Concepts.html">Concepts</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Crafting-LoopBack-4.html">Crafting LoopBack 4</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Core</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application.html">Application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Component.html">Component</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Context.html">Context</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Binding.html">Binding</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Dependency-injection.html">Dependency Injection</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Interceptor.html">Interceptor</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Life-cycle.html">Life Cycle Event and Observer</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-point-and-extensions.html">Extension point and extensions</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Service.html">Service</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Booting-an-Application.html">Booter</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Decorators.html">Decorators</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_openapi.html">OpenAPI Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_inject.html">Dependency Injection Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_authenticate.html">Authentication Decorator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_authorize.html">Authorization Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_service.html">Service Decorators</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Decorators_repository.html">Repository Decorators</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Mixin.html">Mixin</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">REST APIs</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Server.html">Server</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Sequence.html">Sequence</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-middleware-sequence.html">Middleware based sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-action-sequence.html">Action based sequence</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Advanced-sequence-topics.html">Advanced topics</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Routing-requests.html">Routing requests</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Parsing-requests.html">Parsing requests</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Working-with-express-middleware.html">Working with Express Middleware</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Middleware.html">Middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Route.html">Route</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Controller.html">Controller</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Request-response-cycle.html">Request/response cycle</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Data Access</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Model.html">Model</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Relations.html">Relations</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasMany-relation.html">HasMany Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="BelongsTo-relation.html">BelongsTo Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasOne-relation.html">HasOne Relation</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="HasManyThrough-relation.html">HasManyThrough Relation</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Repository.html">Repository</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DataSource.html">DataSource</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Best-practices.html">Best practices</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Defining-the-API-using-code-first-approach.html">Defining the API using code-first approach</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Defining-your-testing-strategy.html">Defining your testing strategy</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Testing-your-application.html">Testing your application</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="section-name" href="#">Reference guides</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Loopback-application-layout.html">LoopBack 4 Application Layout</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="apidocs.index.html">API docs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Reserved-binding-keys.html">Reserved binding keys</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Error-codes.html">Error codes</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LoopBack-types.html">LoopBack Types</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Command-line-interface.html">CLI References</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Application-generator.html">Application generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Controller-generator.html">Controller generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DataSource-generator.html">DataSource generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Importing-LB3-models.html">Import models from LoopBack 3</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Model-generator.html">Model generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Discovering-models.html">Model discovery</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Relation-generator.html">Relation generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Repository-generator.html">Repository generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Rest-Crud-generator.html">REST CRUD model endpoints generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Service-generator.html">Service generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="OpenAPI-generator.html">OpenAPI generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Life-cycle-observer-generator.html">Life cycle observer generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Interceptor-generator.html">Interceptor generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Extension-generator.html">Extension generator</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Download-examples.html">Download examples</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Update-generator.html">Update project dependencies</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Copyright-generator.html">Generate copyright/license headers</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Connectors-reference.html">Connectors reference</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Memory-connector.html">Memory connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Database-connectors.html">Database connectors</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Cassandra-connector.html">Cassandra connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Cloudant-connector.html">Cloudant connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Couchdb2-connector.html">CouchDB 2.x connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DashDB.html">DashDB connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-connector.html">IBM Db2 (for Linux, Unix, Windows) connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-for-i-connector.html">IBM Db2 for i connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="DB2-for-z-OS-connector.html">IBM Db2 for z/OS connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Informix.html">Informix connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="MongoDB-connector.html">MongoDB connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-MongoDB.html">MongoDB Connector Tutorial</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Using-MongoLab.html">Using MongoLab</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="MySQL-connector.html">MySQL connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-MySQL.html">MySQL Connector Tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Oracle-connector.html">Oracle connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Installing-the-Oracle-connector.html">Installing the Oracle connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-Oracle.html">Oracle connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="PostgreSQL-connector.html">PostgreSQL connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-PostgreSQL.html">PostgreSQL connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Redis-connector.html">Redis connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="kv-redis-connector.html">Redis key-value connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Example-kv-connector.html">KV connector example</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="SQL-Server-connector.html">SQL Server connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-Microsoft-SQL-Server.html">SQL Server connector tutorial</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="SQLite3.html">SQLite3 connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="zOSconnectEE.html">z/OS Connect Enterprise Edition connector</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="Other-connectors.html">Other connectors</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="JSON-RPC-connector.html">JSON RPC connector</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="MQLight-connector.html">MQ Light connector</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="REST-connector.html">REST connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="REST-connector-example.html">REST connector example</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="SOAP-connector.html">SOAP connector</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Strong-soap.html">Strong-soap</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="SOAP-Connector-example.html">SOAP connector example</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Connecting-to-SOAP.html">Connecting to SOAP web services</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="OpenAPI-connector.html">OpenAPI connector</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Community-connectors.html">Community connectors</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="changelog.index.html">Change logs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Deploy-for-GDPR-readiness.html">Considerations for GDPR readiness</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="code-contrib-lb4.html">Contributing to LoopBack 4</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="submitting_a_pr.html">Submitting a pull request to LoopBack 4</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="FAQ.html">FAQ</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-overview.html">Migration guide</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="Understanding-the-differences.html">Understanding the differences</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LB3-vs-LB4-booting.html">Booting process</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="LB3-vs-LB4-request-response-cycle.html">Request/response cycle</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-mounting-lb3app.html">Mounting a LoopBack 3 application</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-express-middleware.html">Express middleware</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-datasources.html">Datasources</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-models-overview.html">Migrating models</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-core.html">Model definitions and built-in APIs</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-relations.html">Relations</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-methods.html">Custom methods</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-remoting-hooks.html">Remoting hooks</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-operation-hooks.html">CRUD operation hooks</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-models-mixins.html">Mixins</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-boot-scripts.html">Boot scripts</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-auth-overview.html">Authentication & authorization</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-access-control-example.html">Access control example</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-authentication.html">Built-in models and authentication</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-passport.html">Passport</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-auth-oauth2.html">OAuth2 Provider</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-cli.html">CLI</a>
    
      
  </li>
  


  
  
  <li class="  tree-parent   ">
     <a class="show-hide" href="#"></span> 
    
      <a class="page-link" href="migration-extensions-overview.html">Components and extensions</a>
    
      
      <ul class="nav-list">
          

  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-project-layout.html">Project layout</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-models.html">Models</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-current-context.html">Current context</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-mixins.html">Mixins</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-extensions-rest-api.html">REST API</a>
    
      
  </li>
  



      </ul>
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-clients.html">Clients (API consumers)</a>
    
      
  </li>
  


  
  
  <li class=" leaf-node  ">
    
    
      <a class="page-link" href="migration-not-planned.html">Features not planned</a>
    
      
  </li>
  



      </ul>
      
  </li>
  



</ul>

        </nav>
        <!-- Content Column -->
        <div class="col-md-9">
            
<div class="post-header">
   <h1 class="post-title-main">Implementing features</h1>
   
     
       <a target="_blank" href="https://github.com/strongloop/loopback-next/blob/master/docs/site/Implementing-features.shelved.md" class="githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit this page</a>
   
</div>

<div class="post-content">





 
   
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
;$(function() {
  var level = parseInt(3, 10);
  if (level === 1) {level = 'h2'}
  if (level === 2) {level = 'h2,h3'}
  if (level === 3) {level = 'h2,h3,h4'}
  if (level === 4) {level = 'h2,h3,h4,h5'}

  // Add a new level for changelog files which use h1,h2,h3
  if (level === 0) {level = 'h1,h2,h3,h4,h5'}

  var toc = $('#toc')

  toc.toc({minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: level})

  /* this offset helps with the space taken up by the floating toolbar */
  toc.on('click', 'a', function() {
    var target = $(this.getAttribute('href')),
      scroll_target = target.offset().top

    $(window).scrollTop(scroll_target - 10)
    return false
  })
  .on('click', '.toc-expand-button', function() {
    toc.find('> ul').slideToggle('fast');
  })
})
</script>

<div id="toc">
  <span class="toc-title">Page Contents</span>
  <button type="button" class="btn btn-link toc-expand-button">
    <i class="fa fa-bars"></i>
  </button>
</div>

 

    <div style="font-size: 11pt; border: 1px solid #cccccc; background-color: #EBF5EB; padding: 10px 10px 0 10px; border-radius: 3px; margin: 10px 50px 10px 50px;">
  <p><span style="font-weight: bold;">Previously</span>:  This article continues from [Defining your
testing stategy(./Defining-your-testing-strategy.md).</p>

</div>

<h2 id="incrementally-implement-features">Incrementally implement features</h2>

<p>To recapitulate the status of your new project:</p>

<ul>
  <li>You have defined your application’s API and described it in an OpenAPI Spec
document.</li>
  <li>You have empty controllers backing your new operations.</li>
  <li>Our project has a test verifying the validity of your API spec. This test
passes.</li>
  <li>Our test suite includes a smoke test to verify conformance of your
implementation with the API spec. These checks are all failing now.</li>
</ul>

<p>Now it’s time to put your testing strategy outlined in the previous section into
practice. Pick one of the new API operations, preferably the one that’s easiest
to implement, and get to work!</p>

<p>Start with <code class="language-plaintext highlighter-rouge">GET /product/{slug}</code> in this guide.</p>

<h3 id="write-an-acceptance-test">Write an acceptance test</h3>

<p>One “acceptance test”, where you start the application, make an HTTP request to
search for a given product name, and verify that expected products were
returned. This verifies that all parts of your application are correctly wired
together.</p>

<p>Create <code class="language-plaintext highlighter-rouge">src/__tests__/acceptance/product.acceptance.ts</code> with the following
contents:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">HelloWorldApp</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../..</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">RestBindings</span><span class="p">,</span> <span class="nx">RestServer</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/rest</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Client</span><span class="p">,</span> <span class="nx">expect</span><span class="p">,</span> <span class="nx">supertest</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/testlab</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Product (acceptance)</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="na">app</span><span class="p">:</span> <span class="nx">HelloWorldApp</span><span class="p">;</span>
  <span class="kd">let</span> <span class="na">request</span><span class="p">:</span> <span class="nx">Client</span><span class="p">;</span>

  <span class="nx">before</span><span class="p">(</span><span class="nx">givenEmptyDatabase</span><span class="p">);</span>
  <span class="nx">before</span><span class="p">(</span><span class="nx">givenRunningApp</span><span class="p">);</span>

  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">retrieves product details</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// arrange</span>
    <span class="kd">const</span> <span class="nx">product</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">givenProduct</span><span class="p">({</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Ink Pen</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">price</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">category</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Stationery</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">The ultimate ink-powered pen for daily writing</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">popular</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">available</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">endDate</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="p">});</span>

    <span class="c1">// act</span>
    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/product/ink-pen</span><span class="dl">'</span><span class="p">);</span>

    <span class="c1">// assert</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">({</span>
      <span class="na">id</span><span class="p">:</span> <span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Ink Pen</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">price</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">category</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Stationery</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">available</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">The ultimate ink-powered pen for daily writing</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">label</span><span class="p">:</span> <span class="dl">'</span><span class="s1">popular</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">endDate</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="p">});</span>
  <span class="p">});</span>

  <span class="k">async</span> <span class="kd">function</span> <span class="nx">givenEmptyDatabase</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// TODO</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="kd">function</span> <span class="nx">givenRunningApp</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HelloWorldApp</span><span class="p">({</span>
      <span class="na">rest</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">port</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>
    <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
    <span class="nx">request</span> <span class="o">=</span> <span class="nx">supertest</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">restServer</span><span class="p">.</span><span class="nx">url</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="kd">function</span> <span class="nx">givenProduct</span><span class="p">(</span><span class="na">data</span><span class="p">:</span> <span class="nb">Object</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// TODO</span>
    <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">data</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Notice there are few missing pieces annotated with TODO comments. Well come back
to them very soon. Remember, when practicing TDD in small steps, the goal is to
add as little test code as needed to uncover a missing piece in the production
code, and then add just enough production code to make your new test pass (while
keeping all existing tests passing too).</p>

<p>Run the tests and watch the new test fail:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  1) Product (acceptance) retrieves product details:
     Error: expected 200 "OK", got 404 "Not Found"
</code></pre></div></div>

<p>When you scroll up in the test output, you will see more information about the
404 error:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Unhandled error in GET /product/ink-pen: 404 Error: Controller method not found: ProductController.getDetails
</code></pre></div></div>

<p>Learn more about acceptance testing in
<a href="/doc/en/lb4/Testing-your-application.html#test-your-individual-rest-api-endpoints">Test your individual REST API endpoints</a>
from <a href="/doc/en/lb4/Testing-your-application.html">Testing your application</a>.</p>

<h3 id="write-a-unit-test-for-the-new-controller-method">Write a unit-test for the new controller method</h3>

<p>The new acceptance test is failing because there is no <code class="language-plaintext highlighter-rouge">getDetails</code> method
implemented by <code class="language-plaintext highlighter-rouge">ProductController</code>. Start with a unit-test to drive the
implementation of this new method. Please refer to
<a href="/doc/en/lb4/Testing-your-application.html#unit-test-your-controllers">Unit-test your Controllers</a>
for more details.</p>

<p>Create <code class="language-plaintext highlighter-rouge">tests/unit/product-controller.test.ts</code> with the following contents:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">ProductController</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../..</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">expect</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/testlab</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">ProductController</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">getDetails()</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">retrieves details of a given product</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductController</span><span class="p">();</span>
      <span class="kd">const</span> <span class="nx">details</span> <span class="o">=</span> <span class="nx">controller</span><span class="p">.</span><span class="nx">getDetails</span><span class="p">(</span><span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">details</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">containDeep</span><span class="p">({</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Ink Pen</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<p>This test is clearly not describing a final solution, for example there is no
Product model and repository involved. However, it’s a good first increment that
drives enough of the initial controller implementation. This shows the power of
unit testing - you can test this new controller method in isolation, independent
from the other moving parts of the application, even before those other parts
are implemented!</p>

<p>Run <code class="language-plaintext highlighter-rouge">npm test</code> and watch the test fail with a helpful error message:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TSError: ⨯ Unable to compile TypeScript
src/__tests__/unit/product-controller.test.ts (13,40): Property 'getDetails' does not exist on type 'ProductController'. (2339)
</code></pre></div></div>

<p>Now it’s time to write the first implementation of the <code class="language-plaintext highlighter-rouge">getDetails</code> method.
Modify the file <code class="language-plaintext highlighter-rouge">src/controllers/product-controller.ts</code> as follows:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductController</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">getDetails</span><span class="p">(</span><span class="nx">slug</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Ink Pen</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Run <code class="language-plaintext highlighter-rouge">npm test</code> to see your new test pass. Notice that the Dredd-powered test of
<code class="language-plaintext highlighter-rouge">/product/{slug}</code> is passing too, and your acceptance test is failing with a
different error now - the response does not contain all expected product
properties.</p>

<p>While it’s possible to further iterate by adding more unit tests, a more
valuable next step is to write an integration test to verify that your new API
is using data from your backing database.</p>

<h3 id="write-an-integration-test-for-the-new-controller-method">Write an integration test for the new controller method</h3>

<p>Create <code class="language-plaintext highlighter-rouge">tests/integration/product-controller.integration.ts</code> with the following
contents:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">ProductController</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../..</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">expect</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/testlab</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">ProductController (integration)</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">givenEmptyDatabase</span><span class="p">);</span>

  <span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">getDetails()</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">retrieves details of the given product</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">inkPen</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">givenProduct</span><span class="p">({</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Ink Pen</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">});</span>

      <span class="kd">const</span> <span class="nx">pencil</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">givenProduct</span><span class="p">({</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Pencil</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">pencil</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">});</span>

      <span class="kd">const</span> <span class="nx">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductController</span><span class="p">();</span>

      <span class="kd">const</span> <span class="nx">details</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">controller</span><span class="p">.</span><span class="nx">getDetails</span><span class="p">(</span><span class="dl">'</span><span class="s1">pencil</span><span class="dl">'</span><span class="p">);</span>

      <span class="nx">expect</span><span class="p">(</span><span class="nx">details</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">eql</span><span class="p">(</span><span class="nx">pencil</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>

  <span class="k">async</span> <span class="kd">function</span> <span class="nx">givenEmptyDatabase</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// TODO</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="kd">function</span> <span class="nx">givenProduct</span><span class="p">(</span><span class="na">data</span><span class="p">:</span> <span class="nb">Object</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// TODO</span>
    <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">data</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Run <code class="language-plaintext highlighter-rouge">npm test</code> to see the new test fail.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AssertionError: expected Object { name: 'Ink Pen', slug: 'ink-pen' } to equal Object { name: 'Pencil', slug: 'pencil', id: 1 } (at name, Ahas 'Ink Pen' and B has 'Pencil')
+ expected - actual

   {
  -  "name": "Ink Pen"
  -  "slug": "ink-pen"
  +  "id": 1
  +  "name": "Pencil"
  +  "slug": "pencil"
   }
</code></pre></div></div>

<p>Please refer to
<a href="/doc/en/lb4/Testing-your-application.html#test-your-controllers-and-repositories-together">Test your Controllers and Repositories together</a>
to learn more about integration testing.</p>

<p>Take a closer look at the new test. To make it fail with the current
implementation, you need to find a different scenario compared to what is
covered by the unit test. You could simply change the data, but that would add
little value to the test suite. Instead, take this opportunity to cover another
requirement of “get product details” operation: it should return the details of
the product that matches the “slug” parameter passed in the arguments.</p>

<p>The next step is bigger than is usual in an incremental TDD workflow. You need
to connect to the database and define classes to work with the data.</p>

<h3 id="define-product-model-repository-and-data-source">Define Product model, repository, and data source</h3>

<p>LoopBack is agnostic when it comes to accessing databases. You can choose any
package from the npm module ecosystem. On the other hand, we also want LoopBack
users to have a recommended solution that’s covered by technical support.
Welcome to <code class="language-plaintext highlighter-rouge">@loopback/repository</code>, a TypeScript facade for the
<code class="language-plaintext highlighter-rouge">loopback-datasource-juggler</code> implementation in LoopBack 3.x.</p>

<ol>
  <li>
    <p>Define <code class="language-plaintext highlighter-rouge">Product</code> model in <code class="language-plaintext highlighter-rouge">src/models/product.model.ts</code></p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Entity</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">property</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/repository</span><span class="dl">'</span><span class="p">;</span>

<span class="p">@</span><span class="nd">model</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">Product</span> <span class="kd">extends</span> <span class="nx">Entity</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">property</span><span class="p">({</span>
    <span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">The unique identifier for a product</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">id</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">property</span><span class="p">({</span><span class="na">required</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
  <span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">property</span><span class="p">({</span><span class="na">required</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
  <span class="nx">slug</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">property</span><span class="p">({</span><span class="na">required</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>
  <span class="nx">price</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>

  <span class="c1">// Add the remaining properties yourself:</span>
  <span class="c1">// description, available, category, label, endData</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p><strong>TODO(bajtos) Find out how to re-use ProductBaseSchema for the model
definition</strong></p>
  </li>
  <li>
    <p>Define a data source representing a single source of data, typically a
database. This example uses in-memory storage. In real applications, replace
the <code class="language-plaintext highlighter-rouge">memory</code> connector with the actual database connector (<code class="language-plaintext highlighter-rouge">postgresql</code>,
<code class="language-plaintext highlighter-rouge">mongodb</code>, etc.).</p>

    <p>Create <code class="language-plaintext highlighter-rouge">src/datasources/db.datasource.ts</code> with the following content:</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">juggler</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/repository</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">juggler</span><span class="p">.</span><span class="nx">DataSource</span><span class="p">({</span>
  <span class="na">connector</span><span class="p">:</span> <span class="dl">'</span><span class="s1">memory</span><span class="dl">'</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Define <code class="language-plaintext highlighter-rouge">ProductRepository</code> in <code class="language-plaintext highlighter-rouge">src/repositories/product.repository.ts</code></p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">DefaultCrudRepository</span><span class="p">,</span> <span class="nx">DataSourceType</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/repository</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Product</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../models/product.model</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">db</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../datasources/db.datasource</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductRepository</span> <span class="kd">extends</span> <span class="nx">DefaultCrudRepository</span><span class="o">&lt;</span>
  <span class="nx">Product</span><span class="p">,</span>
  <span class="k">typeof</span> <span class="nx">Product</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">id</span>
<span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">Product</span><span class="p">,</span> <span class="nx">db</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>See <a href="/doc/en/lb4/Repository.html">Repositories</a> for more details on this topic.</p>

<h3 id="update-test-helpers-and-the-controller-use-real-model-and-repository">Update test helpers and the controller use real model and repository</h3>

<p>Rework <code class="language-plaintext highlighter-rouge">givenEmptyDatabase</code> and <code class="language-plaintext highlighter-rouge">givenProduct</code> as follows:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">givenEmptyDatabase</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">await</span> <span class="k">new</span> <span class="nx">ProductRepository</span><span class="p">().</span><span class="nx">deleteAll</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">givenProduct</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="nb">Partial</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">ProductRepository</span><span class="p">().</span><span class="nx">create</span><span class="p">(</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">a-product-name</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">a-product-slug</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">price</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="dl">'</span><span class="s1">a-product-description</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">available</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">},</span>
      <span class="nx">data</span><span class="p">,</span>
    <span class="p">),</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Notice that <code class="language-plaintext highlighter-rouge">givenProduct</code> is filling in required properties with sensible
defaults. This is allow tests to provide only a small subset of properties that
are strictly required by the tested scenario. This is important for multiple
reasons:</p>

<ol>
  <li>
    <p>It makes tests easier to understand, because it’s immediately clear what
model properties are relevant to the test. If the test was setting all
required properties, it would be difficult to tell whether some of those
properties may be actually relevant to the tested scenario.</p>
  </li>
  <li>
    <p>It makes tests easier to maintain. As the data model evolves, you will
eventually need to add more required properties. If the tests were building
product instances manually, you would have to fix all tests to set the new
required property. With a shared helper, there is only a single place where
to add a value for the new required property.</p>
  </li>
</ol>

<p>You can learn more about test data builders in
<a href="/doc/en/lb4/Testing-your-application.html#use-test-data-builders">Use test data builders</a>
section of <a href="/doc/en/lb4/Testing-your-application.html">Testing your application</a>.</p>

<p>Now that the tests are setting up the test data correctly, it’s time to rework
<code class="language-plaintext highlighter-rouge">ProductController</code> to make the tests pass again.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">ProductRepository</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../repositories/product.repository</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">Product</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../models/product.model</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductController</span> <span class="p">{</span>
  <span class="nl">repository</span><span class="p">:</span> <span class="nx">ProductRepository</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductRepository</span><span class="p">();</span>

  <span class="k">async</span> <span class="nx">getDetails</span><span class="p">(</span><span class="nx">slug</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">found</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="na">where</span><span class="p">:</span> <span class="p">{</span><span class="nx">slug</span><span class="p">}});</span>
    <span class="c1">// TODO: handle "not found" case</span>
    <span class="k">return</span> <span class="nx">found</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="run-tests">Run tests</h3>

<p>Run the tests again. These results may surprise you:</p>

<ol>
  <li>
    <p>The acceptance test is failing: the response contains some expected
properties (slug, name), but is missing most of other properties.</p>
  </li>
  <li>
    <p>The API smoke test is failing with a cryptic error.</p>
  </li>
  <li>
    <p>The unit test is passing, despite the fact that it’s not setting up any data
at all!</p>
  </li>
</ol>

<p>Examine the acceptance test first. A quick review of the source code should tell
us what’s the problem - the test is relying on <code class="language-plaintext highlighter-rouge">givenEmptyDatabase</code> and
<code class="language-plaintext highlighter-rouge">givenProduct</code> helpers, but these helpers are not fully implemented yet. Fix
that by reusing the helpers from the integration test: Move the helpers to
<code class="language-plaintext highlighter-rouge">src/__tests__/helpers/database.helpers.ts</code> and update both the acceptance and
the integration tests to import the helpers from there.</p>

<p>To find out why the API smoke test is failing, you can start the application via
<code class="language-plaintext highlighter-rouge">node .</code> and request the tested endpoint for example using <code class="language-plaintext highlighter-rouge">curl</code>. You will see
that the server responds with 200 OK and an empty response body. This is because
<code class="language-plaintext highlighter-rouge">getDetails</code> returns <code class="language-plaintext highlighter-rouge">undefined</code> when no product matching the slug was found.
This can be fixed by adding a <code class="language-plaintext highlighter-rouge">before</code> hook to the smoke test. The hook should
populate the database with the test data assumed by the examples in the Swagger
specification by leveraging existing helpers <code class="language-plaintext highlighter-rouge">givenEmptyDatabase</code> and
<code class="language-plaintext highlighter-rouge">givenProduct</code>.</p>

<p>Now back to the first unit test. It may be a puzzle to figure out why the test
is passing, although the answer is simple: the integration and acceptance tests
are setting up data in the database, the unit test does not clear the database
(because it should not use it at all!) and accidentally happen to expect the
same data as one of the other tests.</p>

<h3 id="decouple-controller-from-repository">Decouple Controller from Repository</h3>

<p>This shows us a flaw in the current design of the <code class="language-plaintext highlighter-rouge">ProductController</code> - it’s
difficult to test it in isolation. Fix that by making the dependency on
<code class="language-plaintext highlighter-rouge">ModelRepository</code> explicit and allow controller users to provide a custom
implementation.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">ProductController</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">public</span> <span class="nx">repository</span><span class="p">:</span> <span class="nx">ProductRepository</span><span class="p">)</span> <span class="p">{}</span>

  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="alert alert-success" role="alert">
  <p><i class="fa fa-check-square-o"></i>
  <b>Tip:</b> If you wanted to follow pure test-driven
development, then you would define a minimal repository interface describing
only the methods actually used by the controller. This will allow you to
discover the best repository API that serves the need of the controller.
However, you don’t want to design a new repository API, you want to re-use the
repository implementation provided by LoopBack. Therefore using the actual
Repository class/interface is the right approach.</p>

</div>

<p>In traditional object-oriented languages like Java or C#, in order to allow the
unit tests to provide a custom implementation of the repository API, the
controller needs to depend on an interface describing the API, and the
repository implementation needs to implement this interface. The situation is
easier in JavaScript and TypeScript. Thanks to the dynamic nature of the
language, it’s possible to mock/stub entire classes. The
<a href="http://sinonjs.org/">sinon</a> testing module, which comes bundled in
<code class="language-plaintext highlighter-rouge">@loopback/testlab</code>, makes this very easy.</p>

<p>Here is the updated unit test leveraging dependency injection:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">ProductController</span><span class="p">,</span> <span class="nx">ProductRepository</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../..</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">expect</span><span class="p">,</span> <span class="nx">sinon</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/testlab</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">ProductController</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="na">repository</span><span class="p">:</span> <span class="nx">ProductRepository</span><span class="p">;</span>
  <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">givenStubbedRepository</span><span class="p">);</span>

  <span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">getDetails()</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">retrieves details of a product</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductController</span><span class="p">(</span><span class="nx">repository</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">findStub</span> <span class="o">=</span> <span class="nx">repository</span><span class="p">.</span><span class="nx">find</span> <span class="k">as</span> <span class="nx">sinon</span><span class="p">.</span><span class="nx">SinonStub</span><span class="p">;</span>
      <span class="nx">findStub</span><span class="p">.</span><span class="nx">resolves</span><span class="p">([</span>
        <span class="p">{</span>
          <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Ink Pen</span><span class="dl">'</span><span class="p">,</span>
          <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">},</span>
      <span class="p">]);</span>

      <span class="kd">const</span> <span class="nx">details</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">controller</span><span class="p">.</span><span class="nx">getDetails</span><span class="p">(</span><span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">);</span>

      <span class="nx">expect</span><span class="p">(</span><span class="nx">details</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">containDeep</span><span class="p">({</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Ink Pen</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">});</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">findStub</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">calledWithMatch</span><span class="p">({</span><span class="na">where</span><span class="p">:</span> <span class="p">{</span><span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ink-pen</span><span class="dl">'</span><span class="p">}});</span>
    <span class="p">});</span>
  <span class="p">});</span>

  <span class="kd">function</span> <span class="nx">givenStubbedRepository</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">repository</span> <span class="o">=</span> <span class="nx">sinon</span><span class="p">.</span><span class="nx">createStubInstance</span><span class="p">(</span><span class="nx">ProductRepository</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>The new unit test is passing now, but the integration and acceptance tests are
broken again!</p>

<ol>
  <li>
    <p>Fix the integration test by changing how the controller is created - inject
<code class="language-plaintext highlighter-rouge">new ProductRepository()</code> into the repository argument.</p>
  </li>
  <li>
    <p>Fix the acceptance test by annotating <code class="language-plaintext highlighter-rouge">ProductController</code>’s <code class="language-plaintext highlighter-rouge">repository</code>
argument with <code class="language-plaintext highlighter-rouge">@inject('repositories.Product')</code> and binding the
<code class="language-plaintext highlighter-rouge">ProductRepository</code> in the main application file where you are also binding
controllers.</p>
  </li>
</ol>

<p>Learn more about this topic in
<a href="/doc/en/lb4/Testing-your-application.html#unit-test-your-controllers">Unit-test your Controllers</a>
and <a href="/doc/en/lb4/Testing-your-application.html#use-test-doubles">Use test doubles</a> from
<a href="/doc/en/lb4/Testing-your-application.html">Testing your application</a>.</p>

<h3 id="handle-product-not-found-error">Handle ‘product not found’ error</h3>

<p>When you wrote the first implementation of <code class="language-plaintext highlighter-rouge">getDetails</code>, you assumed the slug
always refer to an existing product, which obviously is not always true. Fix the
controller to correctly handle this error situation.</p>

<p>Start with a failing unit test:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">returns 404 Not Found for unknown slug</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductController</span><span class="p">(</span><span class="nx">repository</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">findStub</span> <span class="o">=</span> <span class="nx">repository</span><span class="p">.</span><span class="nx">find</span> <span class="k">as</span> <span class="nx">sinon</span><span class="p">.</span><span class="nx">SinonStub</span><span class="p">;</span>
  <span class="nx">findStub</span><span class="p">.</span><span class="nx">resolves</span><span class="p">([]);</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">controller</span><span class="p">.</span><span class="nx">getDetails</span><span class="p">(</span><span class="dl">'</span><span class="s1">unknown-slug</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">getDetails should have thrown and error</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">err</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">have</span><span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">'</span><span class="s1">statusCode</span><span class="dl">'</span><span class="p">,</span> <span class="mi">404</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/not found/i</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Then fix <code class="language-plaintext highlighter-rouge">getDetails</code> implementation:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">HttpErrors</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/rest</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">ProductController</span> <span class="p">{</span>
  <span class="c1">// ...</span>

  <span class="k">async</span> <span class="nx">getDetails</span><span class="p">(</span><span class="nx">slug</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Product</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">found</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="na">where</span><span class="p">:</span> <span class="p">{</span><span class="nx">slug</span><span class="p">}});</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">found</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">HttpErrors</span><span class="p">.</span><span class="nx">NotFound</span><span class="p">(</span><span class="s2">`Slug not found: </span><span class="p">${</span><span class="nx">slug</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">found</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>More information on <code class="language-plaintext highlighter-rouge">HttpErrors</code> can be found in
<a href="/doc/en/lb4/Controller.html#handling-errors-in-controllers">Controllers</a></p>

<h3 id="implement-a-custom-sequence">Implement a custom Sequence</h3>

<p>LoopBack 3.x is using Express middleware to customize the sequence of actions
executed to handle an incoming request: body-parser middleware is converting the
request body from JSON to a JavaScript object, strong-error-handler is creating
an error response when the request failed.</p>

<p>Express middleware has several shortcomings:</p>

<ul>
  <li>It’s based on callback flow control and does not support async functions
returning Promises.</li>
  <li>The order in which middleware needs to be registered can be confusing, for
example request logging middleware must be registered as the first one,
despite the fact that the log is written only at the end, once the response
has been sent.</li>
  <li>The invocation of middleware handlers is controlled by the framework,
application developers have very little choices.</li>
</ul>

<p>LoopBack 4, abandons Express/Koa-like middleware for a different approach that
puts the application developer in the front seat. See <a href="/doc/en/lb4/Sequence.html">Sequence</a>
documentation to learn more about this concept.</p>

<p>Now you are going to modify request handling in the application to print a line
in the <a href="https://en.wikipedia.org/wiki/Common_Log_Format">Common Log Format</a> for
each request handled.</p>

<p>Start by writing an acceptance test, as described in
<a href="/doc/en/lb4/Testing-your-application.html#test-sequence-customizations">Test sequence customizations</a>
from <a href="/doc/en/lb4/Testing-your-application.html">Testing your application</a>. Create a new test
file (e.g. <code class="language-plaintext highlighter-rouge">sequence.acceptance.ts</code>) and add the following test:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Sequence (acceptance)</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="na">app</span><span class="p">:</span> <span class="nx">HelloWorldApp</span><span class="p">;</span>
  <span class="kd">let</span> <span class="na">request</span><span class="p">:</span> <span class="nx">Client</span><span class="p">;</span>

  <span class="nx">before</span><span class="p">(</span><span class="nx">givenEmptyDatabase</span><span class="p">);</span>
  <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">givenRunningApp</span><span class="p">);</span>

  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">prints a log line for each incoming request</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="na">logs</span><span class="p">:</span> <span class="kr">string</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">app</span><span class="p">.</span><span class="nx">getServer</span><span class="p">(</span><span class="nx">RestServer</span><span class="p">);</span>
    <span class="nx">server</span>
      <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">sequence.actions.commonLog</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">to</span><span class="p">((</span><span class="na">msg</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">logs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">msg</span><span class="p">));</span>

    <span class="kd">const</span> <span class="nx">product</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">givenProduct</span><span class="p">({</span><span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Pen</span><span class="dl">'</span><span class="p">,</span> <span class="na">slug</span><span class="p">:</span> <span class="dl">'</span><span class="s1">pen</span><span class="dl">'</span><span class="p">});</span>
    <span class="k">await</span> <span class="nx">request</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/product/pen</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">logs</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">have</span><span class="p">.</span><span class="nx">length</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">logs</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">to</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span>
      <span class="sr">/^</span><span class="se">(</span><span class="sr">::ffff:</span><span class="se">)?</span><span class="sr">127</span><span class="se">\.</span><span class="sr">0</span><span class="se">\.</span><span class="sr">0</span><span class="se">\.</span><span class="sr">1 - - </span><span class="se">\[[^]</span><span class="sr">+</span><span class="se">\]</span><span class="sr"> "GET </span><span class="se">\/</span><span class="sr">product</span><span class="se">\/</span><span class="sr">pen HTTP</span><span class="se">\/</span><span class="sr">1.1" 200 -$/</span><span class="p">,</span>
    <span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Run the test suite and watch the test fail.</p>

<p>In the next step, copy the default Sequence implementation to a new project file
<code class="language-plaintext highlighter-rouge">src/server/sequence.ts</code>:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">RestSequenceActions</span> <span class="o">=</span> <span class="nx">RestBindings</span><span class="p">.</span><span class="nx">SequenceActions</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">MySequence</span> <span class="k">implements</span> <span class="nx">SequenceHandler</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">RestSequenceActions</span><span class="p">.</span><span class="nx">FIND_ROUTE</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">findRoute</span><span class="p">:</span> <span class="nx">FindRoute</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">RestSequenceActions</span><span class="p">.</span><span class="nx">PARSE_PARAMS</span><span class="p">)</span>
    <span class="k">protected</span> <span class="nx">parseParams</span><span class="p">:</span> <span class="nx">ParseParams</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">RestSequenceActions</span><span class="p">.</span><span class="nx">INVOKE_METHOD</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">invoke</span><span class="p">:</span> <span class="nx">InvokeMethod</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">RestSequenceActions</span><span class="p">.</span><span class="nx">SEND</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">send</span><span class="p">:</span> <span class="nx">Send</span><span class="p">,</span>
    <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">RestSequenceActions</span><span class="p">.</span><span class="nx">REJECT</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">reject</span><span class="p">:</span> <span class="nx">Reject</span><span class="p">,</span>
  <span class="p">)</span> <span class="p">{}</span>

  <span class="k">async</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">RequestContext</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="p">{</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">}</span> <span class="o">=</span> <span class="nx">context</span><span class="p">;</span>
      <span class="kd">const</span> <span class="nx">route</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">findRoute</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">args</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseParams</span><span class="p">(</span><span class="nx">requset</span><span class="p">,</span> <span class="nx">route</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Register your new sequence with your <code class="language-plaintext highlighter-rouge">Server</code>, for example by calling
<code class="language-plaintext highlighter-rouge">server.sequence(MySequence)</code>. Run your tests to verify that everything works
the same way as before and the new acceptance test is still failing.</p>

<p>Now it’s time to customize the default sequence to print a common log line. Edit
the <code class="language-plaintext highlighter-rouge">handle</code> method as follows:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">RequestContext</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">}</span> <span class="o">=</span> <span class="nx">context</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">route</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">findRoute</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">args</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseParams</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">route</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span>
      <span class="nx">request</span><span class="p">.</span><span class="nx">socket</span><span class="p">.</span><span class="nx">remoteAddress</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span>
      <span class="s2">`[</span><span class="p">${</span><span class="nx">strftime</span><span class="p">(</span><span class="dl">'</span><span class="s1">%d/%b/%Y:%H:%M:%S %z</span><span class="dl">'</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">())}</span><span class="s2">]`</span><span class="p">,</span>
      <span class="s2">`"</span><span class="p">${</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">request</span><span class="p">.</span><span class="nx">path</span><span class="p">}</span><span class="s2"> HTTP/</span><span class="p">${</span><span class="nx">request</span><span class="p">.</span><span class="nx">httpVersion</span><span class="p">}</span><span class="s2">"`</span><span class="p">,</span>
      <span class="nx">response</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>To inject the new method <code class="language-plaintext highlighter-rouge">log</code>, add the following line to <code class="language-plaintext highlighter-rouge">MySequence</code>
constructor arguments:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">sequence.actions.log</span><span class="dl">'</span><span class="p">)</span> <span class="k">protected</span> <span class="nx">log</span><span class="p">:</span> <span class="p">(</span><span class="nx">msg</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span>
</code></pre></div></div>

<p>When you run the tests now, you will see that the new acceptance tests for
logging passes, but some of the older acceptance tests started to fail. This is
because <code class="language-plaintext highlighter-rouge">sequence.actions.log</code> is not bound in the application. Fix that by
adding the following line after you’ve retrieved your rest server instance:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// assuming you've called `const server = await app.getServer(RestServer)`</span>
<span class="nx">server</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">sequence.actions.log</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">((</span><span class="nx">msg</span><span class="p">:</span> <span class="nb">String</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg</span><span class="p">));</span>
</code></pre></div></div>

<p>With this last change in place, your test suite should be all green again.</p>

<p>The next task is left as an exercise for the reader: \Modify the <code class="language-plaintext highlighter-rouge">catch</code> block
to print a common log entry too. Start by writing a unit-test that invokes
<code class="language-plaintext highlighter-rouge">MySequence</code> directly.</p>

<div style="font-size: 11pt; border: 1px solid #cccccc; background-color: #EBF5EB; padding: 10px 10px 0 10px; border-radius: 3px; margin: 10px 50px 10px 50px;">
  <p><span style="font-weight: bold;">Next</span>: 
<a href="./Preparing-the-API-for-consumption.md">Preparing the API for consumption</a></p>

</div>



    <div class="tags">
      
    </div>
</div>

<hr class="shaded"/>

<footer id="container">
            <div class="row">
                <div class="col-md-6 footer-left">
               &copy;2021 IBM / StrongLoop. All rights reserved. <br />
 Site last generated: Mar 22, 2021
              </div>
              <div class="col-md-6 footer-right">
                <p><img src="https://loopback.io/images/company_logo.png" alt="Company logo"/></p>
              </div>
            </div>
</footer>


        </div>
        <!-- /.row -->
</div>
<!-- /.container -->
    </div>
</body>

</html>
