<!DOCTYPE html>
<head>
    

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="keywords" content=" LoopBack 4.0, LoopBack 4, Binding">
  <title>Binding | LoopBack Documentation</title>
  <link rel="stylesheet" href="/css/syntax.css">

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/modern-business.css">
    <link rel="stylesheet" href="/css/lavish-bootstrap.css">
    <link rel="stylesheet" href="/css/customstyles.css">
    <link rel="stylesheet" href="/css/theme-v4.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150726441-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150726441-2');
</script>


    <!-- github star button -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>


    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.0/anchor.min.js"></script>
    <script src="/js/toc.js"></script>
    <script src="/js/customscripts.js"></script>

    <link rel="shortcut icon" href="/images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->


    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>

<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand no_icon" href="/doc/index.html">
              <img class="no_icon" style="width:147px;" src="/images/branding/logo/white/loopback.svg">&nbsp;<span class="projectTitle"></span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Docs<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is  -->
                          
                            <li><a href="https://loopback.io/doc/en/lb4/apidocs.index.html" target="_blank">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is  -->
                          
                            <li><a href="http://apidocs.loopback.io" target="_blank">LoopBack 3.x</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">View<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is / -->
                          
                            <li><a href="/">LoopBack Overview</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/en/lb4/ -->
                          
                            <li><a href="/doc/en/lb4/">LoopBack 4</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/en/lb3/ -->
                          
                            <li><a href="/doc/en/lb3/">LoopBack 3.x</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/en/lb2/ -->
                          
                            <li><a href="/doc/en/lb2/">LoopBack 2.x</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/en/community/ -->
                          
                            <li><a href="/doc/en/community/">Community projects</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/en/contrib/ -->
                          
                            <li><a href="/doc/en/contrib/">Contributing to LoopBack</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/en/sec/ -->
                          
                            <li><a href="/doc/en/sec/">Security advisories</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is  -->
                          
                            <li><a href="https://github.com/strongloop/loopback.io" target="_blank">Docs Github Repo</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs-announcements" target="_blank">Announcements Mailing List</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is  -->
                          
                            <li><a href="https://groups.google.com/forum/#!forum/loopbackjs" target="_blank">Developer Forum</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is  -->
                          
                            <li><a href="https://join.slack.com/t/loopbackio/shared_invite/zt-8lbow73r-SKAKz61Vdao~_rGf91pcsw" target="_blank">LoopBack on Slack</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is  -->
                          
                            <li><a href="https://stackoverflow.com/questions/tagged/strongloop+or+loopback4+or+loopbackjs" target="_blank">LoopBack on Stack Overflow</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is  -->
                          
                            <li><a href="https://strongloop.com/strongblog/tag_LoopBack.html" target="_blank">StrongLoop Blog - LoopBack</a></li>
                          
                        
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Translations<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/es/lb2/ -->
                          
                            <li><a href="/doc/es/lb2/">Español (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/es/lb4/ -->
                          
                            <li><a href="/doc/es/lb4/">Español (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/fr/lb2/ -->
                          
                            <li><a href="/doc/fr/lb2/">Français (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/fr/lb4/ -->
                          
                            <li><a href="/doc/fr/lb4/">Français (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/ko/lb2/ -->
                          
                            <li><a href="/doc/ko/lb2/">한국어 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/ko/lb3/ -->
                          
                            <li><a href="/doc/ko/lb3/">한국어 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/pt-br/lb2/ -->
                          
                            <li><a href="/doc/pt-br/lb2/">Português (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/pt-br/lb4/ -->
                          
                            <li><a href="/doc/pt-br/lb4/">Português (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/ja/lb2/ -->
                          
                            <li><a href="/doc/ja/lb2/">日本語 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/ja/lb3/ -->
                          
                            <li><a href="/doc/ja/lb3/">日本語 (v3)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/ja/lb4/ -->
                          
                            <li><a href="/doc/ja/lb4/">日本語 (v4)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/ru/lb2/ -->
                          
                            <li><a href="/doc/ru/lb2/">Pусский (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/zh/lb2/ -->
                          
                            <li><a href="/doc/zh/lb2/">中文 (v2)</a></li>
                          
                        
                        <!-- page.url is /doc/zh/lb4/Binding.html .... folderitem.url is /doc/zh/lb4/ -->
                          
                            <li class="dropdownActive"><a href="/doc/zh/lb4/">中文 (v4)</a></li>
                          
                        
                    </ul>
                </li>
                
                
                
                <li>
                    <form id="search" name="search" class="input-group lb-search" action="/search" method="GET">
                        <input type="text" class="form-control search-bar" placeholder="Search (powered by Watson)" name="q">
                        
                          <input type="hidden" name="sidebar" value="zh_lb4_sidebar">
                        
                        <div class="input-group-btn">
                            <button type="submit" class="btn btn-default" aria-label="search">
                              <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button>
                        </div>
                      </form>
                </li>
            </ul>
        </div>
      </div>
</nav>

<!-- Page Content -->
<div class="container">
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <nav class="col-md-3 sidebar-col">
          











<!-- NOTE: sidebar = site.data.sidebars.mydoc_sidebar.entries -->
<div class="sidebarTitle"><a href="/doc/zh/lb4/index.html">LoopBack 4</a></div>
<ul id="mysidebar" class="nav-list">
  

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/index.html">总览</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Getting-started.html">入门</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Concepts.html">关键功能</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Application.html">应用（Application）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Server.html">服务器（Server）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Controllers.html">控制器（Controllers）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Model.html">数据模型（Models）</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Relations.html">关系（Relations）</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/HasMany-relation.html&title=HasMany（有很多）关系">HasMany（有很多）关系</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/BelongsTo-relation.html&title=BelongsTo（属于）关系">BelongsTo（属于）关系</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/hasOne-relation.html&title=HasOne（有一个）关系">HasOne（有一个）关系</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/DataSources.html">数据源（DataSources）</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Repositories.html&title=存储库（Repositories）">存储库（Repositories）</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Using-database-transactions.html&title=数据库事务（Database Transactions）">数据库事务（Database Transactions）</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Interceptors.html&title=拦截器（Interceptors）">拦截器（Interceptors）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Life-cycle.html&title=生命周期事件（Life cycle events）和观察器（Observers）">生命周期事件（Life cycle events）和观察器（Observers）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Routes.html&title=路由（Routes）">路由（Routes）</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Sequence.html&title=时序（Sequence）">时序（Sequence）</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Routing-requests.html&title=路由请求">路由请求</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Parsing-requests.html&title=解析请求">解析请求</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Decorators.html&title=修饰符（Decorators）">修饰符（Decorators）</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Decorators_openapi.html&title=OpenAPI修饰符">OpenAPI修饰符</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Decorators_inject.html&title=注入依赖（Dependency Injection）修饰符">注入依赖（Dependency Injection）修饰符</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Decorators_authenticate.html&title=认证（Authentication）修饰符">认证（Authentication）修饰符</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Decorators_repository.html&title=存储库（Repository）修饰符">存储库（Repository）修饰符</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Error-handling.html&title=错误处理（Error handling）">错误处理（Error handling）</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Usage-scenarios.html&title=使用场景">使用场景</a>
      
      <ul class="nav-list">
          

  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Create-other-forms-of-apis.html&title=创建其他API表单">创建其他API表单</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/exposing-graphql-apis.html&title=暴露GraphQL API">暴露GraphQL API</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Access-databases.html&title=访问数据库">访问数据库</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Database-migrations.html&title=数据库迁移">数据库迁移</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Calling-other-APIs-and-web-services.html&title=调用其他服务">调用其他服务</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Integrate-with-infrastructures.html&title=集成基础服务">集成基础服务</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Loopback-component-authentication.html&title=认证（Authentication）">认证（Authentication）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Loopback-component-authorization.html&title=授权（Authorization）">授权（Authorization）</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Deployment.html&title=部署（Deployment）">部署（Deployment）</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Deploying-to-IBM-Cloud.html&title=部署到IBM Cloud">部署到IBM Cloud</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/deploying_to_ibm_cloud_kubernetes.html&title=部署到IBM Cloud上的Kubernetes">部署到IBM Cloud上的Kubernetes</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/deploying-with-pm2-and-nginx.html&title=使用pm2和nginx部署">使用pm2和nginx部署</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Serving-static-files.html&title=提供静态文件">提供静态文件</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Behind-the-scene.html&title=场景后台">场景后台</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Context.html&title=上下文（Context）">上下文（Context）</a>
      
  </li>
  


  
  <li class=" leaf-node  active">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Binding.html">绑定（Binding）</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Dependency-injection.html&title=依赖注入（Dependency Injection）">依赖注入（Dependency Injection）</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Reserved-binding-keys.html&title=保留绑定键">保留绑定键</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Components.html&title=组件（Components）">组件（Components）</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Booting-an-Application.html&title=启动应用">启动应用</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Using-components.html&title=使用组件（Components）">使用组件（Components）</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Self-hosted-rest-api-explorer.html&title=自托管的REST API Explorer">自托管的REST API Explorer</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Loopback-component-authentication.html&title=认证（Authentication）">认证（Authentication）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Loopback-component-authorization.html&title=授权（Authorization）">授权（Authorization）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Boot-and-Mount-a-LoopBack-3-application.html&title=启动和挂载LoopBack 3应用">启动和挂载LoopBack 3应用</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Extending-LoopBack-4.html&title=扩展LoopBack 4">扩展LoopBack 4</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Creating-components.html&title=创建组件（Components）">创建组件（Components）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Creating-decorators.html&title=创建修饰符（Decorators）">创建修饰符（Decorators）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Creating-servers.html&title=创建服务器（Servers）">创建服务器（Servers）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Extension-point-and-extensions.html&title=扩展点（Extension point）和扩展(Extensions）">扩展点（Extension point）和扩展(Extensions）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Extending-request-body-parsing.html&title=扩展请求体分析（request body parsing）">扩展请求体分析（request body parsing）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Extension-life-cycle.html&title=扩展的生命周期">扩展的生命周期</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Testing-your-extension.html&title=测试你的扩展">测试你的扩展</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Crafting-LoopBack-4.html&title=LoopBack 4的创意">LoopBack 4的创意</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/Tutorials.html">教程</a>
      
      <ul class="nav-list">
          

  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/todo-tutorial.html">Todo教程</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/todo-tutorial-scaffolding.html">创建你的应用脚手架</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/todo-tutorial-model.html">添加Todo模型</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/todo-tutorial-datasource.html">添加一个数据源（Datasource）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/todo-tutorial-repository.html">添加一个存储库（Repository）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="/doc/zh/lb4/todo-tutorial-controller.html">添加一个控制器（Controller）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/todo-tutorial-putting-it-together.html&title=把它们放在一起">把它们放在一起</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/todo-tutorial-geocoding-service.html&title=额外：集成地理编码（geo-coding）服务">额外：集成地理编码（geo-coding）服务</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/todo-list-tutorial.html&title=TodoList教程">TodoList教程</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/todo-list-tutorial-model.html&title=添加TodoList模型（Model）">添加TodoList模型（Model）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/todo-list-tutorial-repository.html&title=添加TodoList存储库（Repository）">添加TodoList存储库（Repository）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/todo-list-tutorial-controller.html&title=添加TodoList控制器（Controller）">添加TodoList控制器（Controller）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/todo-list-tutorial-sqldb.html&title=在关系型数据库（Relational Database）上运行">在关系型数据库（Relational Database）上运行</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/soap-calculator-tutorial.html&title=SOAP Web Service教程">SOAP Web Service教程</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/soap-calculator-tutorial-web-service-overview.html&title=SOAP Web Service总览">SOAP Web Service总览</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/soap-calculator-tutorial-scaffolding.html&title=应用脚手架">应用脚手架</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/soap-calculator-tutorial-add-datasource.html&title=添加一个数据源（Datasource）">添加一个数据源（Datasource）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/soap-calculator-tutorial-add-service.html&title=添加一个服务（Service）">添加一个服务（Service）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/soap-calculator-tutorial-add-controller.html&title=添加一个控制器（Controller）">添加一个控制器（Controller）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/soap-calculator-tutorial-run-and-test.html&title=运行和测试">运行和测试</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/express-with-lb4-rest-tutorial.html&title=使用LoopBack REST API建立一个Express Application">使用LoopBack REST API建立一个Express Application</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Authentication-Tutorial.html&title=如何使用JWT认证（Authentication）确保你的LoopBack 4应用的安全性">如何使用JWT认证（Authentication）确保你的LoopBack 4应用的安全性</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Examples.html&title=示例代码">示例代码</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Command-line-interface.html&title=CLI参考">CLI参考</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Application-generator.html&title=应用（Application）生成器">应用（Application）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Controller-generator.html&title=控制器（Controller）生成器">控制器（Controller）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/DataSource-generator.html&title=数据源（DataSource）生成器">数据源（DataSource）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Model-generator.html&title=模型（Model）生成器">模型（Model）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Discovering-models.html&title=数据库优先的模型生成/模型发现（Model discovery）">数据库优先的模型生成/模型发现（Model discovery）</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Relation-generator.html&title=关系（Relation）生成器">关系（Relation）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Repository-generator.html&title=存储库（Repository）生成器">存储库（Repository）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Service-generator.html&title=服务（Service）生成器">服务（Service）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/OpenAPI-generator.html&title=OpenAPI生成器">OpenAPI生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Life-cycle-observer-generator.html&title=Life cycle observer（生命周期观察器）生成器">Life cycle observer（生命周期观察器）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Interceptor-generator.html&title=拦截器（Interceptor）生成器">拦截器（Interceptor）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Extension-generator.html&title=扩展（Extension）生成器">扩展（Extension）生成器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Download-examples.html&title=下载示例代码">下载示例代码</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Connectors-reference.html&title=连接器（Connectors）参考">连接器（Connectors）参考</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Memory-connector.html&title=内存（Memory）连接器">内存（Memory）连接器</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Database-connectors.html&title=数据库（Database）连接器">数据库（Database）连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Cassandra-connector.html&title=Cassandra连接器">Cassandra连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Cloudant-connector.html&title=Cloudant连接器">Cloudant连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/DashDB.html&title=DashDB连接器">DashDB连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/DB2-connector.html&title=DB2连接器">DB2连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/DB2-iSeries-connector.html&title=DB2 for iSeries连接器">DB2 for iSeries连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/DB2-for-z-OS.html&title=DB2 for z/OS">DB2 for z/OS</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Informix.html&title=Informix连接器">Informix连接器</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/MongoDB-connector.html&title=MongoDB连接器">MongoDB连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Connecting-to-MongoDB.html&title=MongoDB连接器教程">MongoDB连接器教程</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Using-MongoLab.html&title=使用MongoLab">使用MongoLab</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/MySQL-connector.html&title=MySQL连接器">MySQL连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Connecting-to-MySQL.html&title=MySQL连接器教程">MySQL连接器教程</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Oracle-connector.html&title=Oracle连接器">Oracle连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Installing-the-Oracle-connector.html&title=安装Oracle连接器">安装Oracle连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Connecting-to-Oracle.html&title=Oracle连接器教程">Oracle连接器教程</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/PostgreSQL-connector.html&title=PostgreSQL连接器">PostgreSQL连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Connecting-to-PostgreSQL.html&title=PostgreSQL连接器教程">PostgreSQL连接器教程</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Redis-connector.html&title=Redis连接器">Redis连接器</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/kv-redis-connector.html&title=Redis键值对（key-value）连接器">Redis键值对（key-value）连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Example-kv-connector.html&title=键值对连接器示例">键值对连接器示例</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/SQL-Server-connector.html&title=微软SQL Server连接器">微软SQL Server连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Connecting-to-Microsoft-SQL-Server.html&title=微软SQL Server连接器教程">微软SQL Server连接器教程</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/SQLite3.html&title=SQLite3连接器">SQLite3连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/zOSconnectEE.html&title=z/OS企业版连接器">z/OS企业版连接器</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Other-connectors.html&title=其他连接器">其他连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Email-connector.html&title=电子邮件（Email）连接器">电子邮件（Email）连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/JSON-RPC-connector.html&title=JSON RPC连接器">JSON RPC连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/MQLight-connector.html&title=MQ Light连接器">MQ Light连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Push-connector.html&title=Push连接器">Push连接器</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Remote-connector.html&title=Remote连接器">Remote连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Remote-connector-example.html&title=Remote连接器教程">Remote连接器教程</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Strong-Remoting.html&title=Strong Remoting">Strong Remoting</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/REST-connector.html&title=REST连接器">REST连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/REST-connector-example.html&title=REST连接器示例">REST连接器示例</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/SOAP-connector.html&title=SOAP连接器">SOAP连接器</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Strong-soap.html&title=Strong-soap">Strong-soap</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/SOAP-Connector-example.html&title=SOAP连接器示例">SOAP连接器示例</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Connecting-to-SOAP.html&title=连接到SOAP web services">连接到SOAP web services</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Storage-connector.html&title=Storage连接器">Storage连接器</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Swagger-connector.html&title=Swagger连接器">Swagger连接器</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Community-connectors.html&title=Community连接器">Community连接器</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/apidocs.index.html&title=API文档">API文档</a>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/LoopBack-3.x.html&title=LoopBack 3.x用户请读">LoopBack 3.x用户请读</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Understanding-the-differences.html&title=理解LoopBack 3和LoopBack 4的不同">理解LoopBack 3和LoopBack 4的不同</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Migrating-from-LoopBack-3.html&title=从LoopBack 3迁移">从LoopBack 3迁移</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Best-practices.html&title=最佳实践">最佳实践</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Defining-the-API-using-code-first-approach.html&title=使用代码优先（code-first）方式定义API">使用代码优先（code-first）方式定义API</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Defining-your-testing-strategy.html&title=定义你的测试策略">定义你的测试策略</a>
      
  </li>
  


  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Testing-your-application.html&title=测试你的应用">测试你的应用</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/code-contrib-lb4.html&title=贡献LoopBack 4">贡献LoopBack 4</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/submitting_a_pr.html&title=提交pull request给LoopBack 4">提交pull request给LoopBack 4</a>
      
  </li>
  



      </ul>
      
  </li>
  


  
  <li class=" tree-parent  ">
     <a class="show-hide" href="#"></span> 
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Reference.html&title=参考">参考</a>
      
      <ul class="nav-list">
          

  
  <li class=" leaf-node  ">
    
    <a class="page-link" rel="nofollow" href="Not-yet-translated.html?url=/doc/zh/lb4/Deploy-for-GDPR-readiness.html&title=考虑GDPR准备情况">考虑GDPR准备情况</a>
      
  </li>
  



      </ul>
      
  </li>
  



</ul>

        </nav>
        <!-- Content Column -->
        <div class="col-md-9">
            
<div class="post-header">
   <h1 class="post-title-main">Binding</h1>
   
     
       <a target="_blank" href="https://github.com/strongloop/loopback.io/blob/gh-pages/pages/zh/lb4/Binding.md" class="githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit this page</a>
   
</div>

<div class="post-content">


  




 
   
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
;$(function() {
  var level = parseInt(3, 10);
  if (level === 1) {level = 'h2'}
  if (level === 2) {level = 'h2,h3'}
  if (level === 3) {level = 'h2,h3,h4'}
  if (level === 4) {level = 'h2,h3,h4,h5'}

  // Add a new level for changelog files which use h1,h2,h3
  if (level === 0) {level = 'h1,h2,h3,h4,h5'}

  var toc = $('#toc')

  toc.toc({minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: level})

  /* this offset helps with the space taken up by the floating toolbar */
  toc.on('click', 'a', function() {
    var target = $(this.getAttribute('href')),
      scroll_target = target.offset().top

    $(window).scrollTop(scroll_target - 10)
    return false
  })
  .on('click', '.toc-expand-button', function() {
    toc.find('> ul').slideToggle('fast');
  })
})
</script>

<div id="toc">
  <span class="toc-title">Page Contents</span>
  <button type="button" class="btn btn-link toc-expand-button">
    <i class="fa fa-bars"></i>
  </button>
</div>

 

    




  <div markdown="span" class="alert alert-success" role="alert"><i class="fa fa-check-square-o"></i> <b>This is a community translation into Chinese</b>. For the latest information, see the <a href="/doc/en/lb4/Binding.html">English version</a>.
  </div>


<h2 id="什么是binding">什么是<code class="language-plaintext highlighter-rouge">Binding</code>?</h2>

<blockquote>
  <p>Binding译为“绑定”，下略。</p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">Binding</code>可以在一个实例化后的<a href="Context.md"><code class="language-plaintext highlighter-rouge">Context（上下文）</code></a>中作为一个或多个对象的代表。一个<code class="language-plaintext highlighter-rouge">Binding</code>使用一个不重复的键作为地址，在<code class="language-plaintext highlighter-rouge">Context</code>中可以通过此地址获取到<code class="language-plaintext highlighter-rouge">Binding</code>所对应的值。</p>

<h3 id="binding的属性"><code class="language-plaintext highlighter-rouge">Binding</code>的属性</h3>

<p>一个<code class="language-plaintext highlighter-rouge">Binding</code>通常拥有以下属性：</p>

<ul>
  <li>key（键）: 在上下文中，每个<code class="language-plaintext highlighter-rouge">Binding</code>都有一个用于标记自己的唯一键；</li>
  <li>scope（范围）: 在上下文中，用来控制如何创建或缓存<code class="language-plaintext highlighter-rouge">Binding</code>的值；</li>
  <li>tags（标签）: 可以是<code class="language-plaintext highlighter-rouge">名称</code>字符串或<code class="language-plaintext highlighter-rouge">名称-值</code>键值对，用来描述或注释一个<code class="language-plaintext highlighter-rouge">Binding</code>；</li>
  <li>value（值）: 每个<code class="language-plaintext highlighter-rouge">Binding</code>必须设置一个可以解析出绑定的值的提供装置（比如，类、方法、常量等），这样<code class="language-plaintext highlighter-rouge">Binding</code>才可以被解析成一个常量或动态值；</li>
</ul>

<p><img src="/pages/zh/lb4/imgs/binding.png" alt="Binding" /></p>

<h2 id="如何创建一个binding">如何创建一个<code class="language-plaintext highlighter-rouge">Binding</code>？</h2>

<p>有几种方式可以创建一个<code class="language-plaintext highlighter-rouge">Binding</code>：</p>

<ul>
  <li>
    <p>使用<code class="language-plaintext highlighter-rouge">Binding</code>类的构造器</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">Binding</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">// 实例化一个上下文</span>
<span class="kd">const</span> <span class="nx">context</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">();</span>
<span class="c1">// 实例化一个绑定，并将其'key'属性设置为'my-key'</span>
<span class="kd">const</span> <span class="nx">binding</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Binding</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-key</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// 将绑定添加至上下文中</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">binding</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>使用<code class="language-plaintext highlighter-rouge">Binding</code>类的<code class="language-plaintext highlighter-rouge">.bind()</code>静态方法</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">Binding</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">// 实例化一个上下文</span>
<span class="kd">const</span> <span class="nx">context</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">();</span>
<span class="c1">// 实例化一个绑定，并将其'key'属性设置为'my-key'</span>
<span class="kd">const</span> <span class="nx">binding</span> <span class="o">=</span> <span class="nx">Binding</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-key</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// 将绑定添加至上下文中</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">binding</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>使用<code class="language-plaintext highlighter-rouge">Context</code>类的<code class="language-plaintext highlighter-rouge">.bind()</code>方法</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">Binding</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">// 实例化一个上下文</span>
<span class="kd">const</span> <span class="nx">context</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">();</span>
<span class="c1">// 在上下文中添加一个绑定，并将其'key'属性设置为'my-key'</span>
<span class="nx">context</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-key</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div>    </div>

    <div class="alert alert-info" role="alert">
      <p><i class="fa fa-info-circle"></i>
<b>Note:</b>
<code class="language-plaintext highlighter-rouge">@loopback/core</code>包会重复导出所有关于<code class="language-plaintext highlighter-rouge">@loopback/context</code>的公共API。为了保持写法上的一致，我们推荐使用<code class="language-plaintext highlighter-rouge">@loopback/core</code>包进行各种对象的引用，除非某个对象需要通过<code class="language-plaintext highlighter-rouge">@loopback/context</code>包显式引用. 下面的2行代码在作用上是相等的：</p>

      <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">inject</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/context</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">inject</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div>      </div>

    </div>
  </li>
</ul>
<p>&lt;/div&gt;</p>

<h2 id="如何设置一个binding">如何设置一个<code class="language-plaintext highlighter-rouge">Binding</code>?</h2>

<p><code class="language-plaintext highlighter-rouge">Binding</code>类通过一套流畅的API提供了有关<code class="language-plaintext highlighter-rouge">Binding</code>的创建和配置的操作。</p>

<h3 id="解析一个binding的值的形式">解析一个<code class="language-plaintext highlighter-rouge">Binding</code>的值的形式</h3>

<p><code class="language-plaintext highlighter-rouge">Binding</code>可以通过多种形式以解析出一个具体的值。具体如下：</p>

<h4 id="常量形式constant">常量形式（Constant）</h4>

<p>适用场景：在解析一个<code class="language-plaintext highlighter-rouge">Binding</code>时，<code class="language-plaintext highlighter-rouge">Binding</code>的值是一个固定的值。<br />
比如，<code class="language-plaintext highlighter-rouge">Binding</code>的值是一个字符串（String）、一个方法（Function）、一个对象（Object）、一个数组（Array）或者任何其他类型的值。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">binding</span><span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-value</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p>请注意，在常量形式下为了避免混淆，值的类型不能是<code class="language-plaintext highlighter-rouge">Promise</code>。</p>

<h4 id="工厂形式factory-function">工厂形式（Factory Function）</h4>

<p>适用场景：在解析一个<code class="language-plaintext highlighter-rouge">Binding</code>时，<code class="language-plaintext highlighter-rouge">Binding</code>的值是需要被动态计算的。<br />
比如，<code class="language-plaintext highlighter-rouge">Binding</code>的值是当前系统时间、<code class="language-plaintext highlighter-rouge">Binding</code>的值是远程接口的返回值、<code class="language-plaintext highlighter-rouge">Binding</code>的值是远程数据库的数据等。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">binding</span><span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="dl">'</span><span class="s1">my-value</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">binding</span><span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
<span class="nx">binding</span><span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-value</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<p>工厂方法可以接收一个涵盖了上下文信息、绑定信息和解析选项信息的参数。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">ValueFactory</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// 现在可以通过工厂方法的第一个传参获取到解析时的相关信息了</span>
<span class="kd">const</span> <span class="nx">factory</span><span class="p">:</span> <span class="nx">ValueFactory</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">resolutionCtx</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">resolutionCtx</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">#</span><span class="p">${</span>
    <span class="nx">resolutionCtx</span><span class="p">.</span><span class="nx">binding</span><span class="p">.</span><span class="nx">key</span>
  <span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">resolutionCtx</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">session</span><span class="p">?.</span><span class="nx">getBindingPath</span><span class="p">()}</span><span class="s2">`</span><span class="p">;</span>
<span class="p">};</span>
<span class="kd">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">msg</span><span class="dl">'</span><span class="p">).</span><span class="nx">toDynamicValue</span><span class="p">(</span><span class="nx">factory</span><span class="p">);</span>
</code></pre></div></div>
<p>通过<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment"> 解构赋值（Destructuring assignment）</a>
可以进一步简化并快速访问到<code class="language-plaintext highlighter-rouge">context</code>、<code class="language-plaintext highlighter-rouge">binding</code>和<code class="language-plaintext highlighter-rouge">options</code>等对象。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">factory</span><span class="p">:</span> <span class="nx">ValueFactory</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">({</span><span class="nx">context</span><span class="p">,</span> <span class="nx">binding</span><span class="p">,</span> <span class="nx">options</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">context</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">#</span><span class="p">${</span>
    <span class="nx">binding</span><span class="p">.</span><span class="nx">key</span>
  <span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">options</span><span class="p">.</span><span class="nx">session</span><span class="p">?.</span><span class="nx">getBindingPath</span><span class="p">()}</span><span class="s2">`</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>进阶用法：使用内置了静态方法<code class="language-plaintext highlighter-rouge">value</code>的类，该静态方法允许参数注入。（具体见<code class="language-plaintext highlighter-rouge">提供器形式（Provider）</code>）</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">inject</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">GreetingProvider</span> <span class="p">{</span>
  <span class="k">static</span> <span class="nx">value</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">)</span> <span class="nx">user</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">user</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">msg</span><span class="dl">'</span><span class="p">).</span><span class="nx">toDynamicValue</span><span class="p">(</span><span class="nx">GreetingProvider</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="类形式class">类形式（Class）</h4>

<p>适用场景：在解析一个<code class="language-plaintext highlighter-rouge">Binding</code>时，<code class="language-plaintext highlighter-rouge">Binding</code>的值是一个类的实例化对象。<br />
比如，控制器（Controller）等。<code class="language-plaintext highlighter-rouge">Binding</code>的值可以是一个被实例化的类。依赖注入通常用于影响被注入依赖的类的内部成员对象身上。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-options</span><span class="dl">'</span><span class="p">)</span> <span class="k">private</span> <span class="nx">options</span><span class="p">:</span> <span class="nx">MyOptions</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">binding</span><span class="p">.</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">MyController</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="提供器形式provider">提供器形式（Provider）</h4>

<p>适用场景：在解析一个<code class="language-plaintext highlighter-rouge">Binding</code>时，用于解析<code class="language-plaintext highlighter-rouge">Binding</code>的值的工厂方法需要用到依赖注入（Dependency Injection）。<br />
提供器指的是，内置了<code class="language-plaintext highlighter-rouge">value()</code>方法的类，该方法可以在实例化后用来解析<code class="language-plaintext highlighter-rouge">Binding</code>的值。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyValueProvider</span> <span class="k">implements</span> <span class="nx">Provider</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-options</span><span class="dl">'</span><span class="p">)</span> <span class="k">private</span> <span class="na">options</span><span class="p">:</span> <span class="nx">MyOptions</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>

  <span class="nx">value</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">defaultValue</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">binding</span><span class="p">.</span><span class="nx">toProvider</span><span class="p">(</span><span class="nx">MyValueProvider</span><span class="p">);</span>
</code></pre></div></div>

<p>提供器被当做一个内置了依赖注入功能的空壳，可以理解为是一个进阶版本的工厂方法。如果工厂方法没有使用到依赖注入，则直接使用普通的工厂方法和<code class="language-plaintext highlighter-rouge">toDynamicValue()</code>方法即可。</p>

<h4 id="同族形式alias">同族形式（Alias）</h4>

<p>适用场景：在解析一个<code class="language-plaintext highlighter-rouge">Binding</code>时，此<code class="language-plaintext highlighter-rouge">Binding</code>的值的来源是另外一个<code class="language-plaintext highlighter-rouge">Binding</code>的值。<br />
同族指的是，一个允许携带可选路径的键值，这个键值可以用来从另外一个<code class="language-plaintext highlighter-rouge">Binding</code>上解析出值。
比如，我们在设置<code class="language-plaintext highlighter-rouge">Api Explorer（API浏览页面）</code>的时候，需要用到<code class="language-plaintext highlighter-rouge">RestServer</code>对象的相关属性，我们可以创建一个<code class="language-plaintext highlighter-rouge">Binding</code>并将它通过<code class="language-plaintext highlighter-rouge">.toAlias()</code>方法设置为<code class="language-plaintext highlighter-rouge">key</code>为<code class="language-plaintext highlighter-rouge">servers.RestServer.options#apiExplorer</code>的<code class="language-plaintext highlighter-rouge">Binding</code>的同族。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 创建`key`为`servers.RestServer.options`的绑定</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">servers.RestServer.options</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">({</span><span class="na">apiExplorer</span><span class="p">:</span> <span class="p">{</span><span class="na">path</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/explorer</span><span class="dl">'</span><span class="p">}});</span>
<span class="c1">// 创建`key`为`apiExplorer.options`的绑定</span>
<span class="nx">ctx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">apiExplorer.options</span><span class="dl">'</span><span class="p">)</span>
<span class="c1">// 声明此绑定是`key`为`servers.RestServer.options`的绑定的同族</span>
  <span class="p">.</span><span class="nx">toAlias</span><span class="p">(</span><span class="dl">'</span><span class="s1">servers.RestServer.options#apiExplorer</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">apiExplorerOptions</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ctx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">apiExplorer.options</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// =&gt; {path: '/explorer'}</span>
</code></pre></div></div>

<h4 id="可注入类形式injectable-class">可注入类形式（Injectable Class）</h4>

<p>可注入类指的是一个被<code class="language-plaintext highlighter-rouge">@injectable</code>装饰的类，其类型可以如下：</p>

<ul>
  <li>一个类（Class）</li>
  <li>一个提供器（Provider）</li>
  <li>一个工厂方法（Factory Function）</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">toInjectable()</code>方法是一种类似于<code class="language-plaintext highlighter-rouge">toClass() / toProvider() / toDynamicValue()</code>等方法的用来绑定值的快捷方法。<code class="language-plaintext highlighter-rouge">@injectable</code>装饰器可以将<code class="language-plaintext highlighter-rouge">Binding</code>的元数据添加到其中。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">injectable</span><span class="p">({</span><span class="na">scope</span><span class="p">:</span> <span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SINGLETON</span><span class="p">})</span>
<span class="kd">class</span> <span class="nx">MyController</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-options</span><span class="dl">'</span><span class="p">)</span> <span class="k">private</span> <span class="nx">options</span><span class="p">:</span> <span class="nx">MyOptions</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ...</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">binding</span><span class="p">.</span><span class="nx">toInjectable</span><span class="p">(</span><span class="nx">MyController</span><span class="p">);</span>
</code></pre></div></div>

<p>如上所示，其代码等价于下面：</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">binding</span> <span class="o">=</span> <span class="nx">createBindingFromClass</span><span class="p">(</span><span class="nx">MyController</span><span class="p">);</span>
</code></pre></div></div>

<div class="alert alert-info" role="alert">
  <p><i class="fa fa-info-circle"></i>
<b>Note:</b></p>

  <p>如果使用了<code class="language-plaintext highlighter-rouge">binding.toClass(MyController)</code>方法，则通过<code class="language-plaintext highlighter-rouge">@injectable</code>装饰器设置的<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Scope</code>是不会生效的。</p>

</div>

<h3 id="配置binding的socpe">配置<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Socpe</code></h3>

<blockquote>
  <p>Socpe译为“作用域”，下略。</p>
</blockquote>

<p>一个<code class="language-plaintext highlighter-rouge">Binding</code>可以为多个请求提供解析值，通过<code class="language-plaintext highlighter-rouge">Binding</code>所在的<code class="language-plaintext highlighter-rouge">Context</code>对象的<code class="language-plaintext highlighter-rouge">.get()</code>和<code class="language-plaintext highlighter-rouge">.getSync()</code>方法，或者依赖注入。
在解析<code class="language-plaintext highlighter-rouge">Binding</code>的值时，<code class="language-plaintext highlighter-rouge">Scope</code>用来控制解析过程的策略。即可以返回一个新的值，或为从属于同一层级的<code class="language-plaintext highlighter-rouge">Context</code>的多个请求返回一个相同的值。<br />
如下示例中，虽然<code class="language-plaintext highlighter-rouge">Binding</code>都是<code class="language-plaintext highlighter-rouge">"my-key"</code>，但是<code class="language-plaintext highlighter-rouge">value1</code>变量和<code class="language-plaintext highlighter-rouge">value2</code>变量的值可能是相同的或不同的，这都取决于<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Scope</code>是如何设置的。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">value1</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ctx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-key</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">value2</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-key</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p>在相同的<code class="language-plaintext highlighter-rouge">Context</code>中解析一个<code class="language-plaintext highlighter-rouge">Binding</code>时，我们允许使用如下的<code class="language-plaintext highlighter-rouge">Scope</code>：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.TRANSIENT</code>（临时作用域，此项为默认值）</li>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.CONTEXT</code>（同级作用域）（已弃用）</li>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.SINGLETON</code>（常态作用域）</li>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.APPLICATION</code>（应用程序作用域）</li>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.SERVER</code>（服务作用域）</li>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.REQUEST</code>（请求作用域）</li>
</ul>

<p>请参见<a href="https://loopback.io/doc/en/lb4/apidocs.context.bindingscope.html">BindingScope</a>.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">binding</span><span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SINGLETON</span><span class="p">);</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Scope</code>可以通过<code class="language-plaintext highlighter-rouge">BindingScope</code>枚举引用到。</p>

<h3 id="配置正确的scope">配置正确的<code class="language-plaintext highlighter-rouge">Scope</code></h3>

<p>在配置<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Scope</code>时，请先思考如下问题：</p>

<ol>
  <li>在解析<code class="language-plaintext highlighter-rouge">Binding</code>的值时，是否有必要为每个请求都返回一个新的值？</li>
  <li>在解析<code class="language-plaintext highlighter-rouge">Binding</code>的值时，是否解析值会得到保留，或是因请求不同而变化？</li>
</ol>

<p>请注意，使用了<code class="language-plaintext highlighter-rouge">Binding</code>类<code class="language-plaintext highlighter-rouge">.to()</code>方法的<code class="language-plaintext highlighter-rouge">Binding</code>的值不会受到<code class="language-plaintext highlighter-rouge">Scope</code>的影响，如下所示：</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ctx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">my-name</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">John Smith</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">key</code>属性为<code class="language-plaintext highlighter-rouge">'my-name'</code>的<code class="language-plaintext highlighter-rouge">Binding</code>的值将被永远解析为<code class="language-plaintext highlighter-rouge">'John Smith'</code>。</p>

<p><code class="language-plaintext highlighter-rouge">Scope</code>只会影响到使用<code class="language-plaintext highlighter-rouge">.toDynamicValue()</code>、<code class="language-plaintext highlighter-rouge">.toClass()</code>和<code class="language-plaintext highlighter-rouge">.toProvider()</code>方法提供解析值的<code class="language-plaintext highlighter-rouge">Binding</code>。</p>

<p>假设我们需要满足一个需求：需要创建一个可以提供当前系统日期的<code class="language-plaintext highlighter-rouge">Binding</code>。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ctx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">current-date</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">());</span>
<span class="kd">const</span> <span class="nx">d1</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">current-date</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">d2</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">current-date</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// d1 !== d2</span>
</code></pre></div></div>

<p>在上面的代码中，<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Scope</code>的默认值为<code class="language-plaintext highlighter-rouge">TRANSIENT</code>，即临时作用域。
<code class="language-plaintext highlighter-rouge">d1</code>和<code class="language-plaintext highlighter-rouge">d2</code>的值都是来源于<code class="language-plaintext highlighter-rouge">new Date()</code>方法，并且都是通过<code class="language-plaintext highlighter-rouge">ctx.getSync('current-date')</code>方法解析出来的。两个不同的日期被分配到了<code class="language-plaintext highlighter-rouge">d1</code>和<code class="language-plaintext highlighter-rouge">d2</code>的值上，相当于每次解析<code class="language-plaintext highlighter-rouge">Binding</code>的值时，值都会成为解析时的系统日期。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ctx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">current-date</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">())</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SINGLETON</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">d1</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getSync</span><span class="o">&lt;</span><span class="nb">Date</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">current-date</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">d2</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getSync</span><span class="o">&lt;</span><span class="nb">Date</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">current-date</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// d1 === d2</span>
</code></pre></div></div>

<p>在上面的代码中，<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Scope</code>的值被设置为<code class="language-plaintext highlighter-rouge">SINGLETON</code>，即常态作用域。自然就可以推理出<code class="language-plaintext highlighter-rouge">d1</code>和<code class="language-plaintext highlighter-rouge">d2</code>的值都是相同的日期，也就是不符合我们的需求。</p>

<p>下面是<code class="language-plaintext highlighter-rouge">Scope</code>为<code class="language-plaintext highlighter-rouge">SINGLETON</code>的适用场景：</p>

<ol>
  <li>
    <p>共享单个实例的状态</p>

    <p>通过<code class="language-plaintext highlighter-rouge">Binding</code>在多个使用者之间分享同一个实例的状态。</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 声明一个全局计数器</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">GlobalCounter</span> <span class="p">{</span>
  <span class="k">public</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 将全局计数器绑定至上下文中</span>
<span class="nx">ctx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">global-counter</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">GlobalCounter</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SINGLETON</span><span class="p">);</span>
    
<span class="kd">const</span> <span class="nx">c1</span><span class="p">:</span> <span class="nx">GlobalCounter</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ctx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">global-counter</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">c1</span><span class="p">.</span><span class="nx">count</span><span class="o">++</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">c1</span><span class="p">.</span><span class="nx">count</span><span class="p">);</span> <span class="c1">// `c1.count`的值是`1`</span>

<span class="kd">const</span> <span class="nx">c2</span><span class="p">:</span> <span class="nx">GlobalCounter</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ctx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">global-counter</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">c2</span><span class="p">.</span><span class="nx">count</span><span class="p">);</span> <span class="c1">// `c2.count`的值还是`1`</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>共享单个实例的本体</p>

    <p>若单个实例可以被共享，则避免创建多个实例。因为使用者无须保持或访问不同的实例的状态。比如，下面的<code class="language-plaintext highlighter-rouge">GreetingController</code>类中，除了方法参数外，没有访问任何信息。通过一个<code class="language-plaintext highlighter-rouge">GreetingController</code>类的共享实例，可以重复调用其<code class="language-plaintext highlighter-rouge">greet()</code>方法，但是传参却可以是不同的（调用形式相当于<code class="language-plaintext highlighter-rouge">c1.greet('John')</code>或<code class="language-plaintext highlighter-rouge">c1.greet('Jane')</code>）。</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 标记此类的`Scope`为`SINGLETON`</span>
<span class="p">@</span><span class="nd">bind</span><span class="p">({</span><span class="na">scope</span><span class="p">:</span> <span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SINGLETON</span><span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">GreetingController</span> <span class="p">{</span>
  <span class="nx">greet</span><span class="p">(</span><span class="nx">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>类似于<code class="language-plaintext highlighter-rouge">GreetingController</code>类的控制器是使用<code class="language-plaintext highlighter-rouge">SINGLETON</code>的理想场景。因此在应用程序的上下文中，只有一个控制器的实例被创建，但是却可以分享给所有的请求。通过将<code class="language-plaintext highlighter-rouge">Scope</code>的值设置为<code class="language-plaintext highlighter-rouge">SINGLETON</code>，可以有效避免为每个请求重复创建<code class="language-plaintext highlighter-rouge">GreetingController</code>类的实例。</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// `createBindingFromClass()`方法听从`@bind`装饰器的配置，并将绑定的`Scope`设置为`SINGLETON`</span>
<span class="kd">const</span> <span class="nx">binding</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">createBindingFromClass</span><span class="p">(</span><span class="nx">GreetingController</span><span class="p">));</span>
<span class="kd">const</span> <span class="nx">c1</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getSync</span><span class="p">(</span><span class="nx">binding</span><span class="p">.</span><span class="nx">key</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">c2</span> <span class="o">=</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">getSync</span><span class="p">(</span><span class="nx">binding</span><span class="p">.</span><span class="nx">key</span><span class="p">);</span>
<span class="c1">// c2和c1是同一个实例</span>
<span class="nx">c1</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="dl">'</span><span class="s1">John</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 调用后得到'Hello, John'</span>
<span class="nx">c2</span><span class="p">.</span><span class="nx">greet</span><span class="p">(</span><span class="dl">'</span><span class="s1">Jane</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 调用后得到'Hello, Jane'</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>选择<code class="language-plaintext highlighter-rouge">TRANSIENT</code>：如果您不知道应该如何选择，则将其视为一个安全的默认值。<br />
选择<code class="language-plaintext highlighter-rouge">SINGLETON</code>：如果您想为每个消费者不间断地提供一个相同的实例。</p>

<p>下面是一个需要从当前的请求对象中获取信息（用于获取http地址或记录日志等）的代码示例：</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">GreetingCurrentUserController</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">SecurityBindings</span><span class="p">.</span><span class="nx">USER</span><span class="p">)</span>
  <span class="k">private</span> <span class="nx">currentUserProfile</span><span class="p">:</span> <span class="nx">UserProfile</span><span class="p">;</span>

  <span class="nx">greet</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">currentUserProfile</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>如上所示，<code class="language-plaintext highlighter-rouge">GreetingCurrentUserController</code>内部的<code class="language-plaintext highlighter-rouge">greet()</code>方法的返回值取决于被注入的<code class="language-plaintext highlighter-rouge">currentUserProfile</code>属性对象。</p>

<p>因此在上面的例子中，我们需要将<code class="language-plaintext highlighter-rouge">Scope</code>设置为<code class="language-plaintext highlighter-rouge">TRANSIENT</code>。每次请求发生时，当前请求的用户信息<code class="language-plaintext highlighter-rouge">UserProfile</code>通过属性注入方式赋值于<code class="language-plaintext highlighter-rouge">GreetingCurrentUserController</code>的实例化对象的<code class="language-plaintext highlighter-rouge">currentUserProfile</code>属性之中。如果错误地将<code class="language-plaintext highlighter-rouge">Scope</code>设置为<code class="language-plaintext highlighter-rouge">SINGLETON</code>，则不同的请求发生时，用户信息可能是一样的。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">SingletonGreetingCurrentUserController</span> <span class="p">{</span>
  <span class="nx">greet</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="nx">SecurityBindings</span><span class="p">.</span><span class="nx">USER</span><span class="p">)</span> <span class="nx">currentUserProfile</span><span class="p">:</span> <span class="nx">UserProfile</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">`Hello, </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">currentUserProfile</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>如上所示，<code class="language-plaintext highlighter-rouge">SingletonGreetingCurrentUserController</code>内部的<code class="language-plaintext highlighter-rouge">currentUserProfile</code>属性对象被删除了，取而代之的是<code class="language-plaintext highlighter-rouge">greet()</code>方法中的<code class="language-plaintext highlighter-rouge">@inject(SecurityBindings.USER) currentUserProfile: UserProfile</code>方法注入。</p>

<p>因此在上面的例子中，我们需要将<code class="language-plaintext highlighter-rouge">Scope</code>设置为<code class="language-plaintext highlighter-rouge">SINGLETON</code>。每次请求发生时，当前请求的用户信息<code class="language-plaintext highlighter-rouge">UserProfile</code>通过方法注入方式赋值于<code class="language-plaintext highlighter-rouge">SingletonGreetingCurrentUserController</code>的实例化对象的<code class="language-plaintext highlighter-rouge">greet()</code>方法的第一个参数<code class="language-plaintext highlighter-rouge">currentUserProfile</code>之中。如果错误地将<code class="language-plaintext highlighter-rouge">Scope</code>设置为<code class="language-plaintext highlighter-rouge">TRANSIENT</code>，则不同的请求发生时，每次都会进行无意义的实例化行为。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ctx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">controllers.SingletonGreetingCurrentUserController</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">SingletonGreetingCurrentUserController</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SINGLETON</span><span class="p">);</span>
</code></pre></div></div>

<p>如上所示，<code class="language-plaintext highlighter-rouge">SingletonGreetingCurrentUserController</code>的实例化对象是由拥有<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Context</code>对象创建的。但是<code class="language-plaintext highlighter-rouge">SingletonGreetingCurrentUserController</code>的<code class="language-plaintext highlighter-rouge">greet()</code>方法仍然可以被携带了当前请求的用户信息的请求级别<code class="language-plaintext highlighter-rouge">Context</code>对象所调用。方法注入正是由不同的请求级别<code class="language-plaintext highlighter-rouge">Context</code>对象所实现的，不同于其他的<code class="language-plaintext highlighter-rouge">Context</code>对象（比如<code class="language-plaintext highlighter-rouge">application</code>的<code class="language-plaintext highlighter-rouge">Context</code>对象，仅用于将类实例化为单例）。</p>

<div class="alert alert-info" role="alert">
  <p><i class="fa fa-info-circle"></i>
<b>Note:</b></p>

  <p>为了理解 <code class="language-plaintext highlighter-rouge">@bind()</code> 和 <code class="language-plaintext highlighter-rouge">ctx.bind()</code>之间的区别, 详见
<a href="#configure-binding-attributes-for-a-class">Configure binding attributes for a class</a>.</p>

</div>

<p><code class="language-plaintext highlighter-rouge">SINGLETON</code>、<code class="language-plaintext highlighter-rouge">CONTEXT</code>和<code class="language-plaintext highlighter-rouge">TRANSIENT</code>有一些使用上的限制。假设一个经典的REST应用程序中拥有如下等级制度的<code class="language-plaintext highlighter-rouge">Context</code>：</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// `Context`链: invocationCtx（调用级别Context） -&gt; requestCtx（请求级别Context） -&gt; serverCtx（服务级别Context） -&gt; appCtx（应用程序级别Context）</span>
<span class="nx">appCtx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">services.MyService</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">MyService</span><span class="p">)</span>
   <span class="c1">// 将`MyService`类设置为`TRANSIENT`</span>
   <span class="c1">// 并将其绑定到应用程序级别Context中</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">TRANSIENT</span><span class="p">);</span> 
</code></pre></div></div>

<p>我们将<code class="language-plaintext highlighter-rouge">Controllers</code>（控制器）对象和<code class="language-plaintext highlighter-rouge">Services</code>（服务）对象的<code class="language-plaintext highlighter-rouge">Scope</code>设置为<code class="language-plaintext highlighter-rouge">TRANSIENT</code>，以便于在每次请求产生时都可以获得到一个新的实例化对象。但是，如果<code class="language-plaintext highlighter-rouge">Controllers</code>对象和<code class="language-plaintext highlighter-rouge">Services</code>对象是由<code class="language-plaintext highlighter-rouge">Invocation Context（调用级别上下文）</code>解析的（比如，<code class="language-plaintext highlighter-rouge">Interceptors</code>拦截器），那么一个新的实例化对象会被重复创建。</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 在中间件中</span>
<span class="kd">const</span> <span class="nx">serviceInst1</span> <span class="o">=</span> <span class="nx">requestCtx</span><span class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">MyService</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">services.MyService</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// 在拦截器中</span>
<span class="kd">const</span> <span class="nx">serviceInst2</span> <span class="o">=</span> <span class="nx">invocationCtx</span><span class="p">.</span><span class="kd">get</span><span class="o">&lt;</span><span class="nx">MyService</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">'</span><span class="s1">services.MyService</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// 注意：serviceInst2 是一个新的实例化对象，并且不同于 serviceInst1</span>
</code></pre></div></div>

<p>类似的事情可能还会发生在依赖注入中：</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MyMiddlewareProvider</span> <span class="k">implements</span> <span class="nx">Provider</span><span class="o">&lt;</span><span class="nx">Middleware</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="c1">// 依赖注入，并用于此中间件中</span>
  <span class="kd">constructor</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">services.MyService</span><span class="dl">'</span><span class="p">)</span> <span class="k">private</span> <span class="nx">myService</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">MyInterceptor</span> <span class="p">{</span>
  <span class="c1">// 依赖注入，并用于此拦截器中</span>
  <span class="kd">constructor</span><span class="p">(@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">services.MyService</span><span class="dl">'</span><span class="p">)</span> <span class="k">private</span> <span class="nx">myService</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>
<span class="c1">// 注意： 在同一个请求中，中间件和拦截器会收到两个不同的'MyService'的实例化对象</span>
</code></pre></div></div>

<p>理想状态下，我们应该在<code class="language-plaintext highlighter-rouge">requestCtx</code>，即<code class="language-plaintext highlighter-rouge">Request Context（请求级别上下文）</code>的子节点中获得相同的<code class="language-plaintext highlighter-rouge">MyService</code>的实例化对象。但是实际情况可能会更糟糕，在<code class="language-plaintext highlighter-rouge">requestCtx</code>中解析一个<code class="language-plaintext highlighter-rouge">Binding</code>两次甚至会得到两个不同的<code class="language-plaintext highlighter-rouge">MyService</code>的实例化对象。</p>

<p>无论是<code class="language-plaintext highlighter-rouge">SINGLETON</code>还是<code class="language-plaintext highlighter-rouge">CONTEXT</code>都无法解决上面的问题。通常情况下，<code class="language-plaintext highlighter-rouge">Controllers</code>对象和<code class="language-plaintext highlighter-rouge">Services</code>对象是由<code class="language-plaintext highlighter-rouge">Application Context（应用程序级别上下文）</code>查询并解析的。继承于<code class="language-plaintext highlighter-rouge">Component</code>的组件类（比如，<code class="language-plaintext highlighter-rouge">RestComponent</code>组件）也会向<code class="language-plaintext highlighter-rouge">Application Context</code>贡献其自身的<code class="language-plaintext highlighter-rouge">Binding</code>，而不是向<code class="language-plaintext highlighter-rouge">Server Context（服务器级别上下文）</code>。在<code class="language-plaintext highlighter-rouge">Scope</code>为<code class="language-plaintext highlighter-rouge">SINGLETON</code>的情况下，我们可以从<code class="language-plaintext highlighter-rouge">Application Context</code>中获得<code class="language-plaintext highlighter-rouge">MyService</code>的相同的实例化对象。在<code class="language-plaintext highlighter-rouge">Scope</code>为<code class="language-plaintext highlighter-rouge">CONTEXT</code>的情况下，我们可以从任意<code class="language-plaintext highlighter-rouge">Context</code>中获得<code class="language-plaintext highlighter-rouge">MyService</code>的不同的实例化对象。下面是可以将<code class="language-plaintext highlighter-rouge">Binding</code>的解析过程变得更加准确的<code class="language-plaintext highlighter-rouge">Scope</code>：</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.APPLICATION</code></li>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.SERVER</code></li>
  <li><code class="language-plaintext highlighter-rouge">BindingScope.REQUEST</code></li>
</ul>

<p>使用上面的<code class="language-plaintext highlighter-rouge">Scope</code>时，程序会从<code class="language-plaintext highlighter-rouge">Context</code>链中按照层级依次查找并匹配首个符合条件的<code class="language-plaintext highlighter-rouge">Context</code>。被解析的<code class="language-plaintext highlighter-rouge">Binding</code>的值会被缓存在同级别的<code class="language-plaintext highlighter-rouge">Context</code>中并被允许分享。这样就解决了上面的问题，同时确保了在同级别的<code class="language-plaintext highlighter-rouge">Context</code>中同一个值不会被解析多次。</p>

<div class="alert alert-info" role="alert">
  <p><i class="fa fa-info-circle"></i>
<b>Note:</b>
在某些特殊场景中（比如，测试），在<code class="language-plaintext highlighter-rouge">Context</code>链中不会存在<code class="language-plaintext highlighter-rouge">Scope</code>为<code class="language-plaintext highlighter-rouge">REQUEST</code>的<code class="language-plaintext highlighter-rouge">Context</code>，解析过程会失败并转而在当前的<code class="language-plaintext highlighter-rouge">Context</code>中进行查找。这样方便于将<code class="language-plaintext highlighter-rouge">REQUEST</code>用于控制器或其他组件中。</p>

</div>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// `Context`链: invocationCtx（调用级别Context） -&gt; requestCtx（请求级别Context） -&gt; serverCtx（服务级别Context） -&gt; appCtx（应用程序级别Context）</span>
<span class="nx">appCtx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">services.MyService</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toClass</span><span class="p">(</span><span class="nx">MyService</span><span class="p">)</span>
   <span class="c1">// 将`MyService`类设置为`REQUEST`</span>
   <span class="c1">// 并将其绑定到应用程序级别Context中</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">REQUEST</span><span class="p">);</span>
</code></pre></div></div>

<p>如上面的代码所示，在将<code class="language-plaintext highlighter-rouge">Scope</code>的改为<code class="language-plaintext highlighter-rouge">REQUEST</code>后，在<code class="language-plaintext highlighter-rouge">MyMiddleware</code>和<code class="language-plaintext highlighter-rouge">MyInterceptor</code>中，<code class="language-plaintext highlighter-rouge">MyService</code>将永远被解析为相同的实例对象。</p>

<h3 id="根据binding的key和scope在context等级制结构中解析binding">根据Binding的Key和Scope在Context等级制结构中解析Binding</h3>

<p><code class="language-plaintext highlighter-rouge">Binding</code>的解析事件通常发生在使用<code class="language-plaintext highlighter-rouge">ctx.get()</code>、<code class="language-plaintext highlighter-rouge">ctx.getSync()</code>或<code class="language-plaintext highlighter-rouge">binding.getValue(ctx)</code>等方法的时候。当一个类被实例化或类中的一个方法被调用时，<code class="language-plaintext highlighter-rouge">Binding</code>的解析事件也伴随着依赖注入而发生。</p>

<p>在<code class="language-plaintext highlighter-rouge">Context等级制结构</code>中，解析一个<code class="language-plaintext highlighter-rouge">Binding</code>通常会涉及到很多的<code class="language-plaintext highlighter-rouge">Context</code>对象。根据不同的<code class="language-plaintext highlighter-rouge">Context</code>链和<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Scope</code>的设置，解析过程所涉及到的<code class="language-plaintext highlighter-rouge">Context</code>对象也可能是不同的或相同的。</p>

<p>假设我们现在有如下的<code class="language-plaintext highlighter-rouge">Context</code>链：</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Context</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">appCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="dl">'</span><span class="s1">application</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">appCtx</span><span class="p">.</span><span class="nx">scope</span> <span class="o">=</span> <span class="nx">BindingScope</span><span class="p">.</span><span class="nx">APPLICATION</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">serverCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="nx">appCtx</span><span class="p">,</span> <span class="dl">'</span><span class="s1">server</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">serverCtx</span><span class="p">.</span><span class="nx">scope</span> <span class="o">=</span> <span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SERVER</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">reqCtx</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Context</span><span class="p">(</span><span class="nx">serverCtx</span><span class="p">,</span> <span class="dl">'</span><span class="s1">request</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">reqCtx</span><span class="p">.</span><span class="nx">scope</span> <span class="o">=</span> <span class="nx">BindingScope</span><span class="p">.</span><span class="nx">REQUEST</span><span class="p">;</span>
</code></pre></div></div>

<ol>
  <li>
    <p>所有者级Context</p>

    <p><code class="language-plaintext highlighter-rouge">Binding</code>直接通过<code class="language-plaintext highlighter-rouge">Context.bind()</code>或<code class="language-plaintext highlighter-rouge">Context.add()</code>方法添加到<code class="language-plaintext highlighter-rouge">Context</code>对象中。那么这个<code class="language-plaintext highlighter-rouge">Context</code>就可以称为是这个<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">所有者级Context</code>。</p>

    <p>现在让我们在<code class="language-plaintext highlighter-rouge">Context</code>链中添加一些<code class="language-plaintext highlighter-rouge">Binding</code>：</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">appCtx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo.app</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">app.bar</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">serverCtx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo.server</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">server.bar</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>如上所示，<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">所有者级Context</code>分别是：</p>

    <ul>
      <li>‘foo.app’: appCtx</li>
      <li>‘foo.server’: serverCtx</li>
    </ul>
  </li>
  <li>
    <p>目击者级Context</p>

    <p>在<code class="language-plaintext highlighter-rouge">Context</code>上直接显式地发起针对<code class="language-plaintext highlighter-rouge">Binding</code>的解析行为，或隐式地使用了依赖注入的<code class="language-plaintext highlighter-rouge">Context</code>。那么这个<code class="language-plaintext highlighter-rouge">Context</code>就可以称为是这个<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">目击者级Context</code>。</p>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">val1</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">reqCtx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo.app</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">val2</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">reqCtx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo.server</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>如上所示，<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">目击者级Context</code>分别是：</p>

    <ul>
      <li>‘foo.app’: reqCtx</li>
      <li>‘foo.server’: reqCtx</li>
    </ul>
  </li>
  <li>
    <p>解析者级Context</p>

    <p>被用来在<code class="language-plaintext highlighter-rouge">Context</code>链中根据<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Key</code>来查找或解析<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Context</code>。那么这个<code class="language-plaintext highlighter-rouge">Context</code>就可以称为是这个<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">解析者级Context</code>。</p>

    <p>只有<code class="language-plaintext highlighter-rouge">解析者级Context</code>本身和其祖先<code class="language-plaintext highlighter-rouge">Context</code>对解析过程可见。</p>

    <p>确定<code class="language-plaintext highlighter-rouge">解析者级Context</code>通常按照如下流程：</p>

    <p>a. 依次在<code class="language-plaintext highlighter-rouge">目击者级Context</code>及其祖先<code class="language-plaintext highlighter-rouge">Context</code>中根据<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Key</code>进行查找并匹配第一个符合条件的<code class="language-plaintext highlighter-rouge">Binding</code></p>

    <p>b. 根据已经查找到的<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Scope</code>查找<code class="language-plaintext highlighter-rouge">解析者级Context</code>：</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">CONTEXT / TRANSIENT</code>： <code class="language-plaintext highlighter-rouge">目击者级Context</code></li>
      <li><code class="language-plaintext highlighter-rouge">SINGLETON</code>： <code class="language-plaintext highlighter-rouge">所有者级Context</code></li>
      <li><code class="language-plaintext highlighter-rouge">APPLICATION / SERVER / REQUEST</code>： 依次在<code class="language-plaintext highlighter-rouge">目击者级Context</code>及其祖先<code class="language-plaintext highlighter-rouge">Context</code>中进行查找并匹配第一个符合条件的<code class="language-plaintext highlighter-rouge">Context</code></li>
    </ul>

    <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">generateUniqueId</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@loopback/core</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">appCtx</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">).</span><span class="nx">to</span><span class="p">(</span><span class="dl">'</span><span class="s1">app.bar</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">serverCtx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="s2">`foo.server.</span><span class="p">${</span><span class="nx">generateUniqueId</span><span class="p">()}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SERVER</span><span class="p">);</span>

<span class="nx">serverCtx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">xyz</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="s2">`abc.server.</span><span class="p">${</span><span class="nx">generateUniqueId</span><span class="p">()}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SINGLETON</span><span class="p">);</span>

<span class="c1">// line 1</span>
<span class="kd">const</span> <span class="nx">val</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">reqCtx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// line 2</span>
<span class="kd">const</span> <span class="nx">appVal</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">appCtx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// line 3</span>
<span class="kd">const</span> <span class="nx">xyz</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">reqCtx</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">xyz</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>如上所示：</p>

    <table>
      <thead>
        <tr>
          <th>代码行</th>
          <th>解析出的<code class="language-plaintext highlighter-rouge">Binding</code>的信息</th>
          <th>解析出的<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">解析者级Context</code></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>line 1</td>
          <td>在<code class="language-plaintext highlighter-rouge">serverCtx</code>中<code class="language-plaintext highlighter-rouge">Key</code>为<code class="language-plaintext highlighter-rouge">foo</code>的<code class="language-plaintext highlighter-rouge">Binding</code></td>
          <td><code class="language-plaintext highlighter-rouge">serverCtx</code></td>
        </tr>
        <tr>
          <td>line 2</td>
          <td>在<code class="language-plaintext highlighter-rouge">appCtx</code>中<code class="language-plaintext highlighter-rouge">Key</code>为<code class="language-plaintext highlighter-rouge">foo</code>的<code class="language-plaintext highlighter-rouge">Binding</code></td>
          <td><code class="language-plaintext highlighter-rouge">appCtx</code></td>
        </tr>
        <tr>
          <td>line 3</td>
          <td>在<code class="language-plaintext highlighter-rouge">serverCtx</code>中<code class="language-plaintext highlighter-rouge">Key</code>为<code class="language-plaintext highlighter-rouge">xyz</code>的<code class="language-plaintext highlighter-rouge">Binding</code></td>
          <td><code class="language-plaintext highlighter-rouge">serverCtx</code></td>
        </tr>
      </tbody>
    </table>

    <p>对于依赖注入而言，<code class="language-plaintext highlighter-rouge">目击者级Context</code>将会是声明了注入的类的<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">解析者级Context</code>。每次注入时，<code class="language-plaintext highlighter-rouge">解析者级Context</code>都会被查找并匹配出来。如果一个被注入的<code class="language-plaintext highlighter-rouge">Binding</code>对于<code class="language-plaintext highlighter-rouge">解析者级Context</code>是不可见的（比如，<code class="language-plaintext highlighter-rouge">Binding</code>的<code class="language-plaintext highlighter-rouge">Key</code>不存在或只存在于衍生对象中），则会抛出异常。</p>
  </li>
</ol>

<div class="alert alert-info" role="alert">
  <p><i class="fa fa-info-circle"></i>
<b>Note:</b>
如果<code class="language-plaintext highlighter-rouge">所有者级Context</code>和<code class="language-plaintext highlighter-rouge">解析者级Context</code>是同一个对象，则<code class="language-plaintext highlighter-rouge">Scope</code>为<code class="language-plaintext highlighter-rouge">APPLICATION / SERVER / REQUEST</code>时，就等价于<code class="language-plaintext highlighter-rouge">SINGLETON</code>。如下所示，两个<code class="language-plaintext highlighter-rouge">Binding</code>实际上是一样的。</p>

  <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">appCtx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">app.counter</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">count</span><span class="o">++</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">APPLICATION</span><span class="p">);</span>
</code></pre></div>  </div>

  <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">appCtx</span>
  <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="dl">'</span><span class="s1">app.counter</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">toDynamicValue</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">count</span><span class="o">++</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">inScope</span><span class="p">(</span><span class="nx">BindingScope</span><span class="p">.</span><span class="nx">SINGLETON</span><span class="p">);</span>
</code></pre></div>  </div>

</div>




    <div class="tags">
      
    </div>
</div>

<hr class="shaded"/>

<footer id="container">
            <div class="row">
                <div class="col-md-6 footer-left">
               &copy;2021 IBM / StrongLoop. All rights reserved. <br />
 Site last generated: Mar 22, 2021
              </div>
              <div class="col-md-6 footer-right">
                <p><img src="https://loopback.io/images/company_logo.png" alt="Company logo"/></p>
              </div>
            </div>
</footer>


        </div>
        <!-- /.row -->
</div>
<!-- /.container -->
    </div>
</body>

</html>
